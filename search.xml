<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Typoraä½¿ç”¨æ•™ç¨‹</title>
    <url>/2019/11/24/Typora%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote>
<blockquote>
<blockquote>
<p>â€ <strong>Markdown</strong> æ˜¯ä¸€ç§<strong>è½»é‡çº§</strong>æ ‡è®°è¯­è¨€ï¼Œåˆ›å§‹äººæ˜¯<strong>çº¦ç¿°Â·æ ¼é²ä¼¯</strong>ï¼ˆJohn Gruberï¼‰ã€‚å®ƒå…è®¸äººä»¬ â€œä½¿ç”¨æ˜“è¯»æ˜“å†™çš„çº¯æ–‡æœ¬æ ¼å¼ç¼–å†™æ–‡æ¡£ï¼Œç„¶åè½¬æ¢æˆæœ‰æ•ˆçš„ HTML æ–‡æ¡£ã€‚â€ </p>
</blockquote>
</blockquote>
</blockquote>
 <a id="more"></a> 

<h2 id="1-åŸºæœ¬æ“ä½œ"><a href="#1-åŸºæœ¬æ“ä½œ" class="headerlink" title="1.åŸºæœ¬æ“ä½œ"></a>1.åŸºæœ¬æ“ä½œ</h2><h3 id="1-1å†…å®¹ç›®å½•"><a href="#1-1å†…å®¹ç›®å½•" class="headerlink" title="1.1å†…å®¹ç›®å½•"></a>1.1å†…å®¹ç›®å½•</h3><p>[toc]</p>
<h3 id="1-2æ ‡é¢˜"><a href="#1-2æ ‡é¢˜" class="headerlink" title="1.2æ ‡é¢˜"></a>1.2æ ‡é¢˜</h3><h1 id="ä¸€çº§æ ‡é¢˜"><a href="#ä¸€çº§æ ‡é¢˜" class="headerlink" title="#               ä¸€çº§æ ‡é¢˜"></a>#               ä¸€çº§æ ‡é¢˜</h1><h2 id="äºŒçº§æ ‡é¢˜"><a href="#äºŒçº§æ ‡é¢˜" class="headerlink" title="##          äºŒçº§æ ‡é¢˜"></a>##          äºŒçº§æ ‡é¢˜</h2><h3 id="ä¸‰çº§æ ‡é¢˜"><a href="#ä¸‰çº§æ ‡é¢˜" class="headerlink" title="###      ä¸‰çº§æ ‡é¢˜"></a>###      ä¸‰çº§æ ‡é¢˜</h3><h4 id="å››çº§æ ‡é¢˜"><a href="#å››çº§æ ‡é¢˜" class="headerlink" title="####     å››çº§æ ‡é¢˜"></a>####     å››çº§æ ‡é¢˜</h4><h5 id="äº”çº§æ ‡é¢˜"><a href="#äº”çº§æ ‡é¢˜" class="headerlink" title="#####   äº”çº§æ ‡é¢˜"></a>#####   äº”çº§æ ‡é¢˜</h5><h6 id="å…­çº§æ ‡é¢˜"><a href="#å…­çº§æ ‡é¢˜" class="headerlink" title="######  å…­çº§æ ‡é¢˜"></a>######  å…­çº§æ ‡é¢˜</h6><h2 id="1-3å¼•ç”¨"><a href="#1-3å¼•ç”¨" class="headerlink" title="1.3å¼•ç”¨"></a>1.3å¼•ç”¨</h2><blockquote>
<p>å¼•ç”¨å†…å®¹ä¸€</p>
</blockquote>
<blockquote>
<p>å¼•ç”¨å†…å®¹äºŒ</p>
</blockquote>
<blockquote>
<blockquote>
<p>å¼•ç”¨å†…å®¹ä¸‰</p>
</blockquote>
</blockquote>
<h2 id="2-ä»£ç "><a href="#2-ä»£ç " class="headerlink" title="2.ä»£ç "></a>2.ä»£ç </h2><h3 id="2-1å•è¡Œä»£ç "><a href="#2-1å•è¡Œä»£ç " class="headerlink" title="2.1å•è¡Œä»£ç "></a>2.1å•è¡Œä»£ç </h3><p><code>String str1=&quot;ä½ å¥½å•Šï¼&quot;;</code></p>
<h3 id="2-2å¤šè¡Œä»£ç "><a href="#2-2å¤šè¡Œä»£ç " class="headerlink" title="2.2å¤šè¡Œä»£ç "></a>2.2å¤šè¡Œä»£ç </h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;&#125;</span><br><span class="line">    System.out.println(<span class="string">"ä½ å¥½ï¼"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

 <!-- more --> 

<h2 id="3-åˆ—è¡¨"><a href="#3-åˆ—è¡¨" class="headerlink" title="3.åˆ—è¡¨"></a>3.åˆ—è¡¨</h2><h3 id="3-1æ— åºåˆ—è¡¨"><a href="#3-1æ— åºåˆ—è¡¨" class="headerlink" title="3.1æ— åºåˆ—è¡¨"></a>3.1æ— åºåˆ—è¡¨</h3><ul>
<li>æ— åºåˆ—è¡¨1</li>
</ul>
<ul>
<li>æ— åºåˆ—è¡¨2</li>
</ul>
<ul>
<li>æ— åºåˆ—è¡¨3</li>
</ul>
<h3 id="3-2å¤šè¡Œæ— åºåˆ—è¡¨"><a href="#3-2å¤šè¡Œæ— åºåˆ—è¡¨" class="headerlink" title="3.2å¤šè¡Œæ— åºåˆ—è¡¨"></a>3.2å¤šè¡Œæ— åºåˆ—è¡¨</h3><ul>
<li><p>å¤šè¡Œæ— åºåˆ—è¡¨1</p>
</li>
<li><ul>
<li><p>å¤šè¡Œæ— åºåˆ—è¡¨2</p>
</li>
<li><ul>
<li>å¤šè¡Œæ— åºåˆ—è¡¨3</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="3-3æœ‰åºåˆ—è¡¨"><a href="#3-3æœ‰åºåˆ—è¡¨" class="headerlink" title="3.3æœ‰åºåˆ—è¡¨"></a>3.3æœ‰åºåˆ—è¡¨</h3><p>1.æœ‰åºåˆ—è¡¨1</p>
<p>2.æœ‰åºåˆ—è¡¨2</p>
<p>3.æœ‰åºåˆ—è¡¨3</p>
<h3 id="3-4å¤šè¡Œæœ‰åºåˆ—è¡¨"><a href="#3-4å¤šè¡Œæœ‰åºåˆ—è¡¨" class="headerlink" title="3.4å¤šè¡Œæœ‰åºåˆ—è¡¨"></a>3.4å¤šè¡Œæœ‰åºåˆ—è¡¨</h3><p>1.å¤šè¡Œæœ‰åºåˆ—è¡¨1</p>
<p>2.å¤šè¡Œæœ‰åºåˆ—è¡¨2</p>
<p>â€‹    1.å¤šè¡Œæœ‰åºåˆ—è¡¨2-1</p>
<p>â€‹    2.å¤šè¡Œæœ‰åºåˆ—è¡¨2-2</p>
<p>3.å¤šè¡Œæœ‰åºåˆ—è¡¨3</p>
<p>â€‹    1.å¤šè¡Œæœ‰åºåˆ—è¡¨3-1</p>
<p>â€‹    2.å¤šè¡Œæœ‰åºåˆ—è¡¨3-2</p>
<h3 id="3-5ä»»åŠ¡åˆ—è¡¨"><a href="#3-5ä»»åŠ¡åˆ—è¡¨" class="headerlink" title="3.5ä»»åŠ¡åˆ—è¡¨"></a>3.5ä»»åŠ¡åˆ—è¡¨</h3><p> -[ ] æŠ½çƒŸ</p>
<p> -[x] å–é…’</p>
<p> -[ ] çƒ«å¤´</p>
<h3 id="3-6è¡¨æ ¼"><a href="#3-6è¡¨æ ¼" class="headerlink" title="3.6è¡¨æ ¼"></a>3.6è¡¨æ ¼</h3><table>
<thead>
<tr>
<th>å§“å</th>
<th>æ€§åˆ«</th>
<th>å¹´é¾„</th>
<th>æ‰‹æœºå·</th>
</tr>
</thead>
<tbody><tr>
<td>å¼ ä¸‰</td>
<td>ç”·</td>
<td>22</td>
<td>134525456789</td>
</tr>
<tr>
<td>æå››</td>
<td>å¥³</td>
<td>23</td>
<td>188528789456</td>
</tr>
<tr>
<td>ç‹äº”</td>
<td>ç”·</td>
<td>25</td>
<td>137321561234</td>
</tr>
</tbody></table>
 <!-- more --> 

<h2 id="4-è¿æ¥"><a href="#4-è¿æ¥" class="headerlink" title="4.è¿æ¥"></a>4.è¿æ¥</h2><h3 id="4-1å›¾ç‰‡"><a href="#4-1å›¾ç‰‡" class="headerlink" title="4.1å›¾ç‰‡"></a>4.1å›¾ç‰‡</h3><p>*æœ¬åœ°å›¾ç‰‡ï¼ˆåŠ è½½å¾ˆæ…¢ï¼Œå¯é€‰æ‹©ä¸ƒç‰›äº‘ï¼‰</p>
<p><img src="http://q1o3t6lvp.bkt.clouddn.com/bridge.jpg" alt="bridge"></p>
<p>*ç½‘ç»œå›¾ç‰‡</p>
<p><img src="http://img.netbian.com/file/2019/1118/7484348e1e863797925e9869687131b3.jpg" alt></p>
<h3 id="4-2è¶…é“¾æ¥"><a href="#4-2è¶…é“¾æ¥" class="headerlink" title="4.2è¶…é“¾æ¥"></a>4.2è¶…é“¾æ¥</h3><p>*è¡Œå†…å¼é“¾æ¥</p>
<p>[ç™¾åº¦ä¸€ä¸‹][<a href="https://www.baidu.com/]" target="_blank" rel="noopener">https://www.baidu.com/]</a></p>
<p>*å‚è€ƒå¼é“¾æ¥</p>
<p>*è‡ªåŠ¨é“¾æ¥</p>
<p><a href="https://www.github.com/nedlee329" target="_blank" rel="noopener">https://www.github.com/nedlee329</a></p>
<h2 id="5-å…¶ä»–"><a href="#5-å…¶ä»–" class="headerlink" title="5.å…¶ä»–"></a>5.å…¶ä»–</h2><h3 id="5-1æ–œä½“"><a href="#5-1æ–œä½“" class="headerlink" title="5.1æ–œä½“"></a>5.1æ–œä½“</h3><p><em>æ–œä½“1</em></p>
<p><em>æ–œä½“2</em></p>
<h3 id="5-2åŠ ç²—"><a href="#5-2åŠ ç²—" class="headerlink" title="5.2åŠ ç²—"></a>5.2åŠ ç²—</h3><p><strong>åŠ ç²—1</strong></p>
<p><strong>åŠ ç²—2</strong></p>
<h3 id="5-3-ä¸‹åˆ’çº¿"><a href="#5-3-ä¸‹åˆ’çº¿" class="headerlink" title="5.3 ä¸‹åˆ’çº¿"></a>5.3 ä¸‹åˆ’çº¿</h3><p><u>ä¸‹åˆ’çº¿</u></p>
<h3 id="5-4åˆ é™¤çº¿"><a href="#5-4åˆ é™¤çº¿" class="headerlink" title="5.4åˆ é™¤çº¿"></a>5.4åˆ é™¤çº¿</h3><p><del>åˆ é™¤çº¿</del></p>
<h3 id="5-5åˆ†å‰²çº¿"><a href="#5-5åˆ†å‰²çº¿" class="headerlink" title="5.5åˆ†å‰²çº¿"></a>5.5åˆ†å‰²çº¿</h3><hr>
<hr>
<hr>
<h3 id="5-6æ³¨è„š"><a href="#5-6æ³¨è„š" class="headerlink" title="5.6æ³¨è„š"></a>5.6æ³¨è„š</h3><p>Typora[^1]</p>
<h3 id="5-7ä¸Šä¸‹æ ‡"><a href="#5-7ä¸Šä¸‹æ ‡" class="headerlink" title="5.7ä¸Šä¸‹æ ‡"></a>5.7ä¸Šä¸‹æ ‡</h3><p>3^2=9$$</p>
<p>$ 3^{(3-1)}=9 $</p>
<p>$ H_2SO_4 $</p>
<p>$ H_{2SO_4} $</p>
 <!-- more --> 

<h3 id="5-8ç¬¦å·çš„è¾“å…¥-è¾“å…¥ä¹‹å‰åŠ åæ–œæ "><a href="#5-8ç¬¦å·çš„è¾“å…¥-è¾“å…¥ä¹‹å‰åŠ åæ–œæ " class="headerlink" title="5.8ç¬¦å·çš„è¾“å…¥(è¾“å…¥ä¹‹å‰åŠ åæ–œæ )"></a>5.8ç¬¦å·çš„è¾“å…¥(è¾“å…¥ä¹‹å‰åŠ åæ–œæ )</h3><p>\     åæ–œçº¿</p>
<p>&#39;     åå¼•å·</p>
<p>*    æ˜Ÿå·</p>
<p>_    åº•çº¿</p>
<p>{}    èŠ±æ‹¬å·</p>
<p>[ ]    æ–¹æ‹¬å·</p>
<p>()    æ‹¬å¼§</p>
<p>#    äº•å·</p>
<p>+    åŠ å·</p>
<p>-    å‡å·</p>
<p>.    è‹±æ–‡ç‚¹</p>
<p>!    æ„Ÿå¹å·</p>
<h3 id="5-9Typoraå¿«æ·é”®"><a href="#5-9Typoraå¿«æ·é”®" class="headerlink" title="5.9Typoraå¿«æ·é”®"></a>5.9Typoraå¿«æ·é”®</h3><ul>
<li><p>æ ‡é¢˜ï¼šctrl+æ•°å­—</p>
</li>
<li><p>è¡¨æ ¼ï¼šctrl+t</p>
</li>
<li><p>ç”Ÿæˆç›®å½•ï¼š[TOC]æŒ‰å›è½¦</p>
</li>
<li><p>é€‰ä¸­ä¸€æ•´è¡Œï¼šctrl+l</p>
</li>
<li><p>é€‰ä¸­å•è¯ï¼šctrl+d</p>
</li>
<li><p>é€‰ä¸­ç›¸åŒæ ¼å¼çš„æ–‡å­—ï¼šctrl+e</p>
</li>
<li><p>æœç´¢ï¼šctrl+f</p>
</li>
<li><p>æ›¿æ¢ï¼šctrl+h</p>
</li>
<li><p>å¼•ç”¨ï¼šè¾“å…¥&gt;ä¹‹åè¾“å…¥ç©ºæ ¼</p>
</li>
<li><p>ä»£ç å—ï¼šctrl+alt+f</p>
</li>
<li><p>åŠ ç²—ï¼šctrl+b</p>
</li>
<li><p>å€¾æ–œï¼šctrl+i</p>
</li>
<li><p>ä¸‹åˆ’çº¿ï¼šctrl+u</p>
</li>
<li><p>åˆ é™¤çº¿ï¼šalt+shift+5</p>
</li>
<li><p>æ’å…¥å›¾ç‰‡ï¼šç›´æ¥æ‹–åŠ¨åˆ°æŒ‡å®šä½ç½®å³å¯æˆ–è€…ctrl+shift+i</p>
</li>
<li><p>æ’å…¥é“¾æ¥ï¼šctrl+k</p>
<h3 id="5-10-æ§åˆ¶æ–‡å­—é¢œè‰²"><a href="#5-10-æ§åˆ¶æ–‡å­—é¢œè‰²" class="headerlink" title="5.10 æ§åˆ¶æ–‡å­—é¢œè‰²"></a>5.10 æ§åˆ¶æ–‡å­—é¢œè‰²</h3><p>åœ¨markdownä¸­é‡‡ç”¨å¦‚ä¸‹æ–¹å¼èƒ½å¤Ÿæ§åˆ¶æ–‡å­—çš„é¢œè‰²ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">æµ…çº¢è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#dd0000"</span>&gt;</span>æµ…çº¢è‰²æ–‡å­—ï¼š<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æ·±çº¢è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#660000"</span>&gt;</span>æ·±çº¢è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æµ…ç»¿è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#00dd00"</span>&gt;</span>æµ…ç»¿è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æ·±ç»¿è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#006600"</span>&gt;</span>æ·±ç»¿è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æµ…è“è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#0000dd"</span>&gt;</span>æµ…è“è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æ·±è“è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#000066"</span>&gt;</span>æ·±è“è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æµ…é»„è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#dddd00"</span>&gt;</span>æµ…é»„è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æ·±é»„è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#666600"</span>&gt;</span>æ·±é»„è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æµ…é’è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#00dddd"</span>&gt;</span>æµ…é’è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æ·±é’è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#006666"</span>&gt;</span>æ·±é’è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æµ…ç´«è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#dd00dd"</span>&gt;</span>æµ…ç´«è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span> </span><br><span class="line">æ·±ç´«è‰²æ–‡å­—ï¼š<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#660066"</span>&gt;</span>æ·±ç´«è‰²æ–‡å­—<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p>æµ…çº¢è‰²æ–‡å­—ï¼š<font color="#dd0000">æµ…çº¢è‰²æ–‡å­—ï¼š</font><br><br>æ·±çº¢è‰²æ–‡å­—ï¼š<font color="#660000">æ·±çº¢è‰²æ–‡å­—</font><br><br>æµ…ç»¿è‰²æ–‡å­—ï¼š<font color="#00dd00">æµ…ç»¿è‰²æ–‡å­—</font><br><br>æ·±ç»¿è‰²æ–‡å­—ï¼š<font color="#006600">æ·±ç»¿è‰²æ–‡å­—</font><br><br>æµ…è“è‰²æ–‡å­—ï¼š<font color="#0000dd">æµ…è“è‰²æ–‡å­—</font><br><br>æ·±è“è‰²æ–‡å­—ï¼š<font color="#000066">æ·±è“è‰²æ–‡å­—</font><br><br>æµ…é»„è‰²æ–‡å­—ï¼š<font color="#dddd00">æµ…é»„è‰²æ–‡å­—</font><br><br>æ·±é»„è‰²æ–‡å­—ï¼š<font color="#666600">æ·±é»„è‰²æ–‡å­—</font><br><br>æµ…é’è‰²æ–‡å­—ï¼š<font color="#00dddd">æµ…é’è‰²æ–‡å­—</font><br><br>æ·±é’è‰²æ–‡å­—ï¼š<font color="#006666">æ·±é’è‰²æ–‡å­—</font><br><br>æµ…ç´«è‰²æ–‡å­—ï¼š<font color="#dd00dd">æµ…ç´«è‰²æ–‡å­—</font><br><br>æ·±ç´«è‰²æ–‡å­—ï¼š<font color="#660066">æ·±ç´«è‰²æ–‡å­—</font><br> </p>
</li>
</ul>
<h2 id="6-Typoraä¸‹è½½åœ°å€"><a href="#6-Typoraä¸‹è½½åœ°å€" class="headerlink" title="6.Typoraä¸‹è½½åœ°å€"></a>6.Typoraä¸‹è½½åœ°å€</h2><p><a href="https://www.typora.io/" target="_blank" rel="noopener">https://www.typora.io/</a></p>
]]></content>
      <categories>
        <category>æ•™ç¨‹</category>
      </categories>
  </entry>
  <entry>
    <title>å›¾ç‰‡æµ‹è¯•</title>
    <url>/2019/11/24/%E5%9B%BE%E7%89%87%E6%B5%8B%E8%AF%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><img src="/bridge.jpg" alt="æ²¡æœ‰æ‰¾åˆ°å›¾ç‰‡"></p>
<p><img src="/2019/11/24/%E5%9B%BE%E7%89%87%E6%B5%8B%E8%AF%95/bridge.jpg" alt="æ‰¾ä¸åˆ°å›¾ç‰‡"></p>
<p><img src="/2019/11/24/%E5%9B%BE%E7%89%87%E6%B5%8B%E8%AF%95/%5Cbridge.jpg" alt="å®åœ¨æ‰¾ä¸åˆ°"></p>
]]></content>
      <categories>
        <category>æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« </title>
    <url>/2019/11/22/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%96%87%E7%AB%A0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ç¬¬ä¸€ç« "><a href="#ç¬¬ä¸€ç« " class="headerlink" title="ç¬¬ä¸€ç« "></a>ç¬¬ä¸€ç« </h2><p>å†…å®¹</p>
<hr>
<h2 id="ç¬¬äºŒç« "><a href="#ç¬¬äºŒç« " class="headerlink" title="ç¬¬äºŒç« "></a>ç¬¬äºŒç« </h2><p>å†…å®¹</p>
<hr>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a href="http://www.nedlee.com" target="_blank" rel="noopener">www.nedlee.com</a></p>
]]></content>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2019/11/22/hello-world/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>Springå­¦ä¹ ç¬¬ä¸€å¤©</title>
    <url>/2019/11/27/Spring%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B8%80%E5%A4%A9/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>[TOC]</p>
<h2 id="ä¸€ã€Springæ¡†æ¶æ¦‚è¿°"><a href="#ä¸€ã€Springæ¡†æ¶æ¦‚è¿°" class="headerlink" title="ä¸€ã€Springæ¡†æ¶æ¦‚è¿°"></a>ä¸€ã€Springæ¡†æ¶æ¦‚è¿°</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯Spring"><a href="#1-1-ä»€ä¹ˆæ˜¯Spring" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯Spring"></a>1.1 ä»€ä¹ˆæ˜¯Spring</h3><ul>
<li><p>Springæ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼ŒSpringæ˜¯äº2003 å¹´å…´èµ·çš„ä¸€ä¸ªè½»é‡çº§çš„Java å¼€å‘æ¡†æ¶ï¼Œç”±Rod Johnson åœ¨å…¶è‘—ä½œExpert One-On-One J2EE Development and Designä¸­é˜è¿°çš„éƒ¨åˆ†ç†å¿µå’ŒåŸå‹è¡ç”Ÿè€Œæ¥ã€‚å®ƒæ˜¯ä¸ºäº†è§£å†³ä¼ä¸šåº”ç”¨å¼€å‘çš„å¤æ‚æ€§è€Œåˆ›å»ºçš„ã€‚æ¡†æ¶çš„ä¸»è¦ä¼˜åŠ¿ä¹‹ä¸€å°±æ˜¯å…¶åˆ†å±‚æ¶æ„ï¼Œåˆ†å±‚æ¶æ„å…è®¸ä½¿ç”¨è€…é€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªç»„ä»¶ï¼ŒåŒæ—¶ä¸º J2EE åº”ç”¨ç¨‹åºå¼€å‘æä¾›é›†æˆçš„æ¡†æ¶ã€‚Springä½¿ç”¨åŸºæœ¬çš„JavaBeanæ¥å®Œæˆä»¥å‰åªå¯èƒ½ç”±EJBå®Œæˆçš„äº‹æƒ…ã€‚ç„¶è€Œï¼ŒSpringçš„ç”¨é€”ä¸ä»…é™äºæœåŠ¡å™¨ç«¯çš„å¼€å‘ã€‚ä»ç®€å•æ€§ã€å¯æµ‹è¯•æ€§å’Œæ¾è€¦åˆçš„è§’åº¦è€Œè¨€ï¼Œä»»ä½•Javaåº”ç”¨éƒ½å¯ä»¥ä»Springä¸­å—ç›Šã€‚Springçš„æ ¸å¿ƒæ˜¯æ§åˆ¶åè½¬ï¼ˆIoCï¼‰å’Œé¢å‘åˆ‡é¢ï¼ˆAOPï¼‰ã€‚ç®€å•æ¥è¯´ï¼ŒSpringæ˜¯ä¸€ä¸ª<strong>åˆ†å±‚</strong>çš„JavaSE/EE <span style="color:red">full-stack(ä¸€ç«™å¼) </span><strong>è½»é‡çº§</strong>å¼€æºæ¡†æ¶ã€‚</p>
</li>
<li><p><strong>è½»é‡çº§</strong>æŒ‡çš„æ˜¯ä¸EJBå¯¹æ¯”ï¼Œä¾èµ–èµ„æºå°‘ï¼Œé”€æ¯çš„èµ„æºå°‘ </p>
</li>
<li><p><strong>åˆ†å±‚</strong>æŒ‡çš„æ˜¯ä¸€ç«™å¼ï¼Œæ¯ä¸€ä¸ªå±‚éƒ½æä¾›çš„è§£å†³æ–¹æ¡ˆ</p>
</li>
<li><ul>
<li>webå±‚ï¼šstrutsï¼Œspring-MVC</li>
<li>serviceå±‚ï¼šspring</li>
<li>daoå±‚ï¼šhibernateï¼Œmybatis ï¼Œ jdbcTemplate â€“&gt; (spring-dataäº†è§£)</li>
</ul>
<a id="more"></a> 

</li>
</ul>
<h3 id="1-2-Springæ ¸å¿ƒ"><a href="#1-2-Springæ ¸å¿ƒ" class="headerlink" title="1.2 Springæ ¸å¿ƒ"></a>1.2 Springæ ¸å¿ƒ</h3><p>Springçš„æ ¸å¿ƒæ˜¯<span style="color:red">æ§åˆ¶åè½¬(IoC)å’Œé¢å‘åˆ‡é¢(AOP)</span></p>
<h3 id="1-3-Springä¼˜ç‚¹"><a href="#1-3-Springä¼˜ç‚¹" class="headerlink" title="1.3 Springä¼˜ç‚¹"></a>1.3 Springä¼˜ç‚¹</h3><ul>
<li><p>æ–¹ä¾¿è§£è€¦ï¼Œç®€åŒ–å¼€å‘ ï¼ˆé«˜å†…èšä½è€¦åˆï¼‰</p>
<ul>
<li><p><span style="color:red"> Springå°±æ˜¯ä¸€ä¸ªå¤§å·¥å‚  </span>(å®¹å™¨)ï¼Œå¯ä»¥å°†æ‰€æœ‰å¯¹è±¡åˆ›å»ºå’Œä¾èµ–å…³ç³»ç»´æŠ¤ï¼Œäº¤ç»™Springç®¡ç†</p>
</li>
<li><p><span style="color:red">Springå·¥å‚æ˜¯ç”¨äºç”Ÿæˆbean  </span></p>
</li>
</ul>
</li>
<li><p>AOPç¼–ç¨‹çš„æ”¯æŒ</p>
<ul>
<li>Springæä¾›é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªã€è¿è¡Œç›‘æ§ç­‰åŠŸèƒ½</li>
</ul>
</li>
<li><p>å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒ</p>
<ul>
<li>åªéœ€è¦é€šè¿‡é…ç½®å°±å¯ä»¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œæ— éœ€æ‰‹åŠ¨ç¼–ç¨‹</li>
</ul>
</li>
<li><p>æ–¹ä¾¿ç¨‹åºçš„æµ‹è¯•</p>
<ul>
<li>Springå¯¹Junit4æ”¯æŒï¼Œå¯ä»¥é€šè¿‡æ³¨è§£æ–¹ä¾¿çš„æµ‹è¯•Springç¨‹åº</li>
</ul>
</li>
<li><p>æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶</p>
<ul>
<li>Springä¸æ’æ–¥å„ç§ä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼Œå…¶å†…éƒ¨æä¾›äº†å¯¹å„ç§ä¼˜ç§€æ¡†æ¶ï¼ˆå¦‚ï¼šStrutsã€Hibernateã€MyBatisã€Quartzç­‰ï¼‰çš„ç›´æ¥æ”¯æŒ</li>
</ul>
</li>
<li><p>é™ä½JavaEE APIçš„ä½¿ç”¨éš¾åº¦</p>
<ul>
<li>Spring å¯¹JavaEEå¼€å‘ä¸­éå¸¸éš¾ç”¨çš„ä¸€äº›APIï¼ˆJDBCã€JavaMailã€è¿œç¨‹è°ƒç”¨ç­‰ï¼‰ï¼Œéƒ½æä¾›äº†å°è£…ï¼Œä½¿è¿™äº›APIåº”ç”¨éš¾åº¦å¤§å¤§é™ä½</li>
</ul>
</li>
</ul>
<h3 id="1-4-Springä½“ç³»ç»“æ„"><a href="#1-4-Springä½“ç³»ç»“æ„" class="headerlink" title="1.4 Springä½“ç³»ç»“æ„"></a>1.4 Springä½“ç³»ç»“æ„</h3><ul>
<li><strong>æ ¸å¿ƒå®¹å™¨(Core Container)åŒ…æ‹¬</strong><ul>
<li>Beans(ç®¡ç†bean)</li>
<li>Core(æ ¸å¿ƒ)</li>
<li>Context(é…ç½®æ–‡ä»¶)</li>
<li>Expression Language(SpELè¡¨è¾¾å¼)</li>
</ul>
</li>
<li><strong>ç¬¬äºŒå±‚åŒ…æ‹¬</strong><ul>
<li>AOP(åˆ‡é¢ç¼–ç¨‹)</li>
<li>Aspects(AOPæ¡†æ¶)</li>
<li>Instrumentation(äº†è§£å³å¯)</li>
</ul>
</li>
<li><strong>ç¬¬ä¸‰å±‚åŒ…æ‹¬</strong><ul>
<li>JDBC(jdbcTemplateæ•°æ®åº“å¼€å‘)</li>
<li>ORM(æ•´åˆhibernate)</li>
<li>OXM(äº†è§£å³å¯)</li>
<li>JMS(äº†è§£å³å¯)</li>
<li>Transactions(äº‹ç‰©ç®¡ç† tx)</li>
</ul>
</li>
<li><strong>ç¬¬å››å±‚åŒ…æ‹¬</strong><ul>
<li>Web(webå¼€å‘)</li>
<li>Struts(æ•´åˆstruts)</li>
</ul>
</li>
<li><strong>ç¬¬äº”å±‚åŒ…æ‹¬</strong><ul>
<li>Test(æ•´åˆJunit)</li>
</ul>
</li>
</ul>
<h2 id="äºŒã€å…¥é—¨ä¹‹IoC-æŒæ¡ï¼‰"><a href="#äºŒã€å…¥é—¨ä¹‹IoC-æŒæ¡ï¼‰" class="headerlink" title="äºŒã€å…¥é—¨ä¹‹IoC(æŒæ¡ï¼‰"></a>äºŒã€å…¥é—¨ä¹‹IoC(æŒæ¡ï¼‰</h2><blockquote>
<p>â€‹        å‡†å¤‡å·¥ä½œï¼ŒåŸºäºMyEclipseï¼Œæ‰€ä»¥éœ€å¯¼å…¥jaråŒ…ï¼ŒjaråŒ…åŒ…æ‹¬ 4ä¸ªæ ¸å¿ƒï¼ˆbeansã€coreã€contextã€expressionï¼‰ + 1ä¸ªä¾èµ–ï¼ˆcommons-logginsâ€¦jarï¼‰  </p>
</blockquote>
<p><img src="http://q1o3t6lvp.bkt.clouddn.com/image/jpg20191128195309.png" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<h3 id="2-1-ç›®æ ‡ç±»"><a href="#2-1-ç›®æ ‡ç±»" class="headerlink" title="2.1 ç›®æ ‡ç±»"></a>2.1 ç›®æ ‡ç±»</h3><ul>
<li>æä¾›UserServiceæ¥å£å’Œå®ç°ç±»</li>
<li>è·å¾—UserServiceå®ç°ç±»çš„å®ä¾‹</li>
</ul>
<p>Springçš„ä½œç”¨å°±æ˜¯ç”±Springåˆ›å»ºå¯¹è±¡å®ä¾‹â€“&gt; IoC æ§åˆ¶åè½¬ï¼ˆInverse of Controlï¼‰ä¹‹åéœ€è¦å®ä¾‹å¯¹è±¡æ—¶ï¼Œä»springå·¥å‚ï¼ˆå®¹å™¨ï¼‰ä¸­è·å¾—ï¼Œéœ€è¦å°†å®ç°ç±»çš„å…¨é™å®šåç§°é…ç½®åˆ°xmlæ–‡ä»¶ä¸­  </p>
<h4 id="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¥å£å’Œå®ç°ç±»"><a href="#ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¥å£å’Œå®ç°ç±»" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¥å£å’Œå®ç°ç±»"></a>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¥å£å’Œå®ç°ç±»</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*æ¥å£*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*å®ç°ç±»*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"a_ioc add user"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶"><a href="#ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶"></a>ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶</h4><p>â€‹        <strong>æ³¨æ„äº‹é¡¹</strong></p>
<ul>
<li>ä½ç½®ï¼šä»»æ„ï¼Œå¼€å‘ä¸­ä¸€èˆ¬åœ¨classpathä¸‹ï¼ˆsrcï¼‰</li>
<li>åç§°ï¼šä»»æ„ï¼Œå¼€å‘ä¸­å¸¸ç”¨applicationContext.xml</li>
<li>å†…å®¹ï¼šæ·»åŠ schemaçº¦æŸ</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®service </span></span><br><span class="line"><span class="comment">		&lt;bean&gt; é…ç½®éœ€è¦åˆ›å»ºçš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">			id ï¼šç”¨äºä¹‹åä»springå®¹å™¨è·å¾—å®ä¾‹æ—¶ä½¿ç”¨çš„</span></span><br><span class="line"><span class="comment">			class ï¼šéœ€è¦åˆ›å»ºå®ä¾‹çš„å…¨é™å®šç±»å</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userServiceId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.a_ioc.UserServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•"><a href="#ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•"></a>ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//ä»springå®¹å™¨è·å¾—</span></span><br><span class="line">		<span class="comment">//1 è·å¾—å®¹å™¨</span></span><br><span class="line">		String xmlPath = <span class="string">"com/springlearning/a_ioc/beans.xml"</span>;</span><br><span class="line">		ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">		<span class="comment">//2è·å¾—å†…å®¹ --ä¸éœ€è¦è‡ªå·±newï¼Œéƒ½æ˜¯ä»springå®¹å™¨è·å¾—</span></span><br><span class="line">		UserService userService = (UserService) applicationContext.getBean(<span class="string">"userServiceId"</span>);</span><br><span class="line">		userService.addUser();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€å…¥é—¨ä¹‹DI-æŒæ¡"><a href="#ä¸‰ã€å…¥é—¨ä¹‹DI-æŒæ¡" class="headerlink" title="ä¸‰ã€å…¥é—¨ä¹‹DI(æŒæ¡)"></a>ä¸‰ã€å…¥é—¨ä¹‹DI(æŒæ¡)</h2><h3 id="3-1-ç›®æ ‡ç±»"><a href="#3-1-ç›®æ ‡ç±»" class="headerlink" title="3.1 ç›®æ ‡ç±»"></a>3.1 ç›®æ ‡ç±»</h3><ul>
<li>åˆ›å»ºBookServiceæ¥å£å’Œå®ç°ç±»</li>
<li>åˆ›å»ºBookDaoæ¥å£å’Œå®ç°ç±»</li>
<li>å°†daoå’Œserviceé…ç½® xmlæ–‡ä»¶</li>
<li>ä½¿ç”¨apiæµ‹è¯•</li>
</ul>
<h4 id="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºserviceå’Œdaoçš„æ¥å£ä¸å®ç°ç±»"><a href="#ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºserviceå’Œdaoçš„æ¥å£ä¸å®ç°ç±»" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºserviceå’Œdaoçš„æ¥å£ä¸å®ç°ç±»"></a>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºserviceå’Œdaoçš„æ¥å£ä¸å®ç°ç±»</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*æ¥å£*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">addBook</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*å®ç°ç±»*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title">BookService</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// æ–¹å¼1ï¼šä¹‹å‰ï¼Œæ¥å£=å®ç°ç±»</span></span><br><span class="line"><span class="comment">//	private BookDao bookDao = new BookDaoImpl();</span></span><br><span class="line">	<span class="comment">// æ–¹å¼2ï¼šæ¥å£ + setter</span></span><br><span class="line">	<span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBookDao</span><span class="params">(BookDao bookDao)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.bookDao = bookDao;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBook</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.bookDao.save();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*æ¥å£*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BookDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*å®ç°ç±»*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title">BookDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"di  add book"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶-1"><a href="#ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶-1" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶"></a>ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">                       http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	æ¨¡æ‹Ÿspringæ‰§è¡Œè¿‡ç¨‹</span></span><br><span class="line"><span class="comment">		åˆ›å»ºserviceå®ä¾‹ï¼šBookService bookService = new BookServiceImpl()	IoC  &lt;bean&gt;</span></span><br><span class="line"><span class="comment">		åˆ›å»ºdaoå®ä¾‹ï¼šBookDao bookDao = new BookDaoImpl()			IoC</span></span><br><span class="line"><span class="comment">		å°†daoè®¾ç½®ç»™serviceï¼šbookService.setBookDao(bookDao);		DI   &lt;property&gt;</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		&lt;property&gt; ç”¨äºè¿›è¡Œå±æ€§æ³¨å…¥</span></span><br><span class="line"><span class="comment">			nameï¼š beançš„å±æ€§åï¼Œé€šè¿‡setteræ–¹æ³•è·å¾—</span></span><br><span class="line"><span class="comment">				setBookDao ##&gt; BookDao  ##&gt; bookDao</span></span><br><span class="line"><span class="comment">			ref ï¼šå¦ä¸€ä¸ªbeançš„idå€¼çš„å¼•ç”¨</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- åˆ›å»ºservice --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"bookServiceId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.b_di.BookServiceImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"bookDao"</span> <span class="attr">ref</span>=<span class="string">"bookDaoId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span><span class="comment">&lt;!-- ä¾èµ–æ³¨å…¥ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- åˆ›å»ºdaoå®ä¾‹ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"bookDaoId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.b_di.BookDaoImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•-1"><a href="#ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•-1" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•"></a>ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestDI</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//ä»springå®¹å™¨è·å¾—</span></span><br><span class="line">				String xmlPath = <span class="string">"com/springlearning/b_di/beans.xml"</span>;</span><br><span class="line"></span><br><span class="line">				ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">				BookService bookService = (BookService) applicationContext.getBean(<span class="string">"bookServiceId"</span>);</span><br><span class="line">				</span><br><span class="line">				bookService.addBook();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å››ã€æ ¸å¿ƒAPI"><a href="#å››ã€æ ¸å¿ƒAPI" class="headerlink" title="å››ã€æ ¸å¿ƒAPI"></a>å››ã€æ ¸å¿ƒAPI</h2><ul>
<li>APIæ•´ä½“äº†è§£ï¼Œä¹‹åä¸ä½¿ç”¨ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹éœ€è¦</li>
</ul>
<p><img src="http://q1o3t6lvp.bkt.clouddn.com/image/jpg%E6%A0%B8%E5%BF%83api.png" alt="æ— æ³•æ˜¾ç¤º"></p>
<ul>
<li>BeanFactory ï¼šè¿™æ˜¯ä¸€ä¸ªå·¥å‚ï¼Œç”¨äºç”Ÿæˆä»»æ„bean(é‡‡å–å»¶è¿ŸåŠ è½½ï¼Œç¬¬ä¸€æ¬¡getBeanæ—¶æ‰ä¼šåˆå§‹åŒ–Bean)</li>
<li>ApplicationContextï¼šæ˜¯BeanFactoryçš„å­æ¥å£ï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ã€‚ï¼ˆå›½é™…åŒ–å¤„ç†ã€äº‹ä»¶ä¼ é€’ã€Beanè‡ªåŠ¨è£…é…ã€å„ç§ä¸åŒåº”ç”¨å±‚çš„Contextå®ç°ï¼‰ã€‚å½“é…ç½®æ–‡ä»¶è¢«åŠ è½½ï¼Œå°±è¿›è¡Œå¯¹è±¡å®ä¾‹åŒ–  </li>
</ul>
<p><span style="color:red">         <strong>ClassPathXmlApplicationContext</strong>   </span>ç”¨äºåŠ è½½classpathï¼ˆç±»è·¯å¾„ã€srcï¼‰ä¸‹çš„xml</p>
<p>â€‹                             åŠ è½½xmlè¿è¡Œæ—¶ä½ç½® â€“&gt; /WEB-INF/classes/â€¦xml  </p>
<p><span style="color:red">         <strong>FileSystemXmlApplicationContext</strong>   </span>ç”¨äºåŠ è½½æŒ‡å®šç›˜ç¬¦ä¸‹çš„xml  </p>
<p>â€‹                            åŠ è½½xmlè¿è¡Œæ—¶ä½ç½® â€“&gt; /WEB-INF/â€¦xml        </p>
<p>â€‹                é€šè¿‡java web ServletContext.getRealPath() è·å¾—å…·ä½“ç›˜ç¬¦</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//ä½¿ç”¨BeanFactory  --ç¬¬ä¸€æ¬¡è°ƒç”¨getBeanå®ä¾‹åŒ–</span></span><br><span class="line">		String xmlPath = <span class="string">"com/springlearning/b_di/beans.xml"</span>;</span><br><span class="line">		</span><br><span class="line">		BeanFactory beanFactory = <span class="keyword">new</span> XmlBeanFactory(<span class="keyword">new</span> ClassPathResource(xmlPath));</span><br><span class="line">		</span><br><span class="line">		BookService bookService = (BookService) beanFactory.getBean(<span class="string">"bookServiceId"</span>);<span class="comment">//ç¬¬ä¸€æ¬¡è°ƒç”¨getBeanæ—¶è¿›è¡Œå¯¹è±¡å®ä¾‹åŒ–</span></span><br><span class="line">		</span><br><span class="line">		bookService.addBook();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€è£…é…BeanåŸºäºXML"><a href="#äº”ã€è£…é…BeanåŸºäºXML" class="headerlink" title="äº”ã€è£…é…BeanåŸºäºXML"></a>äº”ã€è£…é…BeanåŸºäºXML</h2><h3 id="5-1-å®ä¾‹åŒ–æ–¹å¼"><a href="#5-1-å®ä¾‹åŒ–æ–¹å¼" class="headerlink" title="5.1 å®ä¾‹åŒ–æ–¹å¼"></a>5.1 å®ä¾‹åŒ–æ–¹å¼</h3><ul>
<li>ä¸‰ç§beanå®ä¾‹åŒ–æ–¹å¼ï¼š<strong>é»˜è®¤æ„é€ </strong>ã€<strong>é™æ€å·¥å‚</strong>ã€<strong>å®ä¾‹å·¥å‚</strong></li>
</ul>
<h4 id="5-1-1é»˜è®¤æ„é€ "><a href="#5-1-1é»˜è®¤æ„é€ " class="headerlink" title="5.1.1é»˜è®¤æ„é€ "></a>5.1.1é»˜è®¤æ„é€ </h4><p>â€‹       <code>&lt;bean id=&quot;&quot; class=&quot;&quot;&gt;</code> å¿…é¡»æä¾›é»˜è®¤æ„é€ </p>
<h4 id="5-1-2-é™æ€å·¥å‚"><a href="#5-1-2-é™æ€å·¥å‚" class="headerlink" title="5.1.2 é™æ€å·¥å‚"></a>5.1.2 é™æ€å·¥å‚</h4><ul>
<li><p>å¸¸ç”¨ä¸springæ•´åˆå…¶ä»–æ¡†æ¶ï¼ˆæˆ–è€…å·¥å…·)</p>
</li>
<li><p>é™æ€å·¥å‚æŒ‡ç”¨äºç”Ÿæˆå®ä¾‹å¯¹è±¡ï¼Œæ‰€æœ‰çš„æ–¹æ³•å¿…é¡»æ˜¯static</p>
<p><code>&lt;bean id=&quot;&quot; class=&quot;å·¥å‚å…¨é™å®šç±»å&quot; factory-method=&quot;é™æ€æ–¹æ³•&quot;&gt;</code> </p>
</li>
</ul>
<h5 id="5-1-2-1-å·¥å‚"><a href="#5-1-2-1-å·¥å‚" class="headerlink" title="5.1.2.1 å·¥å‚"></a>5.1.2.1 å·¥å‚</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springlearning.c_inject.b_static_factory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é™æ€å·¥å‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> l8733</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åˆ›å»ºå®ä¾‹</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UserService <span class="title">createService</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-1-2-2-Springé…ç½®"><a href="#5-1-2-2-Springé…ç½®" class="headerlink" title="5.1.2.2 Springé…ç½®"></a>5.1.2.2 Springé…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å°†é™æ€å·¥å‚åˆ›å»ºçš„å®ä¾‹äº¤äºˆspring </span></span><br><span class="line"><span class="comment">	class ç¡®å®šé™æ€å·¥å‚å…¨é™å®šç±»å</span></span><br><span class="line"><span class="comment">	factory-method ç¡®å®šé™æ€æ–¹æ³•å</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userServiceId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.c_inject.b_static_factory.MyBeanFactory"</span> <span class="attr">factory-method</span>=<span class="string">"createService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-1-3-å®ä¾‹å·¥å‚"><a href="#5-1-3-å®ä¾‹å·¥å‚" class="headerlink" title="5.1.3 å®ä¾‹å·¥å‚"></a>5.1.3 å®ä¾‹å·¥å‚</h4><ul>
<li>å®ä¾‹å·¥å‚ï¼šå¿…é¡»å…ˆæœ‰å·¥å‚å®ä¾‹å¯¹è±¡ï¼Œé€šè¿‡å®ä¾‹å¯¹è±¡åˆ›å»ºå¯¹è±¡ã€‚æä¾›æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯â€œéé™æ€â€çš„ã€‚</li>
</ul>
<h5 id="5-1-3-1-å·¥å‚"><a href="#5-1-3-1-å·¥å‚" class="headerlink" title="5.1.3.1 å·¥å‚"></a>5.1.3.1 å·¥å‚</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springlearning.c_inject.c_factory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®ä¾‹å·¥å‚,æ‰€æœ‰æ–¹æ³•éé™æ€</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> l8733</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * åˆ›å»ºå®ä¾‹</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> UserService <span class="title">createService</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-1-3-2-Springé…ç½®"><a href="#5-1-3-2-Springé…ç½®" class="headerlink" title="5.1.3.2 Springé…ç½®"></a>5.1.3.2 Springé…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åˆ›å»ºå·¥å‚å®ä¾‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myBeanFactoryId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.c_inject.c_factory.MyBeanFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è·å¾—userservice </span></span><br><span class="line"><span class="comment">	* factory-bean ç¡®å®šå·¥å‚å®ä¾‹</span></span><br><span class="line"><span class="comment">	* factory-method ç¡®å®šæ™®é€šæ–¹æ³•</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userServiceId"</span> <span class="attr">factory-bean</span>=<span class="string">"myBeanFactoryId"</span> <span class="attr">factory-method</span>=<span class="string">"createService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-Beançš„ç§ç±»"><a href="#5-2-Beançš„ç§ç±»" class="headerlink" title="5.2 Beançš„ç§ç±»"></a>5.2 Beançš„ç§ç±»</h3><p><strong>ç¬¬ä¸€ç§ï¼š</strong></p>
<p>æ™®é€šbeanï¼šä¹‹å‰æ“ä½œçš„éƒ½æ˜¯æ™®é€šbeanã€‚<code>&lt;bean id=&quot;&quot; class=&quot;A&quot;&gt;</code>ï¼Œspringç›´æ¥åˆ›å»ºAå®ä¾‹ï¼Œå¹¶è¿”å›</p>
<p><strong>ç¬¬äºŒç§ï¼š</strong></p>
<p>FactoryBeanï¼šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„beanï¼Œå…·æœ‰å·¥å‚ç”Ÿæˆå¯¹è±¡èƒ½åŠ›ï¼Œåªèƒ½ç”Ÿæˆç‰¹å®šçš„å¯¹è±¡ã€‚</p>
<p>â€‹    beanå¿…é¡»ä½¿ç”¨ FactoryBeanæ¥å£ï¼Œæ­¤æ¥å£æä¾›æ–¹æ³• getObject() ç”¨äºè·å¾—ç‰¹å®šbeanã€‚</p>
<p>â€‹    <code>&lt;bean id=&quot;&quot; class=&quot;FB&quot;&gt;</code>å…ˆåˆ›å»ºFBå®ä¾‹ï¼Œç„¶åè°ƒç”¨getObject()æ–¹æ³•ï¼Œå¹¶è¿”å›æ–¹æ³•çš„è¿”å›å€¼</p>
<p>â€‹       ä¾‹å¦‚ï¼šFB fb = new FB();</p>
<p>â€‹                   return fb.getObject();</p>
<p><strong>ç¬¬ä¸‰ç§ï¼š</strong></p>
<p>BeanFactoryï¼šå·¥å‚ï¼Œç”¨äºç”Ÿæˆä»»æ„beanã€‚æ¯”å¦‚ç”Ÿäº§ç¬¬ä¸€ç§Beanã€‚</p>
<p><strong>BeanFactory å’Œ FactoryBean å¯¹æ¯”ï¼š</strong></p>
<p>FactoryBeanï¼šç‰¹æ®Šbeanï¼Œç”¨äºç”Ÿæˆå¦ä¸€ä¸ªç‰¹å®šçš„beanã€‚ä¾‹å¦‚ï¼šProxyFactoryBean ï¼Œæ­¤å·¥å‚beanç”¨äºç”Ÿäº§ä»£ç†ã€‚<code>&lt;bean id=&quot;&quot; class=&quot;....ProxyFactoryBean&quot;&gt;</code>è·å¾—ä»£ç†å¯¹è±¡å®ä¾‹ã€‚AOPä½¿ç”¨</p>
<h3 id="5-3-Beançš„ä½œç”¨åŸŸ"><a href="#5-3-Beançš„ä½œç”¨åŸŸ" class="headerlink" title="5.3 Beançš„ä½œç”¨åŸŸ"></a>5.3 Beançš„ä½œç”¨åŸŸ</h3><table>
<thead>
<tr>
<th align="left">ç±»åˆ«</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">singleton</td>
<td align="left">åœ¨Spring IOCå®¹å™¨ä¸­ä»…å­˜åœ¨ä¸€ä¸ªBeanå®ä¾‹ï¼ŒBeanéƒ½ä»¥å•ä¾‹æ¨¡å¼å­˜åœ¨ï¼Œsingletonä¸ºé»˜è®¤å€¼</td>
</tr>
<tr>
<td align="left">prototype</td>
<td align="left">æ¯æ¬¡ä»å®¹å™¨ä¸­è°ƒç”¨Beanæ—¶ï¼Œéƒ½è¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå³æ¯æ¬¡è°ƒç”¨getBean()æ—¶ï¼Œç›¸å½“äºæ‰§è¡Œnew XxxBean()</td>
</tr>
<tr>
<td align="left">request</td>
<td align="left">æ¯æ¬¡HTTPè¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Beanï¼Œè¯¥ä½œç”¨åŸŸä»…é€‚ç”¨äºWebApplicationContextç¯å¢ƒ<br>ï¼ˆæ¯æ¬¡httpè¯·æ±‚æ˜¯ä¼šåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œè¯¥å®ä¾‹ä»…åœ¨å½“å‰http requestæœ‰æ•ˆï¼‰</td>
</tr>
<tr>
<td align="left">session</td>
<td align="left">åŒä¸€ä¸ªHTTP Sessionå…±äº«ä¸€ä¸ªBeanï¼Œä¸åŒSessionä½¿ç”¨ä¸åŒBeanï¼Œä»…é€‚ç”¨äºWebApplicationContextç¯å¢ƒ <br>ï¼ˆæ¯æ¬¡httpè¯·æ±‚æ—¶ä¼šåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œè¯¥å®ä¾‹ä»…åœ¨å½“å‰http sessionæœ‰æ•ˆï¼‰</td>
</tr>
<tr>
<td align="left">globalsession</td>
<td align="left">ä¸€èˆ¬ç”¨äºPortletåº”ç”¨ç¯å¢ƒï¼Œè¯¥ä½œç”¨åŸŸä»…é€‚ç”¨äºWebApplicationContextç¯å¢ƒ <br>ï¼ˆå…¨å±€sessionï¼Œä»…åœ¨portletåº”ç”¨ä¸­ä½¿ç”¨ï¼‰</td>
</tr>
</tbody></table>
<ul>
<li><p>å–å€¼ï¼š</p>
<p><span style="color:red">         singleton å•ä¾‹  </span>,é»˜è®¤å€¼</p>
<p><span style="color:red">                prototype å¤šä¾‹</span>,æ¯æ‰§è¡Œä¸€æ¬¡getBeanå°†è·å¾—ä¸€ä¸ªå®ä¾‹ã€‚ä¾‹å¦‚:strutsæ•´åˆspringï¼Œé…ç½®actionå¤šä¾‹ã€‚  </p>
</li>
<li><p>é…ç½®ä¿¡æ¯</p>
<p><code>&lt;bean id=*&quot;userServiceId&quot; class=*&quot;com.springlearning.d_scope.UserServiceImpl&quot; *scope=*&quot;prototype&quot;&gt;&lt;/bean&gt;</code></p>
</li>
</ul>
<p><strong>å¦‚æœä¸ºå•ä¾‹æ¨¡å¼ï¼Œnewçš„å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªï¼Œå¦‚æœä¸ºå¤šä¾‹æ¨¡å¼ï¼Œnewçš„å¯¹è±¡æ˜¯ä¸åŒçš„</strong></p>
<p><img src="http://q1o3t6lvp.bkt.clouddn.com/2019-11-29_14-34-30%E6%88%AA%E5%B1%8F.jpg" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<h3 id="5-4-Spring-Beançš„ç”Ÿå‘½å‘¨æœŸ"><a href="#5-4-Spring-Beançš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="5.4 Spring Beançš„ç”Ÿå‘½å‘¨æœŸ"></a>5.4 Spring Beançš„ç”Ÿå‘½å‘¨æœŸ</h3><p><img src="http://q1o3t6lvp.bkt.clouddn.com/SpringBean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.png" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<p>â€‹         å¯¹äºspringbeançš„ç”Ÿå‘½å‘¨æœŸï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨çš„ä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<p>ã€€ã€€ã€€ã€€1.å¢å¼ºbeançš„åŠŸèƒ½å¯ä»¥ä½¿ç”¨åå¤„ç†Beanï¼ŒBeanPostProcessor</p>
<p>ã€€ã€€ã€€ã€€2.å¦‚æœéœ€è¦åˆå§‹åŒ–æˆ–é”€æ¯æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨init-methodæ–¹æ³•å’Œdestory-methodæ–¹æ³•ã€‚</p>
<p>ã€€åŒæ—¶è¿˜éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šdestory-methodæ–¹æ³•æ˜¯åªé’ˆå¯¹äº<strong>scope=singleton</strong>çš„æ—¶å€™æ‰æœ‰æ•ˆæœï¼</p>
<h4 id="5-4-1-åˆå§‹åŒ–å’Œé”€æ¯"><a href="#5-4-1-åˆå§‹åŒ–å’Œé”€æ¯" class="headerlink" title="5.4.1 åˆå§‹åŒ–å’Œé”€æ¯"></a>5.4.1 åˆå§‹åŒ–å’Œé”€æ¯</h4><ul>
<li>ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰å’Œæ‰§è¡Œåï¼Œå°†è¿›è¡Œåˆå§‹åŒ–æˆ–é”€æ¯ã€‚</li>
</ul>
<p><code>&lt;bean id=&quot;&quot; class=&quot;&quot; init-method=&quot;åˆå§‹åŒ–æ–¹æ³•åç§°&quot; destroy-method=&quot;é”€æ¯çš„æ–¹æ³•åç§°&quot;&gt;</code></p>
<h5 id="5-4-1-1-ç›®æ ‡ç±»"><a href="#5-4-1-1-ç›®æ ‡ç±»" class="headerlink" title="5.4.1.1 ç›®æ ‡ç±»"></a>5.4.1.1 ç›®æ ‡ç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springlearning.e_lifecycle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"e_lifecycle add user"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myInit</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"åˆå§‹åŒ–ï¼ï¼"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myDestory</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"é”€æ¯ï¼ï¼"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-4-1-2-Springé…ç½®"><a href="#5-4-1-2-Springé…ç½®" class="headerlink" title="5.4.1.2 Springé…ç½®"></a>5.4.1.2 Springé…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--  </span></span><br><span class="line"><span class="comment">		init-method ç”¨äºé…ç½®åˆå§‹åŒ–æ–¹æ³•,å‡†å¤‡æ•°æ®ç­‰</span></span><br><span class="line"><span class="comment">		destroy-method ç”¨äºé…ç½®é”€æ¯æ–¹æ³•,æ¸…ç†èµ„æºç­‰</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">     </span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userServiceId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.e_lifecycle.UserServiceImpl"</span> <span class="attr">init-method</span>=<span class="string">"myInit"</span> <span class="attr">destroy-method</span>=<span class="string">"myDestory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="5-4-1-3-æµ‹è¯•"><a href="#5-4-1-3-æµ‹è¯•" class="headerlink" title="5.4.1.3 æµ‹è¯•"></a>5.4.1.3 æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">         <span class="comment">//springå·¥å‚</span></span><br><span class="line">         String xmlPath = <span class="string">"com/springlearning/e_lifecycle/beans.xml"</span>;</span><br><span class="line"><span class="comment">//         ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);ä¹‹å‰</span></span><br><span class="line">         ClassPathXmlApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);<span class="comment">//ä¹‹å</span></span><br><span class="line">         UserService userService = (UserService) applicationContext.getBean(<span class="string">"userServiceId"</span>);</span><br><span class="line">         userService.addUser();</span><br><span class="line">         </span><br><span class="line">       <span class="comment">/*è¦æ±‚ï¼š</span></span><br><span class="line"><span class="comment">        *   1.å®¹å™¨å¿…é¡»closeï¼Œé”€æ¯æ–¹æ³•æ‰èƒ½æ‰§è¡Œ; </span></span><br><span class="line"><span class="comment">            2.å¿…é¡»æ˜¯å•ä¾‹çš„(scopeä¸ºé»˜è®¤å€¼)*/</span></span><br><span class="line"><span class="comment">// 		applicationContext.getClass().getMethod("close").invoke(applicationContext);</span></span><br><span class="line"> 		<span class="comment">// * æ­¤æ–¹æ³•æ¥å£ä¸­æ²¡æœ‰å®šä¹‰ï¼Œå®ç°ç±»æä¾›</span></span><br><span class="line"> 		applicationContext.close();  </span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-4-2-BeanPostProcessor-åå¤„ç†Bean"><a href="#5-4-2-BeanPostProcessor-åå¤„ç†Bean" class="headerlink" title="5.4.2 BeanPostProcessor åå¤„ç†Bean"></a>5.4.2 BeanPostProcessor åå¤„ç†Bean</h4><ul>
<li><p>spring æä¾›ä¸€ç§æœºåˆ¶ï¼Œåªè¦å®ç°æ­¤æ¥å£BeanPostProcessorï¼Œå¹¶å°†å®ç°ç±»æä¾›ç»™springå®¹å™¨ï¼Œspringå®¹å™¨å°†è‡ªåŠ¨æ‰§è¡Œï¼Œåœ¨åˆå§‹åŒ–æ–¹æ³•å‰æ‰§è¡Œbefore()æ–¹æ³•ï¼Œåœ¨åˆå§‹åŒ–æ–¹æ³•åæ‰§è¡Œafter()æ–¹æ³•ã€‚ é…ç½®<code>&lt;bean class=&quot;&quot;&gt;</code></p>
</li>
<li><p>Factory hook(å‹¾å­) that allows for custom modification of new bean instances, e.g. checking for marker interfaces or wrapping them with proxies. </p>
</li>
<li><p>springæä¾›å·¥å‚å‹¾å­ï¼Œç”¨äºä¿®æ”¹å®ä¾‹å¯¹è±¡ï¼Œå¯ä»¥ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œæ˜¯AOPåº•å±‚ã€‚</p>
</li>
</ul>
<p><strong>æ¨¡æ‹Ÿ</strong></p>
<p>A a =new A();</p>
<p>a = B.before(a)           â€“&gt; å½“açš„å®ä¾‹å¯¹è±¡ä¼ é€’ç»™<strong>åå¤„ç†bean</strong>ï¼Œå¯ä»¥ç”Ÿæˆä»£ç†å¯¹è±¡å¹¶è¿”å›ã€‚</p>
<p>a.init();</p>
<p>a = B.after(a);</p>
<p>a.addUser();      //ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œç›®çš„åœ¨ç›®æ ‡æ–¹æ³•å‰åæ‰§è¡Œï¼ˆä¾‹å¦‚ï¼šå¼€å¯äº‹åŠ¡ã€æäº¤äº‹åŠ¡ï¼‰</p>
<p>a.destroy()</p>
<h5 id="5-4-2-1-ç¼–å†™å®ç°ç±»"><a href="#5-4-2-1-ç¼–å†™å®ç°ç±»" class="headerlink" title="5.4.2.1 ç¼–å†™å®ç°ç±»"></a>5.4.2.1 ç¼–å†™å®ç°ç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springlearning.e_lifecycle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.config.BeanPostProcessor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title">BeanPostProcessor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"åœ¨åˆå§‹åŒ–æ–¹æ³•ä¹‹å‰ï¼"</span> + beanName);</span><br><span class="line">		<span class="keyword">return</span> bean;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">postProcessAfterInitialization</span><span class="params">(<span class="keyword">final</span> Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"åœ¨åˆå§‹åŒ–æ–¹æ³•ä¹‹åï¼"</span> + beanName);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// bean ç›®æ ‡å¯¹è±¡</span></span><br><span class="line">				<span class="comment">// ç”Ÿæˆ jdk ä»£ç†</span></span><br><span class="line">				<span class="keyword">return</span> Proxy.newProxyInstance(</span><br><span class="line">						MyBeanPostProcessor<span class="class">.<span class="keyword">class</span>.<span class="title">getClassLoader</span>(),</span></span><br><span class="line"><span class="class">						<span class="title">bean</span>.<span class="title">getClass</span>().<span class="title">getInterfaces</span>(),</span></span><br><span class="line"><span class="class">						<span class="title">new</span> <span class="title">InvocationHandler</span>()</span>&#123;</span><br><span class="line">					</span><br><span class="line">								<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">									</span><br><span class="line">									System.out.println(<span class="string">"------å¼€å¯äº‹åŠ¡"</span>);</span><br><span class="line">									</span><br><span class="line">									<span class="comment">//æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></span><br><span class="line">									Object obj = method.invoke(bean, args);</span><br><span class="line">									</span><br><span class="line">									System.out.println(<span class="string">"------æäº¤äº‹åŠ¡"</span>);</span><br><span class="line">									<span class="keyword">return</span> obj;</span><br><span class="line">								&#125;&#125;);	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-4-2-2-é…ç½®æ–‡ä»¶"><a href="#5-4-2-2-é…ç½®æ–‡ä»¶" class="headerlink" title="5.4.2.2 é…ç½®æ–‡ä»¶"></a>5.4.2.2 é…ç½®æ–‡ä»¶</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å°†åå¤„ç†çš„å®ç°ç±»æ³¨å†Œç»™spring --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.springlearning.e_lifecycle.MyBeanPostProcessor"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>é—®é¢˜1ï¼šåå¤„ç†beanä½œç”¨æŸä¸€ä¸ªç›®æ ‡ç±»ï¼Œè¿˜æ˜¯æ‰€æœ‰ç›®æ ‡ç±»ï¼Ÿ</p>
<p>â€‹                ç­”æ¡ˆï¼šæ‰€æœ‰</p>
</li>
<li><p>é—®é¢˜2ï¼šå¦‚ä½•åªä½œç”¨ä¸€ä¸ªï¼Ÿ</p>
<p>â€‹                ç­”æ¡ˆï¼šé€šè¿‡â€œå‚æ•°2â€beanNameè¿›è¡Œæ§åˆ¶</p>
</li>
</ul>
<h3 id="5-5-å±æ€§ä¾èµ–æ³¨å…¥"><a href="#5-5-å±æ€§ä¾èµ–æ³¨å…¥" class="headerlink" title="5.5 å±æ€§ä¾èµ–æ³¨å…¥"></a>5.5 å±æ€§ä¾èµ–æ³¨å…¥</h3><ul>
<li><p>ä¾èµ–æ³¨å…¥æ–¹å¼ï¼šæ‰‹åŠ¨è£…é… å’Œ è‡ªåŠ¨è£…é…</p>
</li>
<li><p>æ‰‹åŠ¨è£…é…ï¼šä¸€èˆ¬è¿›è¡Œé…ç½®ä¿¡æ¯éƒ½é‡‡ç”¨æ‰‹åŠ¨</p>
<ul>
<li>åŸºäºxmlè£…é…ï¼šæ„é€ æ–¹æ³•ã€setteræ–¹æ³•</li>
<li>åŸºäºæ³¨è§£è£…é…ï¼š</li>
</ul>
</li>
<li><p>è‡ªåŠ¨è£…é…ï¼šstrutså’Œspring æ•´åˆå¯ä»¥è‡ªåŠ¨è£…é…</p>
<ul>
<li>byTypeï¼šæŒ‰ç±»å‹è£…é…</li>
<li>byNameï¼šæŒ‰åç§°è£…é…</li>
<li>constructoræ„é€ è£…é…</li>
<li>autoï¼š ä¸ç¡®å®šè£…é…  </li>
</ul>
</li>
</ul>
<h4 id="5-5-1-æ„é€ æ–¹æ³•"><a href="#5-5-1-æ„é€ æ–¹æ³•" class="headerlink" title="5.5.1 æ„é€ æ–¹æ³•"></a>5.5.1 æ„é€ æ–¹æ³•</h4><h5 id="5-5-1-1-ç›®æ ‡ç±»"><a href="#5-5-1-1-ç›®æ ‡ç±»" class="headerlink" title="5.5.1.1 ç›®æ ‡ç±»"></a>5.5.1.1 ç›®æ ‡ç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springlearning.f_xml.a_constructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer uid;</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(Integer uid, String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.uid = uid;</span><br><span class="line">		<span class="keyword">this</span>.username = username;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String username, Integer age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.username = username;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">		System.out.println();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getUid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> uid;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUid</span><span class="params">(Integer uid)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.uid = uid;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> username;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.username = username;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-5-1-2-Springé…ç½®"><a href="#5-5-1-2-Springé…ç½®" class="headerlink" title="5.5.1.2 Springé…ç½®"></a>5.5.1.2 Springé…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ„é€ æ–¹æ³•æ³¨å…¥ </span></span><br><span class="line"><span class="comment">	* &lt;constructor-arg&gt; ç”¨äºé…ç½®æ„é€ æ–¹æ³•ä¸€ä¸ªå‚æ•°argument</span></span><br><span class="line"><span class="comment">		name ï¼šå‚æ•°çš„åç§°</span></span><br><span class="line"><span class="comment">		valueï¼šè®¾ç½®æ™®é€šæ•°æ®</span></span><br><span class="line"><span class="comment">		refï¼šå¼•ç”¨æ•°æ®ï¼Œä¸€èˆ¬æ˜¯å¦ä¸€ä¸ªbean idå€¼</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		index ï¼šå‚æ•°çš„ç´¢å¼•å·ï¼Œä»0å¼€å§‹ ã€‚å¦‚æœåªæœ‰ç´¢å¼•ï¼ŒåŒ¹é…åˆ°äº†å¤šä¸ªæ„é€ æ–¹æ³•æ—¶ï¼Œé»˜è®¤ä½¿ç”¨ç¬¬ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">		type ï¼šç¡®å®šå‚æ•°ç±»å‹</span></span><br><span class="line"><span class="comment">	ä¾‹å¦‚ï¼šä½¿ç”¨åç§°name</span></span><br><span class="line"><span class="comment">		&lt;constructor-arg name="username" value="jack"&gt;&lt;/constructor-arg&gt;</span></span><br><span class="line"><span class="comment">		&lt;constructor-arg name="age" value="18"&gt;&lt;/constructor-arg&gt;</span></span><br><span class="line"><span class="comment">	ä¾‹å¦‚2ï¼šã€ç±»å‹type å’Œ  ç´¢å¼• indexã€‘</span></span><br><span class="line"><span class="comment">		&lt;constructor-arg index="0" type="java.lang.String" value="1"&gt;&lt;/constructor-arg&gt;</span></span><br><span class="line"><span class="comment">		&lt;constructor-arg index="1" type="java.lang.Integer" value="2"&gt;&lt;/constructor-arg&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.f_xml.a_constructor.User"</span> &gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span> <span class="attr">value</span>=<span class="string">"2"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="5-5-1-3-æµ‹è¯•ç±»"><a href="#5-5-1-3-æµ‹è¯•ç±»" class="headerlink" title="5.5.1.3 æµ‹è¯•ç±»"></a>5.5.1.3 æµ‹è¯•ç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springlearning.f_xml.a_constructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCons</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">         <span class="comment">//springå·¥å‚</span></span><br><span class="line">         String xmlPath = <span class="string">"com/springlearning/f_xml/a_constructor/beans.xml"</span>;</span><br><span class="line">         ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">         User user = applicationContext.getBean(<span class="string">"userId"</span>,User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">         System.out.println(user.getUsername());</span><br><span class="line">         System.out.println(user.getAge());</span><br><span class="line">			</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-5-2-setteræ–¹æ³•"><a href="#5-5-2-setteræ–¹æ³•" class="headerlink" title="5.5.2 setteræ–¹æ³•"></a>5.5.2 setteræ–¹æ³•</h4><h5 id="5-5-2-1-ç›®æ ‡ç±»"><a href="#5-5-2-1-ç›®æ ‡ç±»" class="headerlink" title="5.5.2.1 ç›®æ ‡ç±»"></a>5.5.2.1 ç›®æ ‡ç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*äºº*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String pname;</span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Address homeAddr;<span class="comment">//å®¶åº­åœ°å€</span></span><br><span class="line">	<span class="keyword">private</span> Address companyAddr;<span class="comment">//å…¬å¸åœ°å€</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getPname</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> pname;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPname</span><span class="params">(String pname)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.pname = pname;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Address <span class="title">getHomeAddr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> homeAddr;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHomeAddr</span><span class="params">(Address homeAddr)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.homeAddr = homeAddr;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Address <span class="title">getCompanyAddr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> companyAddr;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCompanyAddr</span><span class="params">(Address companyAddr)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.companyAddr = companyAddr;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Person [pname="</span> + pname + <span class="string">", age="</span> + age + <span class="string">", homeAddr="</span> + homeAddr + <span class="string">", companyAddr="</span> + companyAddr</span><br><span class="line">				+ <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*åœ°å€*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String addr;</span><br><span class="line">	<span class="keyword">private</span> String tel;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getAddr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> addr;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddr</span><span class="params">(String addr)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.addr = addr;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getTel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> tel;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTel</span><span class="params">(String tel)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.tel = tel;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Address [addr="</span> + addr + <span class="string">", tel="</span> + tel + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-5-2-2-Springé…ç½®"><a href="#5-5-2-2-Springé…ç½®" class="headerlink" title="5.5.2.2 Springé…ç½®"></a>5.5.2.2 Springé…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- setteræ–¹æ³•æ³¨å…¥ </span></span><br><span class="line"><span class="comment">		* æ™®é€šæ•°æ® </span></span><br><span class="line"><span class="comment">			&lt;property name="" value="å€¼"&gt;</span></span><br><span class="line"><span class="comment">			ç­‰æ•ˆ</span></span><br><span class="line"><span class="comment">			&lt;property name=""&gt;</span></span><br><span class="line"><span class="comment">				&lt;value&gt;å€¼</span></span><br><span class="line"><span class="comment">		* å¼•ç”¨æ•°æ®</span></span><br><span class="line"><span class="comment">			&lt;property name="" ref="å¦ä¸€ä¸ªbean"&gt;</span></span><br><span class="line"><span class="comment">			ç­‰æ•ˆ</span></span><br><span class="line"><span class="comment">			&lt;property name=""&gt;</span></span><br><span class="line"><span class="comment">				&lt;ref bean="å¦ä¸€ä¸ªbean"/&gt;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"personId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.f_xml.b_setter.Person"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"pname"</span> <span class="attr">value</span>=<span class="string">"é˜³å¿—"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>1234<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"homeAddr"</span> <span class="attr">ref</span>=<span class="string">"homeAddrId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"companyAddr"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"companyAddrId"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"homeAddrId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.f_xml.b_setter.Address"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"addr"</span> <span class="attr">value</span>=<span class="string">"é˜œå—"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"tel"</span> <span class="attr">value</span>=<span class="string">"911"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"companyAddrId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.f_xml.b_setter.Address"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"addr"</span> <span class="attr">value</span>=<span class="string">"åŒ—äº¬å…«å®å±±"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"tel"</span> <span class="attr">value</span>=<span class="string">"120"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="5-5-2-3-æµ‹è¯•"><a href="#5-5-2-3-æµ‹è¯•" class="headerlink" title="5.5.2.3 æµ‹è¯•"></a>5.5.2.3 æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSetter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//ä»springå®¹å™¨è·å¾—</span></span><br><span class="line">				String xmlPath = <span class="string">"com/springlearning/f_xml/b_setter/beans.xml"</span>;</span><br><span class="line"></span><br><span class="line">				ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);<span class="comment">//é…ç½®æ–‡ä»¶ä¸€åŠ è½½ï¼Œå¯¹è±¡å°±å®ä¾‹åŒ–äº†</span></span><br><span class="line">				Person person = (Person) applicationContext.getBean(<span class="string">"personId"</span>);</span><br><span class="line">				</span><br><span class="line">				System.out.println(person);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-5-3-På‘½ä»¤ç©ºé—´-äº†è§£å³å¯"><a href="#5-5-3-På‘½ä»¤ç©ºé—´-äº†è§£å³å¯" class="headerlink" title="5.5.3 På‘½ä»¤ç©ºé—´ [äº†è§£å³å¯]"></a>5.5.3 På‘½ä»¤ç©ºé—´ [äº†è§£å³å¯]</h4><ul>
<li><p>å¯¹â€œsetteræ–¹æ³•æ³¨å…¥â€è¿›è¡Œç®€åŒ–ï¼Œæ›¿æ¢<code>&lt;property name=&quot;å±æ€§å&quot;&gt;</code>ï¼Œè€Œæ˜¯åœ¨<code>&lt;bean p:å±æ€§å=&quot;æ™®é€šå€¼&quot; p:å±æ€§å-ref=&quot;å¼•ç”¨å€¼&quot;&gt;</code></p>
</li>
<li><p>på‘½åç©ºé—´ä½¿ç”¨å‰æï¼Œå¿…é¡»æ·»åŠ å‘½åç©ºé—´</p>
<p><img src="http://q1o3t6lvp.bkt.clouddn.com/2019-12-01_21-56-14%E6%88%AA%E5%B1%8F.jpg" alt="æ²¡æœ‰æ‰¾åˆ°ï¼"></p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"personId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.f_xml.c_p.Person"</span> </span></span><br><span class="line"><span class="tag">	    <span class="attr">p:pname</span>=<span class="string">"äºæ™“å…‰"</span> <span class="attr">p:age</span>=<span class="string">"28"</span> <span class="attr">p:homeAddr-ref</span>=<span class="string">"homeAddrId"</span></span></span><br><span class="line"><span class="tag">	    <span class="attr">p:companyAddr-ref</span>=<span class="string">"companyAddrId"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"homeAddrId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.f_xml.c_p.Address"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">p:addr</span>=<span class="string">"DG"</span> <span class="attr">p:tel</span>=<span class="string">"ä¸œè"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"companyAddrId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.f_xml.c_p.Address"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">p:addr</span>=<span class="string">"DG"</span> <span class="attr">p:tel</span>=<span class="string">"å²›å›½"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-5-4-SpEL-äº†è§£å³å¯"><a href="#5-5-4-SpEL-äº†è§£å³å¯" class="headerlink" title="5.5.4 SpEL[äº†è§£å³å¯]"></a>5.5.4 SpEL[äº†è§£å³å¯]</h4><ul>
<li>å¯¹<code>&lt;property&gt;</code>è¿›è¡Œç»Ÿä¸€ç¼–ç¨‹ï¼Œæ‰€æœ‰çš„å†…å®¹éƒ½ä½¿ç”¨value</li>
</ul>
<p><code>&lt;property name=&quot;&quot; value=&quot;#{è¡¨è¾¾å¼}&quot;&gt;</code></p>
<p>â€‹    #{123}ã€#{â€˜jackâ€™} ï¼š æ•°å­—ã€å­—ç¬¦ä¸²æ˜¯å•å¼•å·</p>
<p>â€‹    #{beanId}   ï¼šå¦ä¸€ä¸ªbeanå¼•ç”¨</p>
<p>â€‹    #{beanId.propName}  ï¼šæ“ä½œæ•°æ®</p>
<p>â€‹    #{beanId.toString()}   ï¼šæ‰§è¡Œæ–¹æ³•</p>
<p>â€‹    #{T(ç±»).å­—æ®µ|æ–¹æ³•}   ï¼šé™æ€æ–¹æ³•æˆ–å­—æ®µ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">   å¸¸è§„èµ‹å€¼ï¼š&lt;property name="cname" value="#&#123;'Jack'&#125;"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">	&lt;property name="cname" value="#&#123;customerId.cname.toUpperCase()&#125;"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">		é€šè¿‡å¦ä¸€ä¸ªbeanï¼Œè·å¾—å±æ€§ï¼Œè°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">	&lt;property name="cname" value="#&#123;customerId.cname?.toUpperCase()&#125;"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">		?.  å¦‚æœå¯¹è±¡ä¸ä¸ºnullï¼Œå°†è°ƒç”¨æ–¹æ³•</span></span><br><span class="line"><span class="comment">   </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"customerId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.f_xml.d_spel.Customer"</span> &gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cname"</span> <span class="attr">value</span>=<span class="string">"#&#123;customerId.cname?.toUpperCase()&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"pi"</span> <span class="attr">value</span>=<span class="string">"#&#123;T(java.lang.Math).PI&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>é˜…è¯»</p>
<p><a href="https://www.cnblogs.com/sharpest/p/10885210.html" target="_blank" rel="noopener">https://www.cnblogs.com/sharpest/p/10885210.html</a></p>
</li>
</ul>
<h4 id="5-5-5-é›†åˆæ³¨å…¥"><a href="#5-5-5-é›†åˆæ³¨å…¥" class="headerlink" title="5.5.5 é›†åˆæ³¨å…¥"></a>5.5.5 é›†åˆæ³¨å…¥</h4><h5 id="5-5-5-1-ç›®æ ‡ç±»"><a href="#5-5-5-1-ç›®æ ‡ç±»" class="headerlink" title="5.5.5.1 ç›®æ ‡ç±»"></a>5.5.5.1 ç›®æ ‡ç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollData</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String[] arrayData;</span><br><span class="line">	<span class="keyword">private</span> List&lt;String&gt; listData;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;String&gt; setData;</span><br><span class="line">	<span class="keyword">private</span> Map&lt;String,String&gt; mapData;</span><br><span class="line">	<span class="keyword">private</span> Properties propsData;</span><br><span class="line">	<span class="keyword">public</span> String[] getArrayData() &#123;</span><br><span class="line">		<span class="keyword">return</span> arrayData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setArrayData</span><span class="params">(String[] arrayData)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.arrayData = arrayData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getListData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> listData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setListData</span><span class="params">(List&lt;String&gt; listData)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.listData = listData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Set&lt;String&gt; <span class="title">getSetData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> setData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSetData</span><span class="params">(Set&lt;String&gt; setData)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.setData = setData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Map&lt;String, String&gt; <span class="title">getMapData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mapData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMapData</span><span class="params">(Map&lt;String, String&gt; mapData)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.mapData = mapData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Properties <span class="title">getPropsData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> propsData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPropsData</span><span class="params">(Properties propsData)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.propsData = propsData;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"CollData [\narrayData="</span> + Arrays.toString(arrayData) + <span class="string">", \nlistData="</span> + listData + <span class="string">", \nsetData="</span> + setData</span><br><span class="line">				+ <span class="string">", \nmapData="</span> + mapData + <span class="string">", \npropsData="</span> + propsData + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5-5-5-2-Springé…ç½®"><a href="#5-5-5-2-Springé…ç½®" class="headerlink" title="5.5.5.2 Springé…ç½®"></a>5.5.5.2 Springé…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		é›†åˆçš„æ³¨å…¥éƒ½æ˜¯ç»™&lt;property&gt;æ·»åŠ å­æ ‡ç­¾</span></span><br><span class="line"><span class="comment">			æ•°ç»„ï¼š&lt;array&gt;</span></span><br><span class="line"><span class="comment">			Listï¼š&lt;list&gt;</span></span><br><span class="line"><span class="comment">			Setï¼š&lt;set&gt;</span></span><br><span class="line"><span class="comment">			Mapï¼š&lt;map&gt; ï¼Œmapå­˜æ”¾k/v é”®å€¼å¯¹ï¼Œä½¿ç”¨&lt;entry&gt;æè¿°</span></span><br><span class="line"><span class="comment">			Propertiesï¼š&lt;props&gt;  &lt;prop key=""&gt;&lt;/prop&gt;  ã€é…çš„æœ€å¤šã€‘</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">		æ™®é€šæ•°æ®ï¼š&lt;value&gt;</span></span><br><span class="line"><span class="comment">		å¼•ç”¨æ•°æ®ï¼š&lt;ref&gt;</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">    </span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"collDataId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.f_xml.e_collection.CollData"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"arrayData"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>DS<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>DZD<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>å±Œä¸<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>å±Œä¸­å±Œ<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"listData"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>äºåµ©æ¥ <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>æ›¾å«<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>æ¨ç…œ<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>æ›¾å°è´¤<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"setData"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>åœå°<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>è–„çº¸<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>å…³ç³»<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapData"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"jack"</span> <span class="attr">value</span>=<span class="string">"æ°å…‹"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">key</span>&gt;</span><span class="tag">&lt;<span class="name">value</span>&gt;</span>rose<span class="tag">&lt;/<span class="name">value</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">value</span>&gt;</span>è‚‰ä¸<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"propsData"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"é«˜å¯Œå¸…"</span>&gt;</span>å«<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"ç™½å¯Œç¾"</span>&gt;</span>å¬²<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"ç”·å±Œä¸"</span>&gt;</span>æŒŠ<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="5-5-5-3-æµ‹è¯•"><a href="#5-5-5-3-æµ‹è¯•" class="headerlink" title="5.5.5.3 æµ‹è¯•"></a>5.5.5.3 æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">         <span class="comment">//springå·¥å‚</span></span><br><span class="line">         String xmlPath = <span class="string">"com/springlearning/f_xml/e_collection/beans.xml"</span>;</span><br><span class="line">         ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">         CollData collData = applicationContext.getBean(<span class="string">"collDataId"</span>,CollData<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">         </span><br><span class="line">         System.out.println(collData);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€è£…é…Bean-åŸºäºæ³¨è§£"><a href="#å…­ã€è£…é…Bean-åŸºäºæ³¨è§£" class="headerlink" title="å…­ã€è£…é…Bean åŸºäºæ³¨è§£"></a>å…­ã€è£…é…Bean åŸºäºæ³¨è§£</h2><ul>
<li><p><strong>ä»€ä¹ˆæ˜¯æ³¨è§£ï¼Ÿ</strong>        <span style="color:red">æ³¨è§£å°±æ˜¯ä¸€ä¸ªç±»ï¼Œä½¿ç”¨@æ³¨è§£åç§°</span></p>
</li>
<li><p><strong>å¼€å‘ä¸­ï¼šä½¿ç”¨æ³¨è§£ å–ä»£ xmlé…ç½®æ–‡ä»¶ã€‚</strong></p>
</li>
</ul>
<ol>
<li><h6 id="Componentå–ä»£-lt-bean-class-quot-quot-gt"><a href="#Componentå–ä»£-lt-bean-class-quot-quot-gt" class="headerlink" title="@Componentå–ä»£&lt;bean class=&quot;&quot;&gt;"></a>@Componentå–ä»£<code>&lt;bean class=&quot;&quot;&gt;</code></h6></li>
</ol>
<p>â€‹    @Component(â€œidâ€) å–ä»£ <code>&lt;bean id=&quot;&quot; class=&quot;&quot;&gt;</code></p>
<ol start="2">
<li><h6 id="webå¼€å‘ï¼Œæä¾›3ä¸ª-Componentæ³¨è§£è¡ç”Ÿæ³¨è§£ï¼ˆåŠŸèƒ½ä¸€æ ·ï¼‰å–ä»£-lt-bean-class-quot-quot-gt"><a href="#webå¼€å‘ï¼Œæä¾›3ä¸ª-Componentæ³¨è§£è¡ç”Ÿæ³¨è§£ï¼ˆåŠŸèƒ½ä¸€æ ·ï¼‰å–ä»£-lt-bean-class-quot-quot-gt" class="headerlink" title="webå¼€å‘ï¼Œæä¾›3ä¸ª@Componentæ³¨è§£è¡ç”Ÿæ³¨è§£ï¼ˆåŠŸèƒ½ä¸€æ ·ï¼‰å–ä»£&lt;bean class=&quot;&quot;&gt;"></a>webå¼€å‘ï¼Œæä¾›3ä¸ª@Componentæ³¨è§£è¡ç”Ÿæ³¨è§£ï¼ˆåŠŸèƒ½ä¸€æ ·ï¼‰å–ä»£<code>&lt;bean class=&quot;&quot;&gt;</code></h6></li>
</ol>
<p>â€‹    @Repository ï¼šdaoå±‚</p>
<p>â€‹    @Serviceï¼šserviceå±‚</p>
<p>â€‹    @Controllerï¼šwebå±‚</p>
<ol start="3">
<li><h6 id="ä¾èµ–æ³¨å…¥ï¼Œç»™ç§æœ‰å­—æ®µè®¾ç½®ï¼Œä¹Ÿå¯ä»¥ç»™setteræ–¹æ³•è®¾ç½®"><a href="#ä¾èµ–æ³¨å…¥ï¼Œç»™ç§æœ‰å­—æ®µè®¾ç½®ï¼Œä¹Ÿå¯ä»¥ç»™setteræ–¹æ³•è®¾ç½®" class="headerlink" title="ä¾èµ–æ³¨å…¥ï¼Œç»™ç§æœ‰å­—æ®µè®¾ç½®ï¼Œä¹Ÿå¯ä»¥ç»™setteræ–¹æ³•è®¾ç½®"></a>ä¾èµ–æ³¨å…¥ï¼Œç»™ç§æœ‰å­—æ®µè®¾ç½®ï¼Œä¹Ÿå¯ä»¥ç»™setteræ–¹æ³•è®¾ç½®</h6></li>
</ol>
<p>â€‹    æ™®é€šå€¼ï¼š@Value(â€œâ€)</p>
<p>â€‹    å¼•ç”¨å€¼ï¼š</p>
<p>â€‹        æ–¹å¼1ï¼šæŒ‰ç…§ã€ç±»å‹ã€‘æ³¨å…¥</p>
<p>â€‹            @Autowired</p>
<p>â€‹        æ–¹å¼2ï¼šæŒ‰ç…§ã€åç§°ã€‘æ³¨å…¥1</p>
<p>â€‹            @Autowired</p>
<p>â€‹            @Qualifier(â€œåç§°â€)</p>
<p>â€‹        æ–¹å¼3ï¼šæŒ‰ç…§ã€åç§°ã€‘æ³¨å…¥2</p>
<p>â€‹            @Resource(â€œåç§°â€)</p>
<ol start="4">
<li><h6 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h6></li>
</ol>
<p>â€‹    åˆå§‹åŒ–ï¼š@PostConstruct</p>
<p>â€‹    é”€æ¯ï¼š@PreDestroy</p>
<ol start="5">
<li><h6 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h6></li>
</ol>
<p>â€‹    @Scope(â€œprototypeâ€) å¤šä¾‹</p>
<ul>
<li>æ³¨è§£ä½¿ç”¨å‰æï¼Œæ·»åŠ å‘½åç©ºé—´ï¼Œè®©springæ‰«æå«æœ‰æ³¨è§£ç±»</li>
</ul>
<p><img src="http://q1o3t6lvp.bkt.clouddn.com/%E6%B3%A8%E8%A7%A3%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4.png" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">                       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">                       http://www.springframework.org/schema/context </span></span></span><br><span class="line"><span class="tag"><span class="string">                       http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">  <span class="comment">&lt;!--   ç”¨æ³¨è§£å–ä»£ä¹‹å‰çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">  &lt;bean id="userServiceId" class="com.springlearning.g_annotation.a_ioc.UserServiceImpl"&gt;&lt;/bean&gt;</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- ç»„ä»¶æ‰«æï¼Œæ‰«æå«æœ‰æ³¨è§£çš„ç±» --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.springlearning.g_annotation.b_web"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€æ€»ç»“"><a href="#ä¸ƒã€æ€»ç»“" class="headerlink" title="ä¸ƒã€æ€»ç»“"></a>ä¸ƒã€æ€»ç»“</h2><h3 id="7-1-ç¼–å†™æµç¨‹ï¼ˆåŸºäºxmlï¼‰"><a href="#7-1-ç¼–å†™æµç¨‹ï¼ˆåŸºäºxmlï¼‰" class="headerlink" title="7.1 ç¼–å†™æµç¨‹ï¼ˆåŸºäºxmlï¼‰"></a>7.1 ç¼–å†™æµç¨‹ï¼ˆåŸºäºxmlï¼‰</h3><ol>
<li><p>å¯¼å…¥jaråŒ…ï¼š4+1 â€“&gt; beans/core/context/expression | commons-logging  </p>
</li>
<li><p>ç¼–å†™ç›®æ ‡ç±»ï¼šdaoå’Œservice  </p>
</li>
<li><p>springé…ç½®æ–‡ä»¶</p>
</li>
</ol>
<p>IoCï¼š<code>&lt;bean id=&quot;&quot; class=&quot;&quot; &gt;</code></p>
<p>DIï¼š<code>&lt;bean&gt; &lt;property name=&quot;&quot; value=&quot;&quot; | ref=&quot;&quot;&gt;</code></p>
<p><strong>å®ä¾‹åŒ–æ–¹å¼ï¼š</strong></p>
<ol>
<li><p>é»˜è®¤æ„é€ </p>
</li>
<li><p>é™æ€å·¥å‚ï¼š<code>&lt;bean id=&quot;&quot; class=&quot;å·¥å‚ç±»&quot; factory-method=&quot;é™æ€æ–¹æ³•&quot;&gt;</code></p>
</li>
<li><p>å®ä¾‹å·¥å‚ï¼š<code>&lt;bean id=&quot;å·¥å‚id&quot; class=&quot;å·¥å‚ç±»&quot;&gt; &lt;bean id=&quot;&quot; factory-bean=&quot;å·¥å‚id&quot; factory-method=&quot;æ–¹æ³•&quot;&gt;</code></p>
</li>
</ol>
<p><strong>ä½œç”¨åŸŸï¼š</strong><code>&lt;bean id=&quot;&quot; class=&quot;&quot; scope=&quot;singleton | prototype&quot;&gt;</code></p>
<p><strong>ç”Ÿå‘½å‘¨æœŸï¼š</strong><code>&lt;bean id=&quot;&quot; class=&quot;&quot; init-method=&quot;&quot; destroy-method=&quot;&quot;&gt;</code></p>
<p> <strong>åå¤„ç†bean</strong> BeanPostProcessoræ¥å£ï¼Œ<code>&lt;bean class=&quot;æ³¨å†Œ&quot;&gt;</code> ï¼Œå¯¹å®¹å™¨ä¸­æ‰€æœ‰çš„beanéƒ½ç”Ÿæ•ˆ</p>
<p><strong>å±æ€§æ³¨å…¥</strong></p>
<p> æ„é€ æ–¹æ³•æ³¨å…¥ï¼š<code>&lt;bean&gt;&lt;constructor-arg index=&quot;&quot; type=&quot;&quot; &gt;</code></p>
<p> setteræ–¹æ³•æ³¨å…¥ï¼š<code>&lt;bean&gt;&lt;property&gt;</code></p>
<p> <strong>på‘½åç©ºé—´ï¼š</strong>ç®€åŒ–<code>&lt;property&gt;</code>  <code>&lt;bean p:å±æ€§å=&quot;æ™®é€šå€¼&quot; p:å±æ€§å-ref=&quot;å¼•ç”¨å€¼&quot;&gt; æ³¨æ„å£°æ˜å‘½åç©ºé—´</code></p>
<p> <strong>SpELï¼š</strong><code>&lt;property name=&quot;&quot; value=&quot;#{è¡¨è¾¾å¼}&quot;&gt;</code></p>
<p>   #{123} #{â€˜abcâ€™}</p>
<p>   #{beanId.propName?.methodName()}</p>
<p>   #{T(ç±»).é™æ€æ–¹æ³•|å­—æ®µ}</p>
<p> <strong>é›†åˆ</strong></p>
<p>   æ•°ç»„<code>&lt;array&gt;</code></p>
<p>   List <code>&lt;list&gt;</code></p>
<p>   Set <code>&lt;set&gt;</code></p>
<p>   Map <code>&lt;map&gt;&lt;entry key=&quot;&quot; value=&quot;&quot;&gt;</code></p>
<p>   Properties <code>&lt;props&gt;&lt;prop key=&quot;&quot;&gt;....</code></p>
<ol start="4">
<li>æ ¸å¿ƒapi  </li>
</ol>
<p>BeanFactoryï¼Œå»¶è¿Ÿå®ä¾‹åŒ–beanï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨getBean</p>
<p>â€‹    ApplicationContext ä¸€èˆ¬å¸¸ç”¨ï¼ŒåŠŸèƒ½æ›´å¼º</p>
<p>â€‹       ClassPathXmlApplicationContext åŠ è½½classpath xmlæ–‡ä»¶</p>
<p>â€‹       FileSystemXmlApplicationContext åŠ è½½æŒ‡å®šç›˜ç¬¦æ–‡ä»¶ ï¼Œ ServletContext.getRealPath()</p>
<h3 id="7-2-åå¤„ç†bean-å¯¹ä¸€ä¸ªç”Ÿæ•ˆ"><a href="#7-2-åå¤„ç†bean-å¯¹ä¸€ä¸ªç”Ÿæ•ˆ" class="headerlink" title="7.2 åå¤„ç†bean å¯¹ä¸€ä¸ªç”Ÿæ•ˆ"></a>7.2 åå¤„ç†bean å¯¹ä¸€ä¸ªç”Ÿæ•ˆ</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="string">"userServiceId"</span>.equals(beanName))&#123;</span><br><span class="line">			System.out.println(<span class="string">"å‰æ–¹æ³• ï¼š "</span> + beanName);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> bean;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-3-æ³¨è§£"><a href="#7-3-æ³¨è§£" class="headerlink" title="7.3 æ³¨è§£"></a>7.3 æ³¨è§£</h3><ol>
<li>æ‰«æå«æœ‰æ³¨è§£çš„ç±»</li>
</ol>
<p>â€‹    &lt;context:component-scan base-package=â€â€¦.â€&gt;</p>
<ol start="2">
<li>å¸¸è§çš„æ³¨è§£</li>
</ol>
<p>â€‹    @Component ç»„ä»¶ï¼Œä»»æ„bean</p>
<p>â€‹    WEB</p>
<p>â€‹       @Controller webå±‚</p>
<p>â€‹       @Service serviceå±‚</p>
<p>â€‹       @Repository daoå±‚</p>
<p>â€‹    æ³¨å…¥ â€“&gt; å­—æ®µæˆ–setteræ–¹æ³•</p>
<p>â€‹       æ™®é€šå€¼ï¼š@Value</p>
<p>â€‹       å¼•ç”¨å€¼ï¼š</p>
<p>â€‹           ç±»å‹ï¼š@Autowired</p>
<p>â€‹           åç§°1ï¼š@Autowired @Qualifier(â€œåç§°â€)</p>
<p>â€‹           åç§°2ï¼š@Resource(â€œåç§°â€)</p>
<p>â€‹    ä½œç”¨åŸŸï¼š@Scope(â€œprototypeâ€) </p>
<p>â€‹    ç”Ÿå‘½å‘¨æœŸï¼š</p>
<p>â€‹       åˆå§‹åŒ–ï¼š@PostConstruct</p>
<p>â€‹       é”€æ¯æ–¹æ³•ï¼š@PreDestroy</p>
<h3 id="7-4-æ³¨è§£å’Œxmlæ··åˆä½¿ç”¨"><a href="#7-4-æ³¨è§£å’Œxmlæ··åˆä½¿ç”¨" class="headerlink" title="7.4 æ³¨è§£å’Œxmlæ··åˆä½¿ç”¨"></a>7.4 æ³¨è§£å’Œxmlæ··åˆä½¿ç”¨</h3><ol>
<li><p>å°†æ‰€æœ‰çš„beanéƒ½é…ç½®xmlä¸­</p>
<p><code>&lt;bean id=&quot;&quot; class=&quot;&quot;&gt;</code></p>
</li>
<li><p>å°†æ‰€æœ‰çš„ä¾èµ–éƒ½ä½¿ç”¨æ³¨è§£</p>
</li>
</ol>
<p>â€‹    @Autowired</p>
<p>â€‹    é»˜è®¤ä¸ç”Ÿæ•ˆã€‚ä¸ºäº†ç”Ÿæ•ˆï¼Œéœ€è¦åœ¨xmlé…ç½®ï¼š<code>&lt;context:annotation-config&gt;</code></p>
<p>æ€»ç»“ï¼š</p>
<p><strong>æ³¨è§£1ï¼š</strong><code>&lt;context:component-scan base-package=&quot; &quot;&gt;</code></p>
<p><strong>æ³¨è§£2ï¼š</strong><code>&lt;context:annotation-config&gt;</code></p>
<ol>
<li><p>ä¸€èˆ¬æƒ…å†µä¸¤ä¸ªæ³¨è§£ä¸ä¸€èµ·ä½¿ç”¨ã€‚</p>
</li>
<li><p>â€œæ³¨è§£1â€æ‰«æå«æœ‰æ³¨è§£ï¼ˆ@Component ç­‰ï¼‰ç±»ï¼Œæ³¨å…¥æ³¨è§£è‡ªåŠ¨ç”Ÿæ•ˆã€‚</p>
</li>
</ol>
<p>â€œæ³¨è§£2â€åªåœ¨xmlå’Œæ³¨è§£ï¼ˆæ³¨å…¥ï¼‰æ··åˆä½¿ç”¨æ—¶ï¼Œä½¿æ³¨å…¥æ³¨è§£ç”Ÿæ•ˆã€‚</p>
]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringBoot-day01</title>
    <url>/2019/12/17/SpringBoot-day01/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€äº†è§£-Spring-Boot"><a href="#ä¸€ã€äº†è§£-Spring-Boot" class="headerlink" title="ä¸€ã€äº†è§£ Spring Boot"></a>ä¸€ã€äº†è§£ Spring Boot</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯Spring-Bootï¼Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯Spring-Bootï¼Ÿ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯Spring Bootï¼Ÿ"></a>1.1 ä»€ä¹ˆæ˜¯Spring Bootï¼Ÿ</h3><pre><code>Spring Bootæ˜¯Springé¡¹ç›®ä¸­çš„ä¸€ä¸ªå­å·¥ç¨‹ï¼Œä¸æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„Spring-framework åŒå±äºspringçš„äº§å“ã€‚</code></pre><p>â€‹        å®˜ç½‘è§£é‡Šç¿»è¯‘ä¸ºï¼š</p>
<blockquote>
<p>ç”¨ä¸€äº›å›ºå®šçš„æ–¹å¼æ¥æ„å»ºç”Ÿäº§çº§åˆ«çš„springåº”ç”¨ã€‚Spring Boot æ¨å´‡çº¦å®šå¤§äºé…ç½®çš„æ–¹å¼ä»¥ä¾¿äºä½ èƒ½å¤Ÿå°½å¯èƒ½å¿«é€Ÿçš„å¯åŠ¨å¹¶è¿è¡Œç¨‹åºã€‚</p>
</blockquote>
<p>å…¶å®äººä»¬æŠŠSpring Boot ç§°ä¸ºæ­å»ºç¨‹åºçš„`<strong>è„šæ‰‹æ¶</strong>`ã€‚å…¶æœ€ä¸»è¦ä½œç”¨å°±æ˜¯å¸®æˆ‘ä»¬å¿«é€Ÿçš„æ„å»ºåºå¤§çš„springé¡¹ç›®ï¼Œå¹¶ä¸”å°½å¯èƒ½çš„å‡å°‘ä¸€åˆ‡xmlé…ç½®ï¼Œåšåˆ°å¼€ç®±å³ç”¨ï¼Œè¿…é€Ÿä¸Šæ‰‹ï¼Œè®©æˆ‘ä»¬å…³æ³¨ä¸ä¸šåŠ¡è€Œéé…ç½®ã€‚</p>
<h3 id="1-2-ä¸ºä»€ä¹ˆå­¦ä¹ Spring-Bootï¼Ÿ"><a href="#1-2-ä¸ºä»€ä¹ˆå­¦ä¹ Spring-Bootï¼Ÿ" class="headerlink" title="1.2 ä¸ºä»€ä¹ˆå­¦ä¹ Spring Bootï¼Ÿ"></a>1.2 ä¸ºä»€ä¹ˆå­¦ä¹ Spring Bootï¼Ÿ</h3><p>javaä¸€ç›´è¢«äººè¯Ÿç—…çš„ä¸€ç‚¹å°±æ˜¯è‡ƒè‚¿ã€éº»çƒ¦ã€‚å…¶ä¸»è¦åŸå› æœ‰ä¸¤ç‚¹ï¼š</p>
<ul>
<li><p>å¤æ‚çš„é…ç½®</p>
<p>é¡¹ç›®å„ç§é…ç½®å…¶å®æ˜¯å¼€å‘æ—¶çš„æŸè€—ï¼Œ å› ä¸ºåœ¨æ€è€ƒ Spring ç‰¹æ€§é…ç½®å’Œè§£å†³ä¸šåŠ¡é—®é¢˜ä¹‹é—´éœ€è¦è¿›è¡Œæ€ç»´åˆ‡æ¢ï¼Œæ‰€ä»¥å†™é…ç½®æŒ¤å äº†å†™åº”ç”¨ç¨‹åºé€»è¾‘çš„æ—¶é—´ã€‚</p>
</li>
<li><p>ä¸€ä¸ªæ˜¯æ··ä¹±çš„ä¾èµ–ç®¡ç†</p>
<p>é¡¹ç›®çš„ä¾èµ–ç®¡ç†ä¹Ÿæ˜¯ä»¶åƒåŠ›ä¸è®¨å¥½çš„äº‹æƒ…ã€‚å†³å®šé¡¹ç›®é‡Œè¦ç”¨å“ªäº›åº“å°±å·²ç»å¤Ÿè®©äººå¤´ç—›çš„äº†ï¼Œä½ è¿˜è¦çŸ¥é“è¿™äº›åº“çš„å“ªä¸ªç‰ˆæœ¬å’Œå…¶ä»–åº“ä¸ä¼šæœ‰å†²çªï¼Œè¿™éš¾é¢˜å®åœ¨å¤ªæ£˜æ‰‹ã€‚å¹¶ä¸”ï¼Œä¾èµ–ç®¡ç†ä¹Ÿæ˜¯ä¸€ç§æŸè€—ï¼Œæ·»åŠ ä¾èµ–ä¸æ˜¯å†™åº”ç”¨ç¨‹åºä»£ç ã€‚ä¸€æ—¦é€‰é”™äº†ä¾èµ–çš„ç‰ˆæœ¬ï¼Œéšä¹‹è€Œæ¥çš„ä¸å…¼å®¹é—®é¢˜æ¯«æ— ç–‘é—®ä¼šæ˜¯ç”Ÿäº§åŠ›æ€æ‰‹ã€‚</p>
</li>
</ul>
<p>è€ŒSpring Bootè®©è¿™ä¸€åˆ‡æˆä¸ºè¿‡å»ï¼</p>
<blockquote>
<p>Spring Boot ç®€åŒ–äº†åŸºäºSpringçš„åº”ç”¨å¼€å‘ï¼Œåªéœ€è¦â€œrunâ€å°±èƒ½åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ã€ç”Ÿäº§çº§åˆ«çš„Springåº”ç”¨ã€‚Spring Bootä¸ºSpringå¹³å°åŠç¬¬ä¸‰æ–¹åº“æä¾›å¼€ç®±å³ç”¨çš„è®¾ç½®ï¼ˆæä¾›é»˜è®¤è®¾ç½®ï¼Œå­˜æ”¾é»˜è®¤é…ç½®çš„åŒ…å°±æ˜¯å¯åŠ¨å™¨ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç®€å•çš„å¼€å§‹ã€‚å¤šæ•°Spring Bootåº”ç”¨åªéœ€è¦å¾ˆå°‘çš„Springé…ç½®ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨SpringBootåˆ›å»ºjavaåº”ç”¨ï¼Œå¹¶ä½¿ç”¨java â€“jar å¯åŠ¨å®ƒï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªç”Ÿäº§çº§åˆ«çš„webå·¥ç¨‹ã€‚</p>
<a id="more"></a>

<h3 id="1-3-SpringBootçš„ç‰¹ç‚¹"><a href="#1-3-SpringBootçš„ç‰¹ç‚¹" class="headerlink" title="1.3 SpringBootçš„ç‰¹ç‚¹"></a>1.3 SpringBootçš„ç‰¹ç‚¹</h3><p>Spring Boot ä¸»è¦ç›®æ ‡æ˜¯ï¼š</p>
<ul>
<li>ä¸ºæ‰€æœ‰ Spring çš„å¼€å‘è€…æä¾›ä¸€ä¸ªéå¸¸å¿«é€Ÿçš„ã€å¹¿æ³›æ¥å—çš„å…¥é—¨ä½“éªŒ</li>
<li>å¼€ç®±å³ç”¨ï¼ˆå¯åŠ¨å™¨starter-å…¶å®å°±æ˜¯SpringBootæä¾›çš„ä¸€ä¸ªjaråŒ…ï¼‰ï¼Œä½†é€šè¿‡è‡ªå·±è®¾ç½®å‚æ•°ï¼ˆ.propertiesï¼‰ï¼Œå³å¯å¿«é€Ÿæ‘†è„±è¿™ç§æ–¹å¼ã€‚</li>
<li>æä¾›äº†ä¸€äº›å¤§å‹é¡¹ç›®ä¸­å¸¸è§çš„éåŠŸèƒ½æ€§ç‰¹æ€§ï¼Œå¦‚å†…åµŒæœåŠ¡å™¨ã€å®‰å…¨ã€æŒ‡æ ‡ï¼Œå¥åº·æ£€æµ‹ã€å¤–éƒ¨åŒ–é…ç½®ç­‰</li>
<li>ç»å¯¹æ²¡æœ‰ä»£ç ç”Ÿæˆï¼Œä¹Ÿæ— éœ€ XML é…ç½®ã€‚</li>
</ul>
<p>æ›´å¤šç»†èŠ‚ï¼Œå¤§å®¶å¯ä»¥åˆ°<a href="http://projects.spring.io/spring-boot/" target="_blank" rel="noopener">å®˜ç½‘</a>æŸ¥çœ‹ã€‚</p>
<h2 id="äºŒã€å¿«é€Ÿå…¥é—¨"><a href="#äºŒã€å¿«é€Ÿå…¥é—¨" class="headerlink" title="äºŒã€å¿«é€Ÿå…¥é—¨"></a>äºŒã€å¿«é€Ÿå…¥é—¨</h2><h3 id="2-1-åˆ›å»ºå·¥ç¨‹"><a href="#2-1-åˆ›å»ºå·¥ç¨‹" class="headerlink" title="2.1 åˆ›å»ºå·¥ç¨‹"></a>2.1 åˆ›å»ºå·¥ç¨‹</h3><p>å¿«é€Ÿåˆ›å»ºä¸€ä¸ªmavenå·¥ç¨‹ï¼Œåœ¨ideaä¸­ä½¿ç”¨è‡ªå·±çš„mavenä»“åº“ï¼Œmavenç‰ˆæœ¬ä¸èƒ½å¤ªé«˜ï¼Œå¦åˆ™é¡¹ç›®ä¾èµ–æ— æ³•æ­£å¸¸å¯¼å…¥ï¼Œé…ç½®mavençš„settings.xmlæ–‡ä»¶ç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œä½¿ç”¨å›½å†…çš„é˜¿é‡Œé•œåƒå¯¼å…¥ä¾èµ–ä¼šå¾ˆå¿«ã€‚</p>
<h3 id="2-2-æ·»åŠ ä¾èµ–"><a href="#2-2-æ·»åŠ ä¾èµ–" class="headerlink" title="2.2 æ·»åŠ ä¾èµ–"></a>2.2 æ·»åŠ ä¾èµ–</h3><p>åœ¨pom.xmlä¸­æ·»åŠ ä½¿ç”¨springbootç›¸å…³çš„ä¾èµ–ã€‚</p>
<h4 id="2-2-1-æ·»åŠ çˆ¶å·¥ç¨‹åæ ‡"><a href="#2-2-1-æ·»åŠ çˆ¶å·¥ç¨‹åæ ‡" class="headerlink" title="2.2.1 æ·»åŠ çˆ¶å·¥ç¨‹åæ ‡"></a>2.2.1 æ·»åŠ çˆ¶å·¥ç¨‹åæ ‡</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-æ·»åŠ webå¯åŠ¨å™¨"><a href="#2-2-2-æ·»åŠ webå¯åŠ¨å™¨" class="headerlink" title="2.2.2 æ·»åŠ webå¯åŠ¨å™¨"></a>2.2.2 æ·»åŠ webå¯åŠ¨å™¨</h4><p>ä¸ºäº†è®©SpringBootå¸®æˆ‘ä»¬å®Œæˆå„ç§è‡ªåŠ¨é…ç½®ï¼Œæˆ‘ä»¬å¿…é¡»å¼•å…¥SpringBootæä¾›çš„è‡ªåŠ¨é…ç½®ä¾èµ–ï¼Œæˆ‘ä»¬ç§°ä¸º`å¯åŠ¨å™¨`ã€‚å› ä¸ºæˆ‘ä»¬æ˜¯webé¡¹ç›®ï¼Œè¿™é‡Œæˆ‘ä»¬å¼•å…¥webå¯åŠ¨å™¨ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨è¿™é‡ŒæŒ‡å®šç‰ˆæœ¬ä¿¡æ¯ã€‚å› ä¸ºSpringBootçš„çˆ¶å·¥ç¨‹å·²ç»å¯¹ç‰ˆæœ¬è¿›è¡Œäº†ç®¡ç†äº†ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°é¡¹ç›®ä¸­å¤šå‡ºäº†å¤§é‡çš„ä¾èµ–ã€‚</p>
<h4 id="2-2-3-ç®¡ç†jdkç‰ˆæœ¬"><a href="#2-2-3-ç®¡ç†jdkç‰ˆæœ¬" class="headerlink" title="2.2.3 ç®¡ç†jdkç‰ˆæœ¬"></a>2.2.3 ç®¡ç†jdkç‰ˆæœ¬</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-4-å®Œæ•´-pom-xmlæ–‡ä»¶"><a href="#2-2-4-å®Œæ•´-pom-xmlæ–‡ä»¶" class="headerlink" title="2.2.4 å®Œæ•´ pom.xmlæ–‡ä»¶"></a>2.2.4 å®Œæ•´ pom.xmlæ–‡ä»¶</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.leyou.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-å¯åŠ¨ç±»"><a href="#2-3-å¯åŠ¨ç±»" class="headerlink" title="2.3 å¯åŠ¨ç±»"></a>2.3 å¯åŠ¨ç±»</h3><p>Spring Booté¡¹ç›®é€šè¿‡mainå‡½æ•°å³å¯å¯åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå¯åŠ¨ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(Application<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-ç¼–å†™controller"><a href="#2-4-ç¼–å†™controller" class="headerlink" title="2.4 ç¼–å†™controller"></a>2.4 ç¼–å†™controller</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@Controller</span><br><span class="line">public class HelloController &#123;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;responseBodyä¸€èˆ¬æ˜¯ä½œç”¨åœ¨æ–¹æ³•ä¸Šçš„ï¼ŒåŠ ä¸Šè¯¥æ³¨è§£è¡¨ç¤ºè¯¥æ–¹æ³•çš„è¿”å›ç»“æœç›´æ¥å†™åˆ°Http response Bodyä¸­ï¼Œå¸¸ç”¨åœ¨ajaxå¼‚æ­¥è¯·æ±‚ä¸­ï¼Œ</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;åœ¨RequestMappingä¸­ returnè¿”å›å€¼é»˜è®¤è§£æä¸ºè·³è½¬è·¯å¾„ï¼Œå¦‚æœä½ æ­¤æ—¶æƒ³è®©Controllerè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡åˆ°å‰å° å°±ä¼šæŠ¥404 not responseçš„é”™è¯¯ã€‚</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;å½“åŠ ä¸Š@ResponseBodyæ³¨è§£åä¸ä¼šè§£ææˆè·³è½¬åœ°å€ ä¼šè§£ææˆç›¸åº”çš„jsonæ ¼å¼çš„å¯¹è±¡ é›†åˆ å­—ç¬¦ä¸²æˆ–è€…xmlç­‰ç›´æ¥è¿”å›ç»™å‰å° å¯ä»¥é€šè¿‡ ajax çš„â€œsuccessâ€ï¼šfucntion(data)&#123;&#125; dataç›´æ¥è·å–åˆ°ã€‚</span><br><span class="line">    @GetMapping(&quot;hello&quot;)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    public String hello()&#123;</span><br><span class="line">        return &quot;hello spring boot&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-5-å¯åŠ¨æµ‹è¯•"><a href="#2-5-å¯åŠ¨æµ‹è¯•" class="headerlink" title="2.5 å¯åŠ¨æµ‹è¯•"></a>2.5 å¯åŠ¨æµ‹è¯•</h3><ul>
<li>1ï¼‰ç›‘å¬çš„ç«¯å£æ˜¯8080</li>
<li>2ï¼‰SpringMVCçš„æ˜ å°„è·¯å¾„æ˜¯ï¼š/</li>
<li>3ï¼‰<code>/hello</code>è·¯å¾„å·²ç»æ˜ å°„åˆ°äº†<code>HelloController</code>ä¸­çš„<code>hello()</code>æ–¹æ³•</li>
</ul>
<p>æ‰“å¼€é¡µé¢è®¿é—®ï¼š<a href="http://localhost:8080/hello" target="_blank" rel="noopener">http://localhost:8080/hello</a>    é¡µé¢æœ‰æ‰€æ˜¾ç¤ºå°±æ˜¯æˆåŠŸäº†ï¼</p>
<h2 id="ä¸‰ã€Javaé…ç½®"><a href="#ä¸‰ã€Javaé…ç½®" class="headerlink" title="ä¸‰ã€Javaé…ç½®"></a>ä¸‰ã€Javaé…ç½®</h2><h3 id="3-1-å°è¯•javaé…ç½®æ•°æ®åº“è¿æ¥æ± "><a href="#3-1-å°è¯•javaé…ç½®æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="3.1 å°è¯•javaé…ç½®æ•°æ®åº“è¿æ¥æ± "></a>3.1 å°è¯•javaé…ç½®æ•°æ®åº“è¿æ¥æ± </h3><p>javaé…ç½®ä¸»è¦é javaç±»å’Œä¸€äº›æ³¨è§£ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ³¨è§£æœ‰ï¼š</p>
<ul>
<li><code>@Configuration</code>ï¼šå£°æ˜ä¸€ä¸ªç±»ä½œä¸ºé…ç½®ç±»ï¼Œä»£æ›¿xmlæ–‡ä»¶</li>
<li><code>@Bean</code>ï¼šå£°æ˜åœ¨æ–¹æ³•ä¸Šï¼Œå°†æ–¹æ³•çš„è¿”å›å€¼åŠ å…¥Beanå®¹å™¨ï¼Œä»£æ›¿<code>&lt;bean&gt;</code>æ ‡ç­¾</li>
<li><code>@value</code>ï¼šå±æ€§æ³¨å…¥</li>
<li><code>@PropertySource</code>ï¼šæŒ‡å®šå¤–éƒ¨å±æ€§æ–‡ä»¶ï¼Œ</li>
</ul>
<p>æ¥ä¸‹æ¥ç”¨javaé…ç½®æ¥å°è¯•å®ç°è¿æ¥æ± é…ç½®ï¼š</p>
<p>é¦–å…ˆå¼•å…¥Druidè¿æ¥æ± ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ªjdbc.propertiesæ–‡ä»¶ï¼Œç¼–å†™jdbcå±æ€§ï¼š</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">jdbc.driverClassName</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">jdbc.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/leyou</span></span><br><span class="line"><span class="meta">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">jdbc.password</span>=<span class="string">123</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åç¼–å†™ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@PropertySource</span>(<span class="string">"classpath:jdbc.properties"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.url&#125;"</span>)</span><br><span class="line">    String url;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.driverClassName&#125;"</span>)</span><br><span class="line">    String driverClassName;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.username&#125;"</span>)</span><br><span class="line">    String username;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;jdbc.password&#125;"</span>)</span><br><span class="line">    String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">dataSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        DruidDataSource dataSource = <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">        dataSource.setUrl(url);</span><br><span class="line">        dataSource.setDriverClassName(driverClassName);</span><br><span class="line">        dataSource.setUsername(username);</span><br><span class="line">        dataSource.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è§£è¯»ï¼š</p>
<ul>
<li><code>@Configuration</code>ï¼šå£°æ˜æˆ‘ä»¬<code>JdbcConfig</code>æ˜¯ä¸€ä¸ªé…ç½®ç±»</li>
<li><code>@PropertySource</code>ï¼šæŒ‡å®šå±æ€§æ–‡ä»¶çš„è·¯å¾„æ˜¯:<code>classpath:jdbc.properties</code></li>
<li>é€šè¿‡<code>@Value</code>ä¸ºå±æ€§æ³¨å…¥å€¼</li>
<li>é€šè¿‡@Beanå°† <code>dataSource()</code>æ–¹æ³•å£°æ˜ä¸ºä¸€ä¸ªæ³¨å†ŒBeançš„æ–¹æ³•ï¼ŒSpringä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå°†æ–¹æ³•çš„è¿”å›å€¼åŠ å…¥Springå®¹å™¨ä¸­ã€‚</li>
</ul>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»æ„ä½ç½®é€šè¿‡<code>@Autowired</code>æ³¨å…¥DataSourceäº†ï¼</p>
<p>æˆ‘ä»¬åœ¨<code>HelloController</code>ä¸­æµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello, spring boot!"</span> + dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åDebugè¿è¡Œå¹¶æŸ¥çœ‹ï¼Œé‡æ–°è®¿é—®helloé¡µé¢ï¼Œä¹‹ååˆ°æ§åˆ¶å°è¿›è¡ŒæŸ¥çœ‹ï¼Œåªè¦æœ‰ä¹‹å‰jdbc.properties </p>
<p>ä¸­çš„å±æ€§æ˜¾ç¤ºï¼Œå°±ç®—æˆåŠŸäº†ï¼</p>
<h3 id="3-2-SpringBootçš„å±æ€§æ³¨å…¥"><a href="#3-2-SpringBootçš„å±æ€§æ³¨å…¥" class="headerlink" title="3.2 SpringBootçš„å±æ€§æ³¨å…¥"></a>3.2 SpringBootçš„å±æ€§æ³¨å…¥</h3><p>åœ¨ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ï¼Œå®ç°äº†javaé…ç½®æ–¹å¼ã€‚ä¸è¿‡å±æ€§æ³¨å…¥ä½¿ç”¨çš„æ˜¯@Valueæ³¨è§£ã€‚è¿™ç§æ–¹å¼è™½ç„¶å¯è¡Œï¼Œä½†æ˜¯ä¸å¤Ÿå¼ºå¤§ï¼Œå› ä¸ºå®ƒåªèƒ½æ³¨å…¥åŸºæœ¬ç±»å‹å€¼ã€‚</p>
<p>åœ¨SpringBootä¸­ï¼Œæä¾›äº†ä¸€ç§æ–°çš„å±æ€§æ³¨å…¥æ–¹å¼ï¼Œæ”¯æŒå„ç§javaåŸºæœ¬æ•°æ®ç±»å‹åŠå¤æ‚ç±»å‹çš„æ³¨å…¥ã€‚</p>
<p>1ï¼‰æ–°å»ºä¸€ä¸ªç±»ï¼Œç”¨æ¥è¿›è¡Œå±æ€§æ³¨å…¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"jdbc"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcProperties</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String driverClassName;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">// ... ç•¥</span></span><br><span class="line">    <span class="comment">// getters å’Œ setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>åœ¨ç±»ä¸Šé€šè¿‡@ConfigurationPropertiesæ³¨è§£å£°æ˜å½“å‰ç±»ä¸ºå±æ€§è¯»å–ç±»</p>
</li>
<li><p><code>prefix=&quot;jdbc&quot;</code>è¯»å–å±æ€§æ–‡ä»¶ä¸­ï¼Œå‰ç¼€ä¸ºjdbcçš„å€¼ã€‚</p>
</li>
<li><p>åœ¨ç±»ä¸Šå®šä¹‰å„ä¸ªå±æ€§ï¼Œåç§°å¿…é¡»ä¸å±æ€§æ–‡ä»¶ä¸­<code>jdbc.</code>åé¢éƒ¨åˆ†ä¸€è‡´</p>
</li>
<li><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬å¹¶æ²¡æœ‰æŒ‡å®šå±æ€§æ–‡ä»¶çš„åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠjdbc.propertiesåç§°æ”¹ä¸ºapplication.propertiesï¼Œè¿™æ˜¯SpringBooté»˜è®¤è¯»å–çš„å±æ€§æ–‡ä»¶åï¼š</p>
</li>
</ul>
<p>2ï¼‰åœ¨JdbcConfigä¸­ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(JdbcProperties<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">JdbcConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">dataSource</span><span class="params">(JdbcProperties jdbc)</span> </span>&#123;</span><br><span class="line">        DruidDataSource dataSource = <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">        dataSource.setUrl(jdbc.getUrl());</span><br><span class="line">        dataSource.setDriverClassName(jdbc.getDriverClassName());</span><br><span class="line">        dataSource.setUsername(jdbc.getUsername());</span><br><span class="line">        dataSource.setPassword(jdbc.getPassword());</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>é€šè¿‡<code>@EnableConfigurationProperties(JdbcProperties.class)</code>æ¥å£°æ˜è¦ä½¿ç”¨<code>JdbcProperties</code>è¿™ä¸ªç±»çš„å¯¹è±¡</p>
</li>
<li><p>ç„¶åä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ³¨å…¥JdbcPropertiesï¼š</p>
<ul>
<li>@Autowiredæ³¨å…¥</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> JdbcProperties prop;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ„é€ å‡½æ•°æ³¨å…¥</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> JdbcProperties prop;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">JdbcConfig</span><span class="params">(Jdbcproperties prop)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.prop = prop;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å£°æ˜æœ‰@Beançš„æ–¹æ³•å‚æ•°æ³¨å…¥</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Datasource <span class="title">dataSource</span><span class="params">(JdbcProperties prop)</span></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨ç¬¬ä¸‰ç§æ–¹å¼ã€‚</p>
<p>3ï¼‰æµ‹è¯•ç»“æœä¼šå¦‚ä¸Šä¸€æ¬¡ä¸€æ ·ã€‚</p>
<p>ä¼˜åŠ¿ï¼š</p>
<ul>
<li><p>Relaxed bindingï¼šæ¾æ•£ç»‘å®š</p>
<ul>
<li><p>ä¸ä¸¥æ ¼è¦æ±‚å±æ€§æ–‡ä»¶ä¸­çš„å±æ€§åä¸æˆå‘˜å˜é‡åä¸€è‡´ã€‚æ”¯æŒé©¼å³°ï¼Œä¸­åˆ’çº¿ï¼Œä¸‹åˆ’çº¿ç­‰ç­‰è½¬æ¢ï¼Œç”šè‡³æ”¯æŒå¯¹è±¡å¼•å¯¼ã€‚æ¯”å¦‚ï¼šuser.friend.nameï¼šä»£è¡¨çš„æ˜¯userå¯¹è±¡ä¸­çš„friendå±æ€§ä¸­çš„nameå±æ€§ï¼Œæ˜¾ç„¶friendä¹Ÿæ˜¯å¯¹è±¡ã€‚@valueæ³¨è§£å°±éš¾ä»¥å®Œæˆè¿™æ ·çš„æ³¨å…¥æ–¹å¼ã€‚</p>
</li>
<li><p>meta-data supportï¼šå…ƒæ•°æ®æ”¯æŒï¼Œå¸®åŠ©IDEç”Ÿæˆå±æ€§æç¤ºï¼ˆå†™å¼€æºæ¡†æ¶ä¼šç”¨åˆ°ï¼‰ã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 id="3-3-æ›´ä¼˜é›…çš„æ³¨å…¥"><a href="#3-3-æ›´ä¼˜é›…çš„æ³¨å…¥" class="headerlink" title="3.3 æ›´ä¼˜é›…çš„æ³¨å…¥"></a>3.3 æ›´ä¼˜é›…çš„æ³¨å…¥</h3><p>äº‹å®ä¸Šï¼Œå¦‚æœä¸€æ®µå±æ€§åªæœ‰ä¸€ä¸ªBeanéœ€è¦ä½¿ç”¨ï¼Œæˆ‘ä»¬æ— éœ€å°†å…¶æ³¨å…¥åˆ°ä¸€ä¸ªç±»ï¼ˆJdbcPropertiesï¼‰ä¸­ã€‚è€Œæ˜¯ç›´æ¥åœ¨éœ€è¦çš„åœ°æ–¹å£°æ˜å³å¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcConfig</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="comment">// å£°æ˜è¦æ³¨å…¥çš„å±æ€§å‰ç¼€ï¼ŒSpringBootä¼šè‡ªåŠ¨æŠŠç›¸å…³å±æ€§é€šè¿‡setæ–¹æ³•æ³¨å…¥åˆ°DataSourceä¸­</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"jdbc"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">dataSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        DruidDataSource dataSource = <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç›´æ¥æŠŠ<code>@ConfigurationProperties(prefix = &quot;jdbc&quot;)</code>å£°æ˜åœ¨éœ€è¦ä½¿ç”¨çš„<code>@Bean</code>çš„æ–¹æ³•ä¸Šï¼Œç„¶åSpringBootå°±ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªBeanï¼ˆæ­¤å¤„æ˜¯DataSourceï¼‰çš„setæ–¹æ³•ï¼Œç„¶åå®Œæˆæ³¨å…¥ã€‚ä½¿ç”¨çš„å‰ææ˜¯ï¼š<strong>è¯¥ç±»å¿…é¡»æœ‰å¯¹åº”å±æ€§çš„setæ–¹æ³•ï¼</strong></p>
]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>SpringBoot</tag>
      </tags>
  </entry>
  <entry>
    <title>Springå­¦ä¹ ç¬¬ä¸‰å¤©</title>
    <url>/2019/12/08/Spring%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B8%89%E5%A4%A9/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>[toc]</p>
<h2 id="ä¸€ã€äº‹åŠ¡ç®¡ç†"><a href="#ä¸€ã€äº‹åŠ¡ç®¡ç†" class="headerlink" title="ä¸€ã€äº‹åŠ¡ç®¡ç†"></a>ä¸€ã€äº‹åŠ¡ç®¡ç†</h2><h3 id="1-1-å›é¡¾äº‹åŠ¡"><a href="#1-1-å›é¡¾äº‹åŠ¡" class="headerlink" title="1.1 å›é¡¾äº‹åŠ¡"></a>1.1 å›é¡¾äº‹åŠ¡</h3><h4 id="1-1-1-ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ"><a href="#1-1-1-ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ" class="headerlink" title="1.1.1 ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ"></a>1.1.1 ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ</h4><p>â€‹        äº‹åŠ¡ï¼šæ˜¯æ•°æ®åº“æ“ä½œçš„æœ€å°å·¥ä½œå•å…ƒï¼Œæ˜¯ä½œä¸ºå•ä¸ªé€»è¾‘å·¥ä½œå•å…ƒæ‰§è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼›è¿™äº›æ“ä½œä½œä¸ºä¸€ä¸ªæ•´ä½“ä¸€èµ·å‘ç³»ç»Ÿæäº¤ï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œã€è¦ä¹ˆéƒ½ä¸æ‰§è¡Œï¼›äº‹åŠ¡æ˜¯ä¸€ç»„ä¸å¯å†åˆ†å‰²çš„æ“ä½œé›†åˆï¼ˆå·¥ä½œé€»è¾‘å•å…ƒï¼‰ã€‚(ç†è§£ï¼šä¸€ç»„ä¸šåŠ¡æ“ä½œABCDï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æˆåŠŸã€‚)</p>
<h4 id="1-1-2-äº‹åŠ¡çš„å››å¤§ç‰¹æ€§"><a href="#1-1-2-äº‹åŠ¡çš„å››å¤§ç‰¹æ€§" class="headerlink" title="1.1.2 äº‹åŠ¡çš„å››å¤§ç‰¹æ€§"></a>1.1.2 äº‹åŠ¡çš„å››å¤§ç‰¹æ€§</h4><p>â€‹        1.åŸå­æ€§</p>
<p>â€‹        äº‹åŠ¡æ˜¯æ•°æ®åº“çš„é€»è¾‘å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­åŒ…å«çš„å„æ“ä½œè¦ä¹ˆéƒ½åšï¼Œè¦ä¹ˆéƒ½ä¸åš ï¼ˆæ•´ä½“ï¼‰</p>
<p>â€‹        2.ä¸€è‡´æ€§</p>
<p>â€‹        äº‹åŠ¡æ‰§è¡Œçš„ç»“æœå¿…é¡»æ˜¯ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚å› æ­¤å½“æ•°æ®åº“åªåŒ…å«æˆåŠŸäº‹åŠ¡æäº¤çš„ç»“æœæ—¶ï¼Œå°±è¯´æ•°æ®åº“å¤„äºä¸€è‡´æ€§çŠ¶æ€ã€‚å¦‚æœæ•°æ®åº“ç³»ç»Ÿ è¿è¡Œä¸­å‘ç”Ÿæ•…éšœï¼Œæœ‰äº›äº‹åŠ¡å°šæœªå®Œæˆå°±è¢«è¿«ä¸­æ–­ï¼Œè¿™äº›æœªå®Œæˆäº‹åŠ¡å¯¹æ•°æ®åº“æ‰€åšçš„ä¿®æ”¹æœ‰ä¸€éƒ¨åˆ†å·²å†™å…¥ç‰©ç†æ•°æ®åº“ï¼Œè¿™æ—¶æ•°æ®åº“å°±å¤„äºä¸€ç§ä¸æ­£ç¡®çš„çŠ¶æ€ï¼Œæˆ–è€…è¯´æ˜¯ ä¸ä¸€è‡´çš„çŠ¶æ€ã€‚ ï¼ˆæ•°æ®çš„å®Œæ•´ï¼‰</p>
<p>â€‹        3.éš”ç¦»æ€§</p>
<p>â€‹        ä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½å…¶å®ƒäº‹åŠ¡å¹²æ‰°ã€‚å³ä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®å¯¹å…¶å®ƒå¹¶å‘äº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„å„ä¸ªäº‹åŠ¡ä¹‹é—´ä¸èƒ½äº’ç›¸å¹²æ‰°ã€‚  ï¼ˆå¹¶å‘ï¼‰</p>
<p>â€‹        4.æŒç»­æ€§</p>
<p>â€‹        ä¹Ÿç§°æ°¸ä¹…æ€§ï¼ŒæŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±åº”è¯¥æ˜¯æ°¸ä¹…æ€§çš„ã€‚æ¥ä¸‹æ¥çš„å…¶å®ƒæ“ä½œæˆ–æ•…éšœä¸åº”è¯¥å¯¹å…¶æ‰§è¡Œç»“æœæœ‰ä»»ä½•å½±å“ã€‚ï¼ˆç»“æœï¼‰</p>
<a id="more"></a>

<h4 id="1-1-3-éš”ç¦»é—®é¢˜"><a href="#1-1-3-éš”ç¦»é—®é¢˜" class="headerlink" title="1.1.3 éš”ç¦»é—®é¢˜"></a>1.1.3 éš”ç¦»é—®é¢˜</h4><ul>
<li><p>è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡æ²¡æœ‰æäº¤çš„æ•°æ®</p>
</li>
<li><p>ä¸å¯é‡å¤è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡å·²æäº¤çš„æ•°æ®ï¼ˆupdateï¼‰</p>
</li>
<li><p>è™šè¯»(å¹»è¯»)ï¼šä¸€ä¸ªäº‹åŠ¡è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡å·²æäº¤çš„æ•°æ®ï¼ˆinsertï¼‰</p>
</li>
</ul>
<h4 id="1-1-4-éš”ç¦»çº§åˆ«"><a href="#1-1-4-éš”ç¦»çº§åˆ«" class="headerlink" title="1.1.4 éš”ç¦»çº§åˆ«"></a>1.1.4 éš”ç¦»çº§åˆ«</h4><ul>
<li><p>read uncommittedï¼šè¯»æœªæäº¤ã€‚å­˜åœ¨3ä¸ªé—®é¢˜</p>
</li>
<li><p>read committedï¼šè¯»å·²æäº¤ã€‚è§£å†³è„è¯»ï¼Œå­˜åœ¨2ä¸ªé—®é¢˜</p>
</li>
<li><p>repeatable readï¼šå¯é‡å¤è¯»ã€‚è§£å†³ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»ï¼Œå­˜åœ¨1ä¸ªé—®é¢˜ã€‚</p>
</li>
<li><p>serializable ï¼šä¸²è¡ŒåŒ–ã€‚éƒ½è§£å†³ï¼Œå•äº‹åŠ¡ã€‚</p>
</li>
</ul>
<h3 id="1-2-mysql-äº‹åŠ¡æ“ä½œâ€”â€”ç®€å•"><a href="#1-2-mysql-äº‹åŠ¡æ“ä½œâ€”â€”ç®€å•" class="headerlink" title="1.2 mysql äº‹åŠ¡æ“ä½œâ€”â€”ç®€å•"></a>1.2 mysql äº‹åŠ¡æ“ä½œâ€”â€”ç®€å•</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ABCD ä¸€ä¸ªäº‹åŠ¡</span></span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">  <span class="comment">//1 è·å¾—è¿æ¥</span></span><br><span class="line">  conn = ...;</span><br><span class="line">  <span class="comment">//2 å¼€å¯äº‹åŠ¡</span></span><br><span class="line">  conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">  A</span><br><span class="line">  B</span><br><span class="line">  C</span><br><span class="line">  D</span><br><span class="line">  <span class="comment">//3 æäº¤äº‹åŠ¡</span></span><br><span class="line">  conn.commit();</span><br><span class="line">&#125; catche()&#123;</span><br><span class="line">  <span class="comment">//4 å›æ»šäº‹åŠ¡</span></span><br><span class="line">  conn.rollback();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-mysql-äº‹åŠ¡æ“ä½œâ€”â€”Savepoint"><a href="#1-3-mysql-äº‹åŠ¡æ“ä½œâ€”â€”Savepoint" class="headerlink" title="1.3 mysql äº‹åŠ¡æ“ä½œâ€”â€”Savepoint"></a>1.3 mysql äº‹åŠ¡æ“ä½œâ€”â€”Savepoint</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//éœ€æ±‚ï¼šABï¼ˆå¿…é¡»ï¼‰ï¼ŒCDï¼ˆå¯é€‰ï¼‰ </span></span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">Savepoint savepoint = <span class="keyword">null</span>;  <span class="comment">//ä¿å­˜ç‚¹ï¼Œè®°å½•æ“ä½œçš„å½“å‰ä½ç½®ï¼Œä¹‹åå¯ä»¥å›æ»šåˆ°æŒ‡å®šçš„ä½ç½®ã€‚ï¼ˆå¯ä»¥å›æ»šä¸€éƒ¨åˆ†ï¼‰</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">  <span class="comment">//1 è·å¾—è¿æ¥</span></span><br><span class="line">  conn = ...;</span><br><span class="line">  <span class="comment">//2 å¼€å¯äº‹åŠ¡</span></span><br><span class="line">  conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">  A</span><br><span class="line">  B</span><br><span class="line">  savepoint = conn.setSavepoint();</span><br><span class="line">  C</span><br><span class="line">  D</span><br><span class="line">  <span class="comment">//3 æäº¤äº‹åŠ¡</span></span><br><span class="line">  conn.commit();</span><br><span class="line">&#125; catche()&#123;</span><br><span class="line">  <span class="keyword">if</span>(savepoint != <span class="keyword">null</span>)&#123;   <span class="comment">//CDå¼‚å¸¸</span></span><br><span class="line">     <span class="comment">// å›æ»šåˆ°CDä¹‹å‰</span></span><br><span class="line">     conn.rollback(savepoint);</span><br><span class="line">     <span class="comment">// æäº¤AB</span></span><br><span class="line">     conn.commit();</span><br><span class="line">  &#125; <span class="keyword">else</span>&#123;   <span class="comment">//ABå¼‚å¸¸</span></span><br><span class="line">     <span class="comment">// å›æ»šAB</span></span><br><span class="line">     conn.rollback();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-äº‹åŠ¡ç®¡ç†ä»‹ç»"><a href="#1-4-äº‹åŠ¡ç®¡ç†ä»‹ç»" class="headerlink" title="1.4 äº‹åŠ¡ç®¡ç†ä»‹ç»"></a>1.4 äº‹åŠ¡ç®¡ç†ä»‹ç»</h3><h4 id="1-4-1-å¯¼å…¥jaråŒ…"><a href="#1-4-1-å¯¼å…¥jaråŒ…" class="headerlink" title="1.4.1 å¯¼å…¥jaråŒ…"></a>1.4.1 å¯¼å…¥jaråŒ…</h4><ul>
<li>spring-tx-4.2.4.RELEASE.jar</li>
</ul>
<h4 id="1-4-2-ä¸‰ä¸ªé¡¶çº§æ¥å£ï¼ˆåœ¨org-springframework-transactionä¸­ï¼‰"><a href="#1-4-2-ä¸‰ä¸ªé¡¶çº§æ¥å£ï¼ˆåœ¨org-springframework-transactionä¸­ï¼‰" class="headerlink" title="1.4.2 ä¸‰ä¸ªé¡¶çº§æ¥å£ï¼ˆåœ¨org.springframework.transactionä¸­ï¼‰"></a>1.4.2 ä¸‰ä¸ªé¡¶çº§æ¥å£ï¼ˆåœ¨org.springframework.transactionä¸­ï¼‰</h4><ul>
<li><p>PlatformTransactionManager å¹³å°äº‹åŠ¡ç®¡ç†å™¨ï¼Œspringè¦ç®¡ç†äº‹åŠ¡ï¼Œ<span style="color:red">å¿…é¡»ä½¿ç”¨äº‹åŠ¡ç®¡ç†å™¨</span></p>
<p> â€‹        è¿›è¡Œäº‹åŠ¡é…ç½®æ—¶ï¼Œå¿…é¡»<strong>é…ç½®äº‹åŠ¡ç®¡ç†å™¨</strong>ã€‚</p>
</li>
<li><p>TransactionDefinitionï¼šäº‹åŠ¡è¯¦æƒ…ï¼ˆäº‹åŠ¡å®šä¹‰ã€äº‹åŠ¡å±æ€§ï¼‰ï¼Œspringç”¨äºç¡®å®šäº‹åŠ¡å…·ä½“è¯¦æƒ…ï¼Œ</p>
<p>â€‹        ä¾‹å¦‚ï¼šéš”ç¦»çº§åˆ«ã€æ˜¯å¦åªè¯»ã€è¶…æ—¶æ—¶é—´ç­‰</p>
</li>
</ul>
<p>â€‹    è¿›è¡Œäº‹åŠ¡é…ç½®æ—¶ï¼Œ<strong>å¿…é¡»é…ç½®è¯¦æƒ…</strong>ã€‚springå°†é…ç½®é¡¹å°è£…åˆ°è¯¥å¯¹è±¡å®ä¾‹ã€‚</p>
<ul>
<li><p>TransactionStatusï¼šäº‹åŠ¡çŠ¶æ€ï¼Œspringç”¨äºè®°å½•å½“å‰äº‹åŠ¡è¿è¡ŒçŠ¶æ€ã€‚ä¾‹å¦‚ï¼šæ˜¯å¦æœ‰ä¿å­˜ç‚¹ï¼Œäº‹åŠ¡æ˜¯å¦å®Œæˆã€‚</p>
<p>â€‹        springåº•å±‚æ ¹æ®çŠ¶æ€è¿›è¡Œç›¸åº”æ“ä½œã€‚</p>
</li>
</ul>
<h4 id="1-4-3-PlatformTransactionManageräº‹åŠ¡ç®¡ç†å™¨"><a href="#1-4-3-PlatformTransactionManageräº‹åŠ¡ç®¡ç†å™¨" class="headerlink" title="1.4.3 PlatformTransactionManageräº‹åŠ¡ç®¡ç†å™¨"></a>1.4.3 PlatformTransactionManageräº‹åŠ¡ç®¡ç†å™¨</h4><ul>
<li>å¯¼å…¥jaråŒ…ï¼šéœ€è¦æ—¶å¹³å°äº‹åŠ¡ç®¡ç†å™¨çš„å®ç°ç±»</li>
</ul>
<p><img src="http://q1o3t6lvp.bkt.clouddn.com/%E5%B9%B3%E5%8F%B0%E4%BA%8B%E7%89%A9%E7%AE%A1%E7%90%86%E5%99%A8%E7%9A%84jar%E5%8C%85.png" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<ul>
<li><p>å¸¸è§çš„äº‹åŠ¡ç®¡ç†å™¨</p>
<p><span style="color:red"><strong>DataSourceTransactionManagerï¼Œjdbcå¼€å‘æ—¶äº‹åŠ¡ç®¡ç†å™¨ï¼Œé‡‡ç”¨JdbcTemplate</strong></span></p>
<p><span style="color:red"><strong>HibernateTransactionManagerï¼Œhibernateå¼€å‘æ—¶äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ•´åˆhibernate</strong></span></p>
</li>
</ul>
<p><img src="http://q1o3t6lvp.bkt.clouddn.com/%E5%B8%B8%E8%A7%81%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8.png" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<ul>
<li><p>api è¯¦è§£</p>
<p>TransactionStatus getTransaction(TransactionDefinition definition) ï¼Œäº‹åŠ¡ç®¡ç†å™¨ é€šè¿‡â€œäº‹åŠ¡è¯¦æƒ…â€ï¼Œè·å¾—â€œäº‹åŠ¡çŠ¶æ€â€ï¼Œä»è€Œç®¡ç†äº‹åŠ¡ã€‚</p>
<p>void commit(TransactionStatus status) æ ¹æ®çŠ¶æ€æäº¤</p>
<p>void rollback(TransactionStatus status) æ ¹æ®çŠ¶æ€å›æ»š</p>
</li>
</ul>
<h4 id="1-4-4-TransactionStatus"><a href="#1-4-4-TransactionStatus" class="headerlink" title="1.4.4 TransactionStatus"></a>1.4.4 TransactionStatus</h4><p><img src="http://q1o3t6lvp.bkt.clouddn.com/%E4%BA%8B%E5%8A%A1%E7%8A%B6%E6%80%81.png" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<h4 id="1-4-5-TransactionDefinition"><a href="#1-4-5-TransactionDefinition" class="headerlink" title="1.4.5 TransactionDefinition"></a>1.4.5 TransactionDefinition</h4><p><img src="http://q1o3t6lvp.bkt.clouddn.com/%E4%BA%8B%E5%8A%A1%E8%AF%A6%E6%83%85.png" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<ul>
<li>ä¼ æ’­è¡Œä¸ºï¼šåœ¨ä¸¤ä¸ªä¸šåŠ¡ä¹‹é—´å¦‚ä½•å…±äº«äº‹åŠ¡ã€‚</li>
</ul>
<p>PROPAGATION_REQUIRED , required , å¿…é¡» ã€é»˜è®¤å€¼ã€‘</p>
<p>â€‹    æ”¯æŒå½“å‰äº‹åŠ¡ï¼ŒAå¦‚æœæœ‰äº‹åŠ¡ï¼ŒBå°†ä½¿ç”¨è¯¥äº‹åŠ¡ã€‚</p>
<p>â€‹    å¦‚æœAæ²¡æœ‰äº‹åŠ¡ï¼ŒBå°†åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚</p>
<p>PROPAGATION_SUPPORTS ï¼Œsupports ï¼Œæ”¯æŒ</p>
<p>â€‹    æ”¯æŒå½“å‰äº‹åŠ¡ï¼ŒAå¦‚æœæœ‰äº‹åŠ¡ï¼ŒBå°†ä½¿ç”¨è¯¥äº‹åŠ¡ã€‚</p>
<p>â€‹    å¦‚æœAæ²¡æœ‰äº‹åŠ¡ï¼ŒBå°†ä»¥éäº‹åŠ¡æ‰§è¡Œã€‚</p>
<p>PROPAGATION_MANDATORYï¼Œmandatory ï¼Œå¼ºåˆ¶</p>
<p>â€‹    æ”¯æŒå½“å‰äº‹åŠ¡ï¼ŒAå¦‚æœæœ‰äº‹åŠ¡ï¼ŒBå°†ä½¿ç”¨è¯¥äº‹åŠ¡ã€‚</p>
<p>â€‹    å¦‚æœAæ²¡æœ‰äº‹åŠ¡ï¼ŒBå°†æŠ›å¼‚å¸¸ã€‚</p>
<p>PROPAGATION_REQUIRES_NEW ï¼Œ requires_new ï¼Œå¿…é¡»æ–°çš„</p>
<p>â€‹    å¦‚æœAæœ‰äº‹åŠ¡ï¼Œå°†Açš„äº‹åŠ¡æŒ‚èµ·ï¼ŒBåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡</p>
<p>â€‹    å¦‚æœAæ²¡æœ‰äº‹åŠ¡ï¼ŒBåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡</p>
<p>PROPAGATION_NOT_SUPPORTED ï¼Œnot_supported ,ä¸æ”¯æŒ</p>
<p>â€‹    å¦‚æœAæœ‰äº‹åŠ¡ï¼Œå°†Açš„äº‹åŠ¡æŒ‚èµ·ï¼ŒBå°†ä»¥éäº‹åŠ¡æ‰§è¡Œ</p>
<p>â€‹    å¦‚æœAæ²¡æœ‰äº‹åŠ¡ï¼ŒBå°†ä»¥éäº‹åŠ¡æ‰§è¡Œ</p>
<p>PROPAGATION_NEVER ï¼Œneverï¼Œä»ä¸</p>
<p>â€‹    å¦‚æœAæœ‰äº‹åŠ¡ï¼ŒBå°†æŠ›å¼‚å¸¸</p>
<p>â€‹    å¦‚æœAæ²¡æœ‰äº‹åŠ¡ï¼ŒBå°†ä»¥éäº‹åŠ¡æ‰§è¡Œ</p>
<p>PROPAGATION_NESTED ï¼Œnested ï¼ŒåµŒå¥—</p>
<p>â€‹    Aå’ŒBåº•å±‚é‡‡ç”¨ä¿å­˜ç‚¹æœºåˆ¶ï¼Œå½¢æˆåµŒå¥—äº‹åŠ¡ã€‚</p>
<p><span style="color:red">æŒæ¡ï¼šPROPAGATION_REQUIREDã€PROPAGATION_REQUIRES_NEWã€PROPAGATION_NESTED</span></p>
<h3 id="1-5-æ¡ˆä¾‹ï¼šè½¬è´¦"><a href="#1-5-æ¡ˆä¾‹ï¼šè½¬è´¦" class="headerlink" title="1.5 æ¡ˆä¾‹ï¼šè½¬è´¦"></a>1.5 æ¡ˆä¾‹ï¼šè½¬è´¦</h3><h4 id="1-5-1-æ­å»ºç¯å¢ƒ"><a href="#1-5-1-æ­å»ºç¯å¢ƒ" class="headerlink" title="1.5.1 æ­å»ºç¯å¢ƒ"></a>1.5.1 æ­å»ºç¯å¢ƒ</h4><h5 id="1-5-1-1-åˆ›å»ºè¡¨"><a href="#1-5-1-1-åˆ›å»ºè¡¨" class="headerlink" title="1.5.1.1 åˆ›å»ºè¡¨"></a>1.5.1.1 åˆ›å»ºè¡¨</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create database ee19_spring_day03;</span><br><span class="line">use ee19_spring_day03;</span><br><span class="line">create table account(</span><br><span class="line">  id int primary key auto_increment,</span><br><span class="line">  username varchar(50),</span><br><span class="line">  money int</span><br><span class="line">);</span><br><span class="line">insert into account(username,money) values(&#39;jack&#39;,&#39;10000&#39;);</span><br><span class="line">insert into account(username,money) values(&#39;rose&#39;,&#39;10000&#39;);</span><br></pre></td></tr></table></figure>

<h5 id="1-5-1-2-å¯¼å…¥jaråŒ…"><a href="#1-5-1-2-å¯¼å…¥jaråŒ…" class="headerlink" title="1.5.1.2 å¯¼å…¥jaråŒ…"></a>1.5.1.2 å¯¼å…¥jaråŒ…</h5><ul>
<li>æ ¸å¿ƒï¼š4+1</li>
<li>aop ï¼š 4 (aopè”ç›Ÿã€spring aopã€aspectjè§„èŒƒã€spring aspect)</li>
<li>æ•°æ®åº“ï¼š2 ï¼ˆjdbc/txï¼‰</li>
<li>é©±åŠ¨ï¼šmysql</li>
<li>è¿æ¥æ± ï¼šc3p0</li>
</ul>
<h5 id="1-5-1-3-daoå±‚"><a href="#1-5-1-3-daoå±‚" class="headerlink" title="1.5.1.3 daoå±‚"></a>1.5.1.3 daoå±‚</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImpl</span> <span class="keyword">extends</span> <span class="title">JdbcDaoSupport</span> <span class="keyword">implements</span> <span class="title">AccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(String outer, Integer money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money - ? where username = ?"</span>, money,outer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">(String inner, Integer money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money + ? where username = ?"</span>, money,inner);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-5-1-5-serviceå±‚"><a href="#1-5-1-5-serviceå±‚" class="headerlink" title="1.5.1.5 serviceå±‚"></a>1.5.1.5 serviceå±‚</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccountDao</span><span class="params">(AccountDao accountDao)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.accountDao = accountDao;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outer, String inner, Integer money)</span> </span>&#123;</span><br><span class="line">		accountDao.out(outer, money);</span><br><span class="line">		<span class="comment">//æ–­ç”µ</span></span><br><span class="line"><span class="comment">//		int i = 1/0;</span></span><br><span class="line">		accountDao.in(inner, money);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-5-1-6-Springé…ç½®"><a href="#1-5-1-6-Springé…ç½®" class="headerlink" title="1.5.1.6 Springé…ç½®"></a>1.5.1.6 Springé…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/aop </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/context </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 1 datasource --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/ee19_spring_day03"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"873383099"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 2 dao  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.dao.impl.AccountDaoImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 3 service --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="1-5-1-7-æµ‹è¯•"><a href="#1-5-1-7-æµ‹è¯•" class="headerlink" title="1.5.1.7 æµ‹è¯•"></a>1.5.1.7 æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">   <span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo01</span><span class="params">()</span></span>&#123;</span><br><span class="line">	String xmlPath = <span class="string">"applicationContext.xml"</span>;</span><br><span class="line">	ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">	AccountService accountService =  (AccountService) applicationContext.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">	accountService.transfer(<span class="string">"jack"</span>, <span class="string">"rose"</span>, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-5-2-æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡ï¼ˆäº†è§£ï¼‰"><a href="#1-5-2-æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡ï¼ˆäº†è§£ï¼‰" class="headerlink" title="1.5.2 æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡ï¼ˆäº†è§£ï¼‰"></a>1.5.2 æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡ï¼ˆäº†è§£ï¼‰</h4><ul>
<li><p>springåº•å±‚ä½¿ç”¨ TransactionTemplate äº‹åŠ¡æ¨¡æ¿è¿›è¡Œæ“ä½œã€‚</p>
</li>
<li><p>æ“ä½œ</p>
<p>1.service éœ€è¦è·å¾— TransactionTemplate </p>
<p>2.spring é…ç½®æ¨¡æ¿ï¼Œå¹¶æ³¨å…¥ç»™service</p>
<p>3.æ¨¡æ¿éœ€è¦æ³¨å…¥äº‹åŠ¡ç®¡ç†å™¨</p>
<p>4.é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼šï¼Œéœ€è¦æ³¨å…¥</p>
</li>
</ul>
<h5 id="1-5-2-1-Daoç±»"><a href="#1-5-2-1-Daoç±»" class="headerlink" title="1.5.2.1 Daoç±»"></a>1.5.2.1 Daoç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImpl</span> <span class="keyword">extends</span> <span class="title">JdbcDaoSupport</span> <span class="keyword">implements</span> <span class="title">AccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(String outer, Integer money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money - ? where username = ?"</span>, money,outer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">(String inner, Integer money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money + ? where username = ?"</span>, money,inner);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-5-2-2-ä¿®æ”¹service"><a href="#1-5-2-2-ä¿®æ”¹service" class="headerlink" title="1.5.2.2 ä¿®æ”¹service"></a>1.5.2.2 ä¿®æ”¹service</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.transaction.TransactionStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.support.TransactionCallbackWithoutResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.support.TransactionTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.springlearning.dao.AccountDao;</span><br><span class="line"><span class="keyword">import</span> com.springlearning.service.AccountService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccountDao</span><span class="params">(AccountDao accountDao)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.accountDao = accountDao;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//éœ€è¦springæ³¨å…¥æ¨¡æ¿</span></span><br><span class="line">	<span class="keyword">private</span> TransactionTemplate transactionTemplate;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTransactionTemplate</span><span class="params">(TransactionTemplate transactionTemplate)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.transactionTemplate = transactionTemplate;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(<span class="keyword">final</span> String outer,<span class="keyword">final</span> String inner,<span class="keyword">final</span> Integer money)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		transactionTemplate.execute(<span class="keyword">new</span> TransactionCallbackWithoutResult()&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doInTransactionWithoutResult</span><span class="params">(TransactionStatus arg0)</span></span>&#123;</span><br><span class="line">				accountDao.out(outer, money);</span><br><span class="line">				<span class="comment">//æ–­ç”µ</span></span><br><span class="line">				<span class="keyword">int</span> i=<span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">				accountDao.in(inner, money);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-5-2-3-ä¿®æ”¹Spring-é…ç½®"><a href="#1-5-2-3-ä¿®æ”¹Spring-é…ç½®" class="headerlink" title="1.5.2.3 ä¿®æ”¹Spring é…ç½®"></a>1.5.2.3 ä¿®æ”¹Spring é…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1 datasource --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/ee19_spring_day03"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"873383099"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 2 dao  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.dao.impl.AccountDaoImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 3 service --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionTemplate"</span> <span class="attr">ref</span>=<span class="string">"transactionTemplate"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- åˆ›å»ºæ¨¡æ¿ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.transaction.support.TransactionTemplate"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionManager"</span> <span class="attr">ref</span>=<span class="string">"txManager"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ ,ç®¡ç†å™¨éœ€è¦äº‹åŠ¡ï¼Œäº‹åŠ¡ä»Connectionè·å¾—ï¼Œè¿æ¥ä»è¿æ¥æ± DataSourceè·å¾— --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="1-5-2-4-æµ‹è¯•"><a href="#1-5-2-4-æµ‹è¯•" class="headerlink" title="1.5.2.4 æµ‹è¯•"></a>1.5.2.4 æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo01</span><span class="params">()</span></span>&#123;</span><br><span class="line">		String xmlPath = <span class="string">"applicationContext.xml"</span>;</span><br><span class="line">		ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">		AccountService accountService = (AccountService) applicationContext.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">		accountService.transfer(<span class="string">"jack"</span>, <span class="string">"rose"</span>, <span class="number">1000</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-5-3-å·¥å‚bean-ç”Ÿæˆä»£ç†ï¼šåŠè‡ªåŠ¨"><a href="#1-5-3-å·¥å‚bean-ç”Ÿæˆä»£ç†ï¼šåŠè‡ªåŠ¨" class="headerlink" title="1.5.3 å·¥å‚bean ç”Ÿæˆä»£ç†ï¼šåŠè‡ªåŠ¨"></a>1.5.3 å·¥å‚bean ç”Ÿæˆä»£ç†ï¼šåŠè‡ªåŠ¨</h4><ul>
<li><p>springæä¾› ç®¡ç†äº‹åŠ¡çš„ä»£ç†å·¥å‚bean TransactionProxyFactoryBean</p>
<p>1.getBean() è·å¾—ä»£ç†å¯¹è±¡</p>
<p>2.spring é…ç½®ä¸€ä¸ªä»£ç†</p>
</li>
</ul>
<h5 id="1-5-3-1-Daoç±»"><a href="#1-5-3-1-Daoç±»" class="headerlink" title="1.5.3.1 Daoç±»"></a>1.5.3.1 Daoç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.support.JdbcDaoSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImple</span> <span class="keyword">extends</span> <span class="title">JdbcDaoSupport</span> <span class="keyword">implements</span> <span class="title">AccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(String outer, <span class="keyword">int</span> money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money - ? where name = ?"</span>,money,outer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">(String inner, <span class="keyword">int</span> money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money + ? where name = ?"</span>, money,inner);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-5-3-2-Service-ç±»"><a href="#1-5-3-2-Service-ç±»" class="headerlink" title="1.5.3.2 Service ç±»"></a>1.5.3.2 Service ç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccountDao</span><span class="params">(AccountDao accountDao)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.accountDao = accountDao;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outer, String inner, <span class="keyword">int</span> money)</span> </span>&#123;</span><br><span class="line">		accountDao.out(outer, money);</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">		accountDao.in(inner, money);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-5-3-3-Spring-é…åˆ¶"><a href="#1-5-3-3-Spring-é…åˆ¶" class="headerlink" title="1.5.3.3 Spring é…åˆ¶"></a>1.5.3.3 Spring é…åˆ¶</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/aop </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/context </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 1 datasource --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/ee19_spring_day03"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"873383099"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 2 dao  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.dao.impl.AccountDaoImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 3 service --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 4 service ä»£ç†å¯¹è±¡ </span></span><br><span class="line"><span class="comment">		4.1 proxyInterfaces æ¥å£ </span></span><br><span class="line"><span class="comment">		4.2 target ç›®æ ‡ç±»</span></span><br><span class="line"><span class="comment">		4.3 transactionManager äº‹åŠ¡ç®¡ç†å™¨</span></span><br><span class="line"><span class="comment">		4.4 transactionAttributes äº‹åŠ¡å±æ€§ï¼ˆäº‹åŠ¡è¯¦æƒ…ï¼‰</span></span><br><span class="line"><span class="comment">			prop.key ï¼šç¡®å®šå“ªäº›æ–¹æ³•ä½¿ç”¨å½“å‰äº‹åŠ¡é…ç½®</span></span><br><span class="line"><span class="comment">			prop.text:ç”¨äºé…ç½®äº‹åŠ¡è¯¦æƒ…</span></span><br><span class="line"><span class="comment">				æ ¼å¼ï¼šPROPAGATION,ISOLATION,readOnly,-Exception,+Exception</span></span><br><span class="line"><span class="comment">					ä¼ æ’­è¡Œä¸º		   éš”ç¦»çº§åˆ«	æ˜¯å¦åªè¯»	   å¼‚å¸¸å›æ»š	  å¼‚å¸¸æäº¤</span></span><br><span class="line"><span class="comment">				ä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="comment">					&lt;prop key="transfer"&gt;PROPAGATION_REQUIRED,ISOLATION_DEFAULT&lt;/prop&gt; é»˜è®¤ä¼ æ’­è¡Œä¸ºï¼Œå’Œéš”ç¦»çº§åˆ«</span></span><br><span class="line"><span class="comment">					&lt;prop key="transfer"&gt;PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly&lt;/prop&gt; åªè¯»</span></span><br><span class="line"><span class="comment">					&lt;prop key="transfer"&gt;PROPAGATION_REQUIRED,ISOLATION_DEFAULT,+java.lang.ArithmeticException&lt;/prop&gt;  æœ‰å¼‚å¸¸æ‰”æäº¤ --&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"proxyAccountService"</span> <span class="attr">class</span>=<span class="string">"org.springframework.transaction.interceptor.TransactionProxyFactoryBean"</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"proxyInterfaces"</span> <span class="attr">value</span>=<span class="string">"com.springlearning.service.AccountService"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"target"</span> <span class="attr">ref</span>=<span class="string">"accountService"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionManager"</span> <span class="attr">ref</span>=<span class="string">"txManager"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionAttributes"</span>&gt;</span></span><br><span class="line">	            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">	                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"transfer"</span>&gt;</span>PROPAGATION_REQUIRED,ISOLATION_DEFAULT<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">	            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">	      <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 5 é…ç½®äº‹åŠ¡ç®¡ç†å™¨ ,ç®¡ç†å™¨éœ€è¦äº‹åŠ¡ï¼Œäº‹åŠ¡ä»Connectionè·å¾—ï¼Œè¿æ¥ä»è¿æ¥æ± DataSourceè·å¾— --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="1-5-3-4-æµ‹è¯•"><a href="#1-5-3-4-æµ‹è¯•" class="headerlink" title="1.5.3.4 æµ‹è¯•"></a>1.5.3.4 æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">   <span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo01</span><span class="params">()</span></span>&#123;</span><br><span class="line">	String xmlPath = <span class="string">"applicationContext.xml"</span>;</span><br><span class="line">	ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">	AccountService accountService = (AccountService) applicationContext.getBean(<span class="string">"proxyAccountService"</span>);</span><br><span class="line">	accountService.transfer(<span class="string">"jack"</span>, <span class="string">"rose"</span>, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-5-4-AOP-é…ç½®åŸºäºxmlã€æŒæ¡ã€‘"><a href="#1-5-4-AOP-é…ç½®åŸºäºxmlã€æŒæ¡ã€‘" class="headerlink" title="1.5.4 AOP é…ç½®åŸºäºxmlã€æŒæ¡ã€‘"></a>1.5.4 AOP é…ç½®åŸºäºxmlã€æŒæ¡ã€‘</h4><ul>
<li><p>åœ¨spring xml é…ç½®aop è‡ªåŠ¨ç”Ÿæˆä»£ç†ï¼Œè¿›è¡Œäº‹åŠ¡çš„ç®¡ç†</p>
<p>1.é…ç½®ç®¡ç†å™¨</p>
<p>2.é…ç½®äº‹åŠ¡è¯¦æƒ…</p>
<p>3.é…ç½®aop</p>
</li>
</ul>
<h5 id="1-5-4-1-Dao"><a href="#1-5-4-1-Dao" class="headerlink" title="1.5.4.1 Dao"></a>1.5.4.1 Dao</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.support.JdbcDaoSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImple</span> <span class="keyword">extends</span> <span class="title">JdbcDaoSupport</span> <span class="keyword">implements</span> <span class="title">AccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(String outer, <span class="keyword">int</span> money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money - ? where name = ?"</span>,money,outer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">(String inner, <span class="keyword">int</span> money)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(<span class="string">"update account set money = money + ? where name = ?"</span>, money,inner);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-5-4-2-Service"><a href="#1-5-4-2-Service" class="headerlink" title="1.5.4.2 Service"></a>1.5.4.2 Service</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccountDao</span><span class="params">(AccountDao accountDao)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.accountDao = accountDao;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outer, String inner, <span class="keyword">int</span> money)</span> </span>&#123;</span><br><span class="line">		accountDao.out(outer, money);</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">		accountDao.in(inner, money);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-5-4-3-Spring-é…ç½®æ–‡ä»¶"><a href="#1-5-4-3-Spring-é…ç½®æ–‡ä»¶" class="headerlink" title="1.5.4.3 Spring é…ç½®æ–‡ä»¶"></a>1.5.4.3 Spring é…ç½®æ–‡ä»¶</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/aop </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/context </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/tx </span></span></span><br><span class="line"><span class="tag"><span class="string">       					   http://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 1 datasource --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/ee19_spring_day03"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"873383099"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 2 dao  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.dao.impl.AccountDaoImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 3 service --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 4 äº‹åŠ¡ç®¡ç† --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 4.1 äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- é…ç½® äº‹åŠ¡è¯¦æƒ…ï¼ˆäº‹åŠ¡é€šçŸ¥ï¼‰  ï¼Œ åœ¨aopç­›é€‰åŸºç¡€ä¸Šï¼Œå¯¹ABCä¸‰ä¸ªç¡®å®šä½¿ç”¨ä»€ä¹ˆæ ·çš„äº‹åŠ¡ã€‚ä¾‹å¦‚ï¼šACè¯»å†™ã€Båªè¯» ç­‰</span></span><br><span class="line"><span class="comment">	&lt;tx:attributes&gt; ç”¨äºé…ç½®äº‹åŠ¡è¯¦æƒ…ï¼ˆå±æ€§å±æ€§ï¼‰</span></span><br><span class="line"><span class="comment">		&lt;tx:method name=""/&gt; è¯¦æƒ…å…·ä½“é…ç½®</span></span><br><span class="line"><span class="comment">			propagation ä¼ æ’­è¡Œä¸º ï¼Œ REQUIREDï¼šå¿…é¡»ï¼›REQUIRES_NEW:å¿…é¡»æ˜¯æ–°çš„</span></span><br><span class="line"><span class="comment">			isolation éš”ç¦»çº§åˆ« --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"txManager"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"transfer"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">isolation</span>=<span class="string">"DEFAULT"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 4.3 AOPç¼–ç¨‹ï¼Œç›®æ ‡ç±»æœ‰ABCDï¼ˆ4ä¸ªè¿æ¥ç‚¹ï¼‰ï¼Œåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ ç¡®å®šå¢å¼ºçš„è¿æ¥å™¨ï¼Œä»è€Œè·å¾—åˆ‡å…¥ç‚¹ï¼šABC --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut</span>=<span class="string">"execution(* com.springlearning.service..*.*(..))"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="1-5-4-4-æµ‹è¯•"><a href="#1-5-4-4-æµ‹è¯•" class="headerlink" title="1.5.4.4 æµ‹è¯•"></a>1.5.4.4 æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo01</span><span class="params">()</span></span>&#123;</span><br><span class="line">		String xmlPath = <span class="string">"applicationContext.xml"</span>;</span><br><span class="line">		ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">		AccountService accountService = (AccountService) applicationContext.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">		accountService.transfer(<span class="string">"jack"</span>, <span class="string">"rose"</span>, <span class="number">1000</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-5-5-AOPé…ç½®åŸºäºæ³¨è§£ã€æŒæ¡ã€‘"><a href="#1-5-5-AOPé…ç½®åŸºäºæ³¨è§£ã€æŒæ¡ã€‘" class="headerlink" title="1.5.5 AOPé…ç½®åŸºäºæ³¨è§£ã€æŒæ¡ã€‘"></a>1.5.5 AOPé…ç½®åŸºäºæ³¨è§£ã€æŒæ¡ã€‘</h4><ul>
<li><p>1.é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œå°†å¹¶äº‹åŠ¡ç®¡ç†å™¨äº¤äºˆspring</p>
</li>
<li><p>2.åœ¨ç›®æ ‡ç±»æˆ–ç›®æ ‡æ–¹æ³•æ·»åŠ æ³¨è§£å³å¯ @Transactional</p>
</li>
</ul>
<h5 id="1-5-5-1-Serviceå±‚"><a href="#1-5-5-1-Serviceå±‚" class="headerlink" title="1.5.5.1 Serviceå±‚"></a>1.5.5.1 Serviceå±‚</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation=Propagation.REQUIRED,isolation=Isolation.DEFAULT)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccountDao</span><span class="params">(AccountDao accountDao)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.accountDao = accountDao;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transfer</span><span class="params">(String outer, String inner, Integer money)</span> </span>&#123;</span><br><span class="line">		accountDao.out(outer, money);</span><br><span class="line">		<span class="comment">//æ–­ç”µ</span></span><br><span class="line"><span class="comment">//		int i=1/0; </span></span><br><span class="line">		accountDao.in(inner, money);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-5-5-2-Spring-é…ç½®"><a href="#1-5-5-2-Spring-é…ç½®" class="headerlink" title="1.5.5.2 Spring é…ç½®"></a>1.5.5.2 Spring é…ç½®</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1 datasource --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/ee19_spring_day03"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"873383099"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 2 dao  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountDao"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.dao.impl.AccountDaoImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 3 service --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountService"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.service.impl.AccountServiceImpl"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"accountDao"</span> <span class="attr">ref</span>=<span class="string">"accountDao"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 4 äº‹åŠ¡ç®¡ç† --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 4.1 äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">	     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 4.2 å°†ç®¡ç†å™¨äº¤äºspring </span></span><br><span class="line"><span class="comment">         *transaction-manager é…ç½®äº‹ç‰©ç®¡ç†å™¨</span></span><br><span class="line"><span class="comment">         *proxy-target-class="true" åº•å±‚å¼ºåˆ¶ä½¿ç”¨cglibä»£ç†</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"txManager"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€æ•´åˆ-Junit"><a href="#äºŒã€æ•´åˆ-Junit" class="headerlink" title="äºŒã€æ•´åˆ Junit"></a>äºŒã€æ•´åˆ Junit</h2><ul>
<li><p>å¯¼å…¥jaråŒ…</p>
<p>â€‹    åŸºæœ¬ ï¼š4+1 </p>
<p>â€‹    æµ‹è¯•ï¼šspring-testâ€¦jar</p>
</li>
</ul>
<p>1.è®©Junité€šçŸ¥springåŠ è½½é…ç½®æ–‡ä»¶</p>
<p>2.è®©springå®¹å™¨è‡ªåŠ¨è¿›è¡Œæ³¨å…¥</p>
<ul>
<li>ä¿®æ”¹æµ‹è¯•ç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.springlearning.service.AccountService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">ContextConfiguration</span>(<span class="title">locations</span></span>=<span class="string">"classpath:applicationContext.xml"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestApp</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span>    <span class="comment">//ä¸Junitæ•´åˆï¼Œä¸éœ€è¦åœ¨spring xmlä¸­é…ç½®æ‰«æ</span></span><br><span class="line">	<span class="keyword">private</span> AccountService accountService;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo01</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//		String xmlPath = "applicationContext.xml";</span></span><br><span class="line"><span class="comment">//		ApplicationContext applicationContext = new ClassPathXmlApplicationContext(xmlPath);</span></span><br><span class="line"><span class="comment">//		AccountService accountService = (AccountService) applicationContext.getBean("accountService");</span></span><br><span class="line">		accountService.transfer(<span class="string">"jack"</span>, <span class="string">"rose"</span>, <span class="number">1000</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><h3 id="3-1-äº‹åŠ¡ç®¡ç†"><a href="#3-1-äº‹åŠ¡ç®¡ç†" class="headerlink" title="3.1 äº‹åŠ¡ç®¡ç†"></a>3.1 äº‹åŠ¡ç®¡ç†</h3><ul>
<li>åŸºäº xml é…ç½®</li>
</ul>
<p>1.é…ç½®äº‹åŠ¡ç®¡ç†å™¨</p>
<p> <code>jdbcï¼šDataSourceTransactionManager</code></p>
<p> <code>hibernateï¼šHibernateTransactionManager</code></p>
<p>2.äº‹åŠ¡é€šçŸ¥ï¼ˆè¯¦æƒ…ã€å±æ€§ï¼‰</p>
<p><code>&lt;tx:advice id=&quot;&quot; transaction-manager=&quot;&quot;&gt;</code></p>
<p><code>&lt;tx:attributes&gt;</code></p>
<p>   <code>&lt;tx:method name=&quot;add*&quot;&gt;</code></p>
<p>   <code>&lt;tx:method name=&quot;update*&quot;&gt;</code></p>
<p>   <code>&lt;tx:method name=&quot;delete*&quot;&gt;</code></p>
<p>   <code>&lt;tx:method name=&quot;find* read-only=&quot;true&quot;&gt;</code></p>
<p> 3.AOPç¼–ç¨‹ï¼ŒABCDâ€“&gt; ABC</p>
<p><code>&lt;aop:config&gt;</code></p>
<p><code>&lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut=&quot;execution(* com..*.*(..))&quot;&gt;</code></p>
<ul>
<li><p>åŸºäºæ³¨è§£</p>
<p>xml é…ç½® </p>
</li>
</ul>
<p>1.äº‹åŠ¡ç®¡ç†å™¨   </p>
<p>2.å°†é…ç½®äº‹åŠ¡ç®¡ç†å™¨äº¤äºˆspring  &lt;tx:annotation-driven transaction-manager=â€â€¦.â€&gt;   </p>
<p>â€‹     ç›®æ ‡ç±»</p>
<p>  @Transactional  ç±» | æ–¹æ³•  </p>
<h3 id="3-2-æ•´åˆ-Junit"><a href="#3-2-æ•´åˆ-Junit" class="headerlink" title="3.2 æ•´åˆ Junit"></a>3.2 æ•´åˆ Junit</h3><p>@RunWith(SpringJunit4RnnerClass.class)</p>
<p>@ContextConfiguration(locations=â€classpath:â€¦xmlâ€)</p>
<p>@Autowired æ³¨å…¥</p>
<p>@Test æµ‹è¯•</p>
]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Springå­¦ä¹ ç¬¬äºŒå¤©</title>
    <url>/2019/12/02/Spring%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%BA%8C%E5%A4%A9/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>[toc]</p>
<h2 id="ä¸€ã€AOP"><a href="#ä¸€ã€AOP" class="headerlink" title="ä¸€ã€AOP"></a>ä¸€ã€AOP</h2><h3 id="1-1-AOP-ä»‹ç»"><a href="#1-1-AOP-ä»‹ç»" class="headerlink" title="1.1 AOP ä»‹ç»"></a>1.1 AOP ä»‹ç»</h3><h4 id="1-1-1-ä»€ä¹ˆæ˜¯AOPï¼Ÿ"><a href="#1-1-1-ä»€ä¹ˆæ˜¯AOPï¼Ÿ" class="headerlink" title="1.1.1 ä»€ä¹ˆæ˜¯AOPï¼Ÿ"></a>1.1.1 ä»€ä¹ˆæ˜¯AOPï¼Ÿ</h4><ul>
<li>åœ¨è½¯ä»¶ä¸šï¼ŒAOPä¸ºAspect Oriented Programmingçš„ç¼©å†™ï¼Œæ„ä¸ºï¼š<span style="color:red">é¢å‘åˆ‡é¢ç¼–ç¨‹</span>ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚AOPæ˜¯OOPï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰çš„å»¶ç»­ï¼Œæ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ªçƒ­ç‚¹ï¼Œä¹Ÿæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€ä¸ªé‡è¦å†…å®¹ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ç§è¡ç”ŸèŒƒå‹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„<span style="color:red">è€¦åˆåº¦é™ä½</span>ï¼Œæé«˜ç¨‹åºçš„<span style="color:red">å¯é‡ç”¨æ€§</span>ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆç‡ã€‚</li>
<li>AOPé‡‡å–<strong>æ¨ªå‘æŠ½å–</strong>æœºåˆ¶ï¼Œå–ä»£äº†ä¼ ç»Ÿ<strong>çºµå‘ç»§æ‰¿</strong>ä½“ç³»é‡å¤æ€§ä»£ç </li>
<li>ç»å…¸åº”ç”¨ï¼šäº‹åŠ¡ç®¡ç†ã€æ€§èƒ½ç›‘è§†ã€å®‰å…¨æ£€æŸ¥ã€ç¼“å­˜ ã€æ—¥å¿—ç­‰</li>
<li>Spring AOPä½¿ç”¨çº¯Javaå®ç°ï¼Œä¸éœ€è¦ä¸“é—¨çš„ç¼–è¯‘è¿‡ç¨‹å’Œç±»åŠ è½½å™¨ï¼Œåœ¨è¿è¡ŒæœŸé€šè¿‡ä»£ç†æ–¹å¼å‘ç›®æ ‡ç±»ç»‡å…¥å¢å¼ºä»£ç </li>
<li>AspectJæ˜¯ä¸€ä¸ªåŸºäºJavaè¯­è¨€çš„<strong>AOPæ¡†æ¶</strong>ï¼ŒSpring2.0å¼€å§‹ï¼ŒSpring AOPå¼•å…¥å¯¹Aspectçš„æ”¯æŒï¼ŒAspectJæ‰©å±•äº†Javaè¯­è¨€ï¼Œæä¾›äº†ä¸€ä¸ªä¸“é—¨çš„ç¼–è¯‘å™¨ï¼Œåœ¨ç¼–è¯‘æ—¶æä¾›æ¨ªå‘ä»£ç çš„ç»‡å…¥  </li>
</ul>
<h4 id="1-1-2-AOPå®ç°åŸç†"><a href="#1-1-2-AOPå®ç°åŸç†" class="headerlink" title="1.1.2 AOPå®ç°åŸç†"></a>1.1.2 AOPå®ç°åŸç†</h4><ul>
<li>aopåº•å±‚å°†é‡‡ç”¨ä»£ç†æœºåˆ¶è¿›è¡Œå®ç°ã€‚</li>
<li>æ¥å£ + å®ç°ç±»ï¼šspringé‡‡ç”¨ jdk çš„<span style="color:red">åŠ¨æ€ä»£ç†</span>Proxyã€‚</li>
<li>å®ç°ç±»ï¼šspring é‡‡ç”¨<span style="color:red"> cglibå­—èŠ‚ç å¢å¼º</span>ã€‚</li>
</ul>
<a id="more"></a>

<h4 id="1-1-3-AOPæœ¯è¯­ã€æŒæ¡ã€‘"><a href="#1-1-3-AOPæœ¯è¯­ã€æŒæ¡ã€‘" class="headerlink" title="1.1.3 AOPæœ¯è¯­ã€æŒæ¡ã€‘"></a>1.1.3 AOPæœ¯è¯­ã€æŒæ¡ã€‘</h4><p>1.targetç›®æ ‡ç±»ï¼šéœ€è¦è¢«ä»£ç†çš„ç±»ã€‚ä¾‹å¦‚ï¼šUserService</p>
<p>2.Joinpointè¿æ¥ç‚¹ï¼šæ‰€è°“è¿æ¥ç‚¹æ˜¯æŒ‡é‚£äº›å¯èƒ½è¢«æ‹¦æˆªåˆ°çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼šæ‰€æœ‰çš„æ–¹æ³•</p>
<p>3.PointCutåˆ‡å…¥ç‚¹ï¼šå·²ç»è¢«å¢å¼ºçš„è¿æ¥ç‚¹ã€‚ä¾‹å¦‚ï¼šaddUser()</p>
<p>4.adviceé€šçŸ¥/å¢å¼ºï¼Œå¢å¼ºä»£ç ã€‚ä¾‹å¦‚ï¼šafterã€before</p>
<p>5.Weavingç»‡å…¥ï¼šæ˜¯æŒ‡æŠŠå¢å¼ºadviceåº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡targetæ¥åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡proxyçš„è¿‡ç¨‹.</p>
<p>6.proxyä»£ç†ç±»</p>
<p>7.Aspectåˆ‡é¢ï¼šæ˜¯åˆ‡å…¥ç‚¹pointcutå’Œé€šçŸ¥adviceçš„ç»“åˆ</p>
<p>â€‹        ä¸€ä¸ªçº¿æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„é¢ã€‚</p>
<p>â€‹        ä¸€ä¸ªåˆ‡å…¥ç‚¹å’Œä¸€ä¸ªé€šçŸ¥ï¼Œç»„æˆæˆä¸€ä¸ªç‰¹æ®Šçš„é¢ã€‚</p>
<p><img src="http://q1o3t6lvp.bkt.clouddn.com/aop%E6%9C%AF%E8%AF%AD.jpg" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<h3 id="1-2-æ‰‹åŠ¨æ–¹å¼"><a href="#1-2-æ‰‹åŠ¨æ–¹å¼" class="headerlink" title="1.2 æ‰‹åŠ¨æ–¹å¼"></a>1.2 æ‰‹åŠ¨æ–¹å¼</h3><h4 id="1-2-1-JDKåŠ¨æ€ä»£ç†"><a href="#1-2-1-JDKåŠ¨æ€ä»£ç†" class="headerlink" title="1.2.1 JDKåŠ¨æ€ä»£ç†"></a>1.2.1 JDKåŠ¨æ€ä»£ç†</h4><ul>
<li><p>JDKåŠ¨æ€ä»£ç† å¯¹â€œè£…é¥°è€…â€è®¾è®¡æ¨¡å¼ ç®€åŒ–ã€‚ä½¿ç”¨å‰æï¼šå¿…é¡»æœ‰æ¥å£</p>
<p>1.ç›®æ ‡ç±»ï¼šæ¥å£ + å®ç°ç±»</p>
<p>2.åˆ‡é¢ç±»ï¼šç”¨äºå­˜é€šçŸ¥ MyAspect</p>
<p>3.å·¥å‚ç±»ï¼šç¼–å†™å·¥å‚ç”Ÿæˆä»£ç†</p>
<p>4.æµ‹è¯•</p>
</li>
</ul>
<h5 id="1-2-1-1-ç›®æ ‡ç±»ï¼ˆæ¥å£-å®ç°ç±»ï¼‰"><a href="#1-2-1-1-ç›®æ ‡ç±»ï¼ˆæ¥å£-å®ç°ç±»ï¼‰" class="headerlink" title="1.2.1.1 ç›®æ ‡ç±»ï¼ˆæ¥å£+å®ç°ç±»ï¼‰"></a>1.2.1.1 ç›®æ ‡ç±»ï¼ˆæ¥å£+å®ç°ç±»ï¼‰</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*æ¥å£*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*å®ç°ç±»*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"a_proxy.a_jdk addUser"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"a_proxy.a_jdk updateUser"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"a_proxy.a_jdk deleteUser"</span>);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-2-1-2-åˆ‡é¢ç±»"><a href="#1-2-1-2-åˆ‡é¢ç±»" class="headerlink" title="1.2.1.2 åˆ‡é¢ç±»"></a>1.2.1.2 åˆ‡é¢ç±»</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"é¸¡é¦–"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"ç‰›å¤ªéƒ"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-2-1-3-å·¥å‚"><a href="#1-2-1-3-å·¥å‚" class="headerlink" title="1.2.1.3 å·¥å‚"></a>1.2.1.3 å·¥å‚</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UserService <span class="title">createService</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//1 ç›®æ ‡ç±»</span></span><br><span class="line">		<span class="keyword">final</span> UserService userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//2åˆ‡é¢ç±»</span></span><br><span class="line">		<span class="keyword">final</span> MyAspect myAspect = <span class="keyword">new</span> MyAspect();</span><br><span class="line">		<span class="comment">/* 3 ä»£ç†ç±»ï¼šå°†ç›®æ ‡ç±»ï¼ˆåˆ‡å…¥ç‚¹ï¼‰å’Œ åˆ‡é¢ç±»ï¼ˆé€šçŸ¥ï¼‰ ç»“åˆ --&gt; åˆ‡é¢</span></span><br><span class="line"><span class="comment">		 * 	Proxy.newProxyInstance(loader,interfaces,h)</span></span><br><span class="line"><span class="comment">		 * 		å‚æ•°1ï¼šloader ï¼Œç±»åŠ è½½å™¨ï¼ŒåŠ¨æ€ä»£ç†ç±» è¿è¡Œæ—¶åˆ›å»ºï¼Œä»»ä½•ç±»éƒ½éœ€è¦ç±»åŠ è½½å™¨å°†å…¶åŠ è½½åˆ°å†…å­˜ã€‚</span></span><br><span class="line"><span class="comment">		 * 			ä¸€èˆ¬æƒ…å†µï¼šå½“å‰ç±».class.getClassLoader();</span></span><br><span class="line"><span class="comment">		 * 					ç›®æ ‡ç±»å®ä¾‹.getClass().get...</span></span><br><span class="line"><span class="comment">		 * 		å‚æ•°2ï¼šClass[] interfaces ä»£ç†ç±»éœ€è¦å®ç°çš„æ‰€æœ‰æ¥å£ä»¬</span></span><br><span class="line"><span class="comment">		 * 			æ–¹å¼1ï¼šç›®æ ‡ç±»å®ä¾‹.getClass().getInterfaces()  ;æ³¨æ„ï¼šåªèƒ½è·å¾—è‡ªå·±æ¥å£ï¼Œä¸èƒ½è·å¾—çˆ¶å…ƒç´ æ¥å£</span></span><br><span class="line"><span class="comment">		 * 			æ–¹å¼2ï¼šnew Class[]&#123;UserService.class&#125;   </span></span><br><span class="line"><span class="comment">		 * 			ä¾‹å¦‚ï¼šjdbc é©±åŠ¨  --&gt; DriverManager  è·å¾—æ¥å£ Connection</span></span><br><span class="line"><span class="comment">		 * 		å‚æ•°3ï¼šInvocationHandler  å¤„ç†ç±»ï¼Œæ¥å£ï¼Œå¿…é¡»è¿›è¡Œå®ç°ç±»ï¼Œä¸€èˆ¬é‡‡ç”¨åŒ¿åå†…éƒ¨</span></span><br><span class="line"><span class="comment">		 * 			æä¾› invoke æ–¹æ³•ï¼Œä»£ç†ç±»çš„æ¯ä¸€ä¸ªæ–¹æ³•æ‰§è¡Œæ—¶ï¼Œéƒ½å°†è°ƒç”¨ä¸€æ¬¡invoke</span></span><br><span class="line"><span class="comment">		 * 				å‚æ•°31ï¼šObject proxy ï¼šä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">		 * 				å‚æ•°32ï¼šMethod method : ä»£ç†å¯¹è±¡å½“å‰æ‰§è¡Œçš„æ–¹æ³•çš„æè¿°å¯¹è±¡ï¼ˆåå°„ï¼‰</span></span><br><span class="line"><span class="comment">		 * 					æ‰§è¡Œæ–¹æ³•åï¼šmethod.getName()</span></span><br><span class="line"><span class="comment">		 * 					æ‰§è¡Œæ–¹æ³•ï¼šmethod.invoke(å¯¹è±¡ï¼Œå®é™…å‚æ•°)</span></span><br><span class="line"><span class="comment">		 * 				å‚æ•°33ï¼šObject[] args :æ–¹æ³•å®é™…å‚æ•°</span></span><br><span class="line"><span class="comment">		 * </span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		UserService proxService = (UserService)Proxy.newProxyInstance(</span><br><span class="line">				MyBeanFactory<span class="class">.<span class="keyword">class</span>.<span class="title">getClassLoader</span>(), </span></span><br><span class="line"><span class="class">				<span class="title">userService</span>.<span class="title">getClass</span>().<span class="title">getInterfaces</span>(), </span></span><br><span class="line"><span class="class">				<span class="title">new</span> <span class="title">InvocationHandler</span>() </span>&#123;</span><br><span class="line"></span><br><span class="line">					<span class="meta">@Override</span></span><br><span class="line">					<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">						<span class="comment">//å‰æ‰§è¡Œ</span></span><br><span class="line">						myAspect.before();</span><br><span class="line"></span><br><span class="line">						<span class="comment">//æ‰§è¡Œç›®æ ‡ç±»çš„æ–¹æ³•</span></span><br><span class="line">						Object obj = method.invoke(userService, args);</span><br><span class="line"></span><br><span class="line">						<span class="comment">//åæ‰§è¡Œ</span></span><br><span class="line">						myAspect.after();</span><br><span class="line"></span><br><span class="line">						<span class="keyword">return</span> obj;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;);</span><br><span class="line">		<span class="keyword">return</span> proxService;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-2-1-4-æµ‹è¯•"><a href="#1-2-1-4-æµ‹è¯•" class="headerlink" title="1.2.1.4 æµ‹è¯•"></a>1.2.1.4 æµ‹è¯•</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo01</span><span class="params">()</span></span>&#123;</span><br><span class="line">		UserService userService = MyBeanFactory.createService();</span><br><span class="line">		userService.addUser();</span><br><span class="line">		userService.updateUser();</span><br><span class="line">		userService.deleteUser();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-2-CGLIBå­—èŠ‚ç å¢å¼º"><a href="#1-2-2-CGLIBå­—èŠ‚ç å¢å¼º" class="headerlink" title="1.2.2 CGLIBå­—èŠ‚ç å¢å¼º"></a>1.2.2 CGLIBå­—èŠ‚ç å¢å¼º</h4><ul>
<li><p>æ²¡æœ‰æ¥å£ï¼Œåªæœ‰å®ç°ç±»ã€‚</p>
</li>
<li><p>é‡‡ç”¨å­—èŠ‚ç å¢å¼ºæ¡†æ¶cglibï¼Œåœ¨è¿è¡Œæ—¶åˆ›å»ºç›®æ ‡ç±»çš„å­ç±»ï¼Œä»è€Œå¯¹ç›®æ ‡ç±»è¿›è¡Œå¢å¼ºã€‚</p>
</li>
<li><p>å¯¼å…¥jaråŒ…ï¼š</p>
<p>è‡ªå·±å¯¼åŒ…ï¼ˆäº†è§£ï¼‰ï¼š</p>
<p>â€‹       æ ¸å¿ƒï¼šhibernate-distribution-3.6.10.Final\lib\bytecode\cglib\cglib-2.2.jar</p>
<p>â€‹       ä¾èµ–ï¼šstruts-2.3.15.3\apps\struts2-blank\WEB-INF\lib\asm-3.3.jar</p>
<p>â€‹    spring-core..jar å·²ç»æ•´åˆä»¥ä¸Šä¸¤ä¸ªå†…å®¹</p>
</li>
</ul>
<h5 id="1-2-2-1-å·¥å‚ç±»ï¼ˆç›®æ ‡ç±»ä¸JDKåŠ¨æ€ä»£ç†ä¸€æ ·ï¼Œåªæ˜¯æ²¡æœ‰æ¥å£ï¼Œæµ‹è¯•ä¹Ÿæ˜¯ä¸€æ ·ï¼‰"><a href="#1-2-2-1-å·¥å‚ç±»ï¼ˆç›®æ ‡ç±»ä¸JDKåŠ¨æ€ä»£ç†ä¸€æ ·ï¼Œåªæ˜¯æ²¡æœ‰æ¥å£ï¼Œæµ‹è¯•ä¹Ÿæ˜¯ä¸€æ ·ï¼‰" class="headerlink" title="1.2.2.1 å·¥å‚ç±»ï¼ˆç›®æ ‡ç±»ä¸JDKåŠ¨æ€ä»£ç†ä¸€æ ·ï¼Œåªæ˜¯æ²¡æœ‰æ¥å£ï¼Œæµ‹è¯•ä¹Ÿæ˜¯ä¸€æ ·ï¼‰"></a>1.2.2.1 å·¥å‚ç±»ï¼ˆç›®æ ‡ç±»ä¸JDKåŠ¨æ€ä»£ç†ä¸€æ ·ï¼Œåªæ˜¯æ²¡æœ‰æ¥å£ï¼Œæµ‹è¯•ä¹Ÿæ˜¯ä¸€æ ·ï¼‰</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UserServiceImpl <span class="title">createService</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//1 ç›®æ ‡ç±»</span></span><br><span class="line">		<span class="keyword">final</span> UserServiceImpl userServiceImpl = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//2åˆ‡é¢ç±»</span></span><br><span class="line">		<span class="keyword">final</span> MyAspect myAspect = <span class="keyword">new</span> MyAspect();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 3.ä»£ç†ç±» ï¼Œé‡‡ç”¨cglibï¼Œåº•å±‚åˆ›å»ºç›®æ ‡ç±»çš„å­ç±»</span></span><br><span class="line">		<span class="comment">//3.1 æ ¸å¿ƒç±»</span></span><br><span class="line">		Enhancer enhancer = <span class="keyword">new</span> Enhancer();</span><br><span class="line">		<span class="comment">//3.2 ç¡®å®šçˆ¶ç±»</span></span><br><span class="line">		enhancer.setSuperclass(userServiceImpl.getClass());</span><br><span class="line"></span><br><span class="line">		<span class="comment">/* 3.3 è®¾ç½®å›è°ƒå‡½æ•° , MethodInterceptoræ¥å£ ç­‰æ•ˆ jdk InvocationHandleræ¥å£</span></span><br><span class="line"><span class="comment">		 * 	intercept() ç­‰æ•ˆ jdk  invoke()</span></span><br><span class="line"><span class="comment">		 * 		å‚æ•°1ã€å‚æ•°2ã€å‚æ•°3ï¼šä¸invokeä¸€æ ·</span></span><br><span class="line"><span class="comment">		 * 		å‚æ•°4ï¼šmethodProxy æ–¹æ³•çš„ä»£ç†</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		enhancer.setCallback(<span class="keyword">new</span> MethodInterceptor()&#123;</span><br><span class="line"></span><br><span class="line">			<span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object proxy, Method method, Object[] args, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">				</span><br><span class="line">				<span class="comment">//å‰</span></span><br><span class="line">				myAspect.before();</span><br><span class="line">				</span><br><span class="line">				<span class="comment">//æ‰§è¡Œç›®æ ‡ç±»çš„æ–¹æ³•</span></span><br><span class="line">				Object obj = method.invoke(userServiceImpl, args);</span><br><span class="line">				<span class="comment">//æ‰§è¡Œä»£ç†ç±»çš„çˆ¶ç±» ï¼Œæ‰§è¡Œç›®æ ‡ç±» ï¼ˆç›®æ ‡ç±»å’Œä»£ç†ç±» çˆ¶å­å…³ç³»ï¼‰</span></span><br><span class="line">				methodProxy.invokeSuper(proxy, args); </span><br><span class="line">				</span><br><span class="line">				<span class="comment">//å</span></span><br><span class="line">				myAspect.after();</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">return</span> obj;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="comment">//3.4 åˆ›å»ºä»£ç†</span></span><br><span class="line">		UserServiceImpl proxService = (UserServiceImpl) enhancer.create();</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">return</span> proxService;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-AOPè”ç›Ÿé€šçŸ¥ç±»å‹"><a href="#1-3-AOPè”ç›Ÿé€šçŸ¥ç±»å‹" class="headerlink" title="1.3 AOPè”ç›Ÿé€šçŸ¥ç±»å‹"></a>1.3 AOPè”ç›Ÿé€šçŸ¥ç±»å‹</h3><ul>
<li><p>AOPè”ç›Ÿä¸ºé€šçŸ¥Adviceå®šä¹‰äº†org.aopalliance.aop.Advice</p>
</li>
<li><p>SpringæŒ‰ç…§é€šçŸ¥Adviceåœ¨ç›®æ ‡ç±»æ–¹æ³•çš„è¿æ¥ç‚¹ä½ç½®ï¼Œå¯ä»¥åˆ†ä¸º5ç±»</p>
<ul>
<li><p>å‰ç½®é€šçŸ¥ org.springframework.aop.MethodBeforeAdvice</p>
<ul>
<li>åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰å®æ–½å¢å¼º(å¯é˜»ç¢ç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œ)</li>
</ul>
</li>
<li><p>åç½®é€šçŸ¥ org.springframework.aop.AfterReturningAdvice</p>
<ul>
<li>åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œåå®æ–½å¢å¼º(å¯è·å–ç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼)</li>
</ul>
</li>
<li><p><span style="color:red">ç¯ç»•é€šçŸ¥</span> org.aopalliance.intercept.MethodInterceptor</p>
<ul>
<li>åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰åå®æ–½å¢å¼º</li>
</ul>
</li>
<li><p>å¼‚å¸¸æŠ›å‡ºé€šçŸ¥ org.springframework.aop.ThrowsAdvice</p>
<ul>
<li>åœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åå®æ–½å¢å¼º</li>
</ul>
</li>
<li><p>å¼•ä»‹é€šçŸ¥ org.springframework.aop.IntroductionInterceptor</p>
<ul>
<li>åœ¨ç›®æ ‡ç±»ä¸­æ·»åŠ ä¸€äº›æ–°çš„æ–¹æ³•å’Œå±æ€§ </li>
</ul>
</li>
</ul>
</li>
<li><p><strong>æ•´ä½“æ¦‚æ‹¬</strong></p>
<p>ç¯ç»•é€šçŸ¥ï¼Œ<span style="color:red">å¿…é¡»æ‰‹åŠ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">     		<span class="comment">//å‰ç½®é€šçŸ¥</span></span><br><span class="line"></span><br><span class="line">  â€‹		  <span class="comment">//æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    		<span class="comment">//åç½®é€šçŸ¥</span></span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">catch</span>()&#123;</span><br><span class="line">  		<span class="comment">//æŠ›å‡ºå¼‚å¸¸é€šçŸ¥</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-4-Spring-ç¼–å†™ä»£ç†ï¼šåŠè‡ªåŠ¨åŒ–"><a href="#1-4-Spring-ç¼–å†™ä»£ç†ï¼šåŠè‡ªåŠ¨åŒ–" class="headerlink" title="1.4 Spring ç¼–å†™ä»£ç†ï¼šåŠè‡ªåŠ¨åŒ–"></a>1.4 Spring ç¼–å†™ä»£ç†ï¼šåŠè‡ªåŠ¨åŒ–</h3></li>
<li><p>è®©Spring åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œä»Springå®¹å™¨ä¸­æ‰‹åŠ¨çš„è·å–ä»£ç†å¯¹è±¡</p>
</li>
<li><p>å¯¼å…¥jaråŒ…</p>
</li>
</ul>
<p>æ ¸å¿ƒï¼š4+1</p>
<p>AOPï¼šAOPè”ç›Ÿï¼ˆè§„èŒƒï¼‰ã€Spring-aop ï¼ˆå®ç°ï¼‰  </p>
<h4 id="1-4-1-ç›®æ ‡ç±»"><a href="#1-4-1-ç›®æ ‡ç±»" class="headerlink" title="1.4.1 ç›®æ ‡ç±»"></a>1.4.1 ç›®æ ‡ç±»</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-4-2-åˆ‡é¢ç±»"><a href="#1-4-2-åˆ‡é¢ç±»" class="headerlink" title="1.4.2  åˆ‡é¢ç±»"></a>1.4.2  åˆ‡é¢ç±»</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ‡é¢ç±»ä¸­ç¡®å®šé€šçŸ¥ï¼Œéœ€è¦å®ç°ä¸åŒæ¥å£ï¼Œæ¥å£å°±æ˜¯è§„èŒƒï¼Œä»è€Œå°±ç¡®å®šæ–¹æ³•åç§°ã€‚</span></span><br><span class="line"><span class="comment"> * * é‡‡ç”¨â€œç¯ç»•é€šçŸ¥â€ MethodInterceptor</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAspect</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(MethodInvocation mi)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"å‰3"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æ‰‹åŠ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></span><br><span class="line">		Object obj = mi.proceed();</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"å3"</span>);</span><br><span class="line">		<span class="keyword">return</span> obj;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-4-3-Springé…ç½®"><a href="#1-4-3-Springé…ç½®" class="headerlink" title="1.4.3 Springé…ç½®"></a>1.4.3 Springé…ç½®</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1 åˆ›å»ºç›®æ ‡ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userServiceId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.b_factory_bean.UserServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 2 åˆ›å»ºåˆ‡é¢ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myAspectId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.b_factory_bean.MyAspect"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 3 åˆ›å»ºä»£ç†ç±» </span></span><br><span class="line"><span class="comment">		* ä½¿ç”¨å·¥å‚bean FactoryBean ï¼Œåº•å±‚è°ƒç”¨ getObject() è¿”å›ç‰¹æ®Šbean</span></span><br><span class="line"><span class="comment">		* ProxyFactoryBean ç”¨äºåˆ›å»ºä»£ç†å·¥å‚beanï¼Œç”Ÿæˆç‰¹æ®Šä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">			interfaces : ç¡®å®šæ¥å£ä»¬</span></span><br><span class="line"><span class="comment">				é€šè¿‡&lt;array&gt;å¯ä»¥è®¾ç½®å¤šä¸ªå€¼</span></span><br><span class="line"><span class="comment">				åªæœ‰ä¸€ä¸ªå€¼æ—¶ï¼Œvalue=""</span></span><br><span class="line"><span class="comment">			target : ç¡®å®šç›®æ ‡ç±»</span></span><br><span class="line"><span class="comment">			interceptorNames : é€šçŸ¥ åˆ‡é¢ç±»çš„åç§°ï¼Œç±»å‹String[]ï¼Œå¦‚æœè®¾ç½®ä¸€ä¸ªå€¼ value=""</span></span><br><span class="line"><span class="comment">			optimize :å¼ºåˆ¶ä½¿ç”¨cglib</span></span><br><span class="line"><span class="comment">				&lt;property name="optimize" value="true"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">		åº•å±‚æœºåˆ¶</span></span><br><span class="line"><span class="comment">			å¦‚æœç›®æ ‡ç±»æœ‰æ¥å£ï¼Œé‡‡ç”¨jdkåŠ¨æ€ä»£ç†</span></span><br><span class="line"><span class="comment">			å¦‚æœæ²¡æœ‰æ¥å£ï¼Œé‡‡ç”¨cglib å­—èŠ‚ç å¢å¼º</span></span><br><span class="line"><span class="comment">			å¦‚æœå£°æ˜ optimize = true ï¼Œæ— è®ºæ˜¯å¦æœ‰æ¥å£ï¼Œéƒ½é‡‡ç”¨cglib</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"proxyServiceId"</span> <span class="attr">class</span>=<span class="string">"org.springframework.aop.framework.ProxyFactoryBean"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"interfaces"</span> <span class="attr">value</span>=<span class="string">"com.springlearning.b_factory_bean.UserService"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"target"</span> <span class="attr">ref</span>=<span class="string">"userServiceId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"interceptorNames"</span> <span class="attr">value</span>=<span class="string">"myAspectId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="1-4-4-æµ‹è¯•"><a href="#1-4-4-æµ‹è¯•" class="headerlink" title="1.4.4 æµ‹è¯•"></a>1.4.4 æµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo01</span><span class="params">()</span></span>&#123;</span><br><span class="line">	String xmlPath = <span class="string">"com/springlearning/b_factory_bean/beans.xml"</span>;</span><br><span class="line">	ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">	UserService userService = (UserService) applicationContext.getBean(<span class="string">"proxyServiceId"</span>);</span><br><span class="line">	userService.addUser();</span><br><span class="line">	userService.updateUser();</span><br><span class="line">	userService.deleteUser();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-5-Spring-AOPç¼–ç¨‹ï¼šå…¨è‡ªåŠ¨ã€æŒæ¡ã€‘"><a href="#1-5-Spring-AOPç¼–ç¨‹ï¼šå…¨è‡ªåŠ¨ã€æŒæ¡ã€‘" class="headerlink" title="1.5 Spring AOPç¼–ç¨‹ï¼šå…¨è‡ªåŠ¨ã€æŒæ¡ã€‘"></a>1.5 Spring AOPç¼–ç¨‹ï¼šå…¨è‡ªåŠ¨ã€æŒæ¡ã€‘</h3><ul>
<li>ä»springå®¹å™¨è·å¾—ç›®æ ‡ç±»ï¼Œå¦‚æœé…ç½®aopï¼Œspringå°†è‡ªåŠ¨ç”Ÿæˆä»£ç†ã€‚</li>
<li>è¦ç¡®å®šç›®æ ‡ç±»ï¼Œaspectj åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œå¯¼å…¥jaråŒ…         spring-framework-3.0.2.RELEASE-dependencies\org.aspectj\com.springsource.org.aspectj.weaver\1.6.8.RELEASE  </li>
</ul>
<h4 id="1-5-1-Spring-é…ç½®"><a href="#1-5-1-Spring-é…ç½®" class="headerlink" title="1.5.1 Spring é…ç½®"></a>1.5.1 Spring é…ç½®</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">                        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">                        http://www.springframework.org/schema/aop </span></span></span><br><span class="line"><span class="tag"><span class="string">       				    http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line">                       </span><br><span class="line">    <span class="comment">&lt;!-- 1 åˆ›å»ºç›®æ ‡ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userServiceId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.c_spring_aop.UserServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 2 åˆ›å»ºåˆ‡é¢ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myAspectId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.c_spring_aop.MyAspect"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 3 aopç¼–ç¨‹ </span></span><br><span class="line"><span class="comment">		3.1 å¯¼å…¥å‘½åç©ºé—´</span></span><br><span class="line"><span class="comment">		3.2 ä½¿ç”¨ &lt;aop:config&gt;è¿›è¡Œé…ç½®</span></span><br><span class="line"><span class="comment">				proxy-target-class="true" å£°æ˜æ—¶ä½¿ç”¨cglibä»£ç†</span></span><br><span class="line"><span class="comment">			&lt;aop:pointcut&gt; åˆ‡å…¥ç‚¹ ï¼Œä»ç›®æ ‡å¯¹è±¡è·å¾—å…·ä½“æ–¹æ³•</span></span><br><span class="line"><span class="comment">			&lt;aop:advisor&gt; ç‰¹æ®Šçš„åˆ‡é¢ï¼Œåªæœ‰ä¸€ä¸ªé€šçŸ¥ å’Œ ä¸€ä¸ªåˆ‡å…¥ç‚¹</span></span><br><span class="line"><span class="comment">				advice-ref é€šçŸ¥å¼•ç”¨</span></span><br><span class="line"><span class="comment">				pointcut-ref åˆ‡å…¥ç‚¹å¼•ç”¨</span></span><br><span class="line"><span class="comment">		3.3 åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">			execution(* com.springlearning.c_spring_aop.*.*(..))</span></span><br><span class="line"><span class="comment">			é€‰æ‹©æ–¹æ³•         è¿”å›å€¼ä»»æ„   åŒ…             ç±»åä»»æ„   æ–¹æ³•åä»»æ„   å‚æ•°ä»»æ„</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:config</span> <span class="attr">proxy-target-class</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.springlearning.c_spring_aop.*.*(..))"</span> <span class="attr">id</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"myAspectId"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="1-5-2-æµ‹è¯•"><a href="#1-5-2-æµ‹è¯•" class="headerlink" title="1.5.2 æµ‹è¯•"></a>1.5.2 æµ‹è¯•</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo01</span><span class="params">()</span></span>&#123;</span><br><span class="line">		String xmlPath = <span class="string">"com/springlearning/c_spring_aop/beans.xml"</span>;</span><br><span class="line">		ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(xmlPath);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//è·å¾—ç›®æ ‡ç±»</span></span><br><span class="line">		UserService userService = (UserService) applicationContext.getBean(<span class="string">"userServiceId"</span>);</span><br><span class="line">		userService.addUser();</span><br><span class="line">		userService.updateUser();</span><br><span class="line">		userService.deleteUser();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€AspectJ"><a href="#äºŒã€AspectJ" class="headerlink" title="äºŒã€AspectJ"></a>äºŒã€AspectJ</h2><h3 id="2-1-ä»‹ç»"><a href="#2-1-ä»‹ç»" class="headerlink" title="2.1 ä»‹ç»"></a>2.1 ä»‹ç»</h3><ul>
<li><p>AspectJæ˜¯ä¸€ä¸ªåŸºäºJavaè¯­è¨€çš„<span style="color:red">AOPæ¡†æ¶</span></p>
</li>
<li><p>Spring2.0ä»¥åæ–°å¢äº†å¯¹AspectJåˆ‡ç‚¹è¡¨è¾¾å¼æ”¯æŒ</p>
</li>
<li><p>@AspectJ æ˜¯AspectJ1.5æ–°å¢åŠŸèƒ½ï¼Œé€šè¿‡JDK5æ³¨è§£æŠ€æœ¯ï¼Œå…è®¸ç›´æ¥åœ¨Beanç±»ä¸­å®šä¹‰åˆ‡é¢</p>
<p>æ–°ç‰ˆæœ¬Springæ¡†æ¶ï¼Œå»ºè®®ä½¿ç”¨AspectJæ–¹å¼æ¥å¼€å‘AOP</p>
</li>
<li><p>ä¸»è¦ç”¨é€”ï¼šè‡ªå®šä¹‰å¼€å‘</p>
</li>
</ul>
<h3 id="2-2-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€æŒæ¡ã€‘"><a href="#2-2-åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€æŒæ¡ã€‘" class="headerlink" title="2.2 åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€æŒæ¡ã€‘"></a>2.2 åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€æŒæ¡ã€‘</h3><p>1.<span style="color:red">execution() </span>ç”¨äºæè¿°æ–¹æ³• ã€æŒæ¡ã€‘</p>
<p>â€‹    è¯­æ³•ï¼šexecution(<strong>ä¿®é¥°ç¬¦</strong> <strong>è¿”å›å€¼</strong> <strong>åŒ…</strong>.<strong>ç±»</strong>.<strong>æ–¹æ³•å</strong>(<strong>å‚æ•°</strong>) <strong>throwså¼‚å¸¸</strong>)</p>
<p>â€‹       <strong>ä¿®é¥°ç¬¦</strong>ï¼Œä¸€èˆ¬çœç•¥</p>
<p>â€‹           public      å…¬å…±æ–¹æ³•</p>
<p>â€‹           *          ä»»æ„</p>
<p>â€‹       <strong>è¿”å›å€¼</strong>ï¼Œä¸èƒ½çœç•¥</p>
<p>â€‹           void        è¿”å›æ²¡æœ‰å€¼</p>
<p>â€‹           String      è¿”å›å€¼å­—ç¬¦ä¸²</p>
<p>â€‹           *         ä»»æ„</p>
<p>â€‹       <strong>åŒ…</strong>ï¼Œ[å¯çœç•¥]</p>
<p>â€‹           com.itheima.crm         å›ºå®šåŒ…</p>
<p>â€‹           com.itheima.crm.*.service  crmåŒ…ä¸‹é¢å­åŒ…ä»»æ„ ï¼ˆä¾‹å¦‚ï¼šcom.itheima.crm.staff.serviceï¼‰</p>
<p>â€‹           com.itheima.crm..        crmåŒ…ä¸‹é¢çš„æ‰€æœ‰å­åŒ…ï¼ˆå«è‡ªå·±ï¼‰</p>
<p>â€‹           com.itheima.crm.*.service..  crmåŒ…ä¸‹é¢ä»»æ„å­åŒ…ï¼Œå›ºå®šç›®å½•serviceï¼Œserviceç›®å½•ä»»æ„åŒ…</p>
<p>â€‹           <strong>ç±»</strong>ï¼Œ[çœç•¥]</p>
<p>â€‹               UserServiceImpl         æŒ‡å®šç±»</p>
<p>â€‹               *Impl                 ä»¥Implç»“å°¾</p>
<p>â€‹               User*                 ä»¥Userå¼€å¤´</p>
<p>â€‹               *                    ä»»æ„</p>
<p>â€‹           <strong>æ–¹æ³•å</strong>ï¼Œä¸èƒ½çœç•¥</p>
<p>â€‹               addUser                å›ºå®šæ–¹æ³•</p>
<p>â€‹               add*                  ä»¥addå¼€å¤´</p>
<p>â€‹               *Do                  ä»¥Doç»“å°¾</p>
<p>â€‹               *                    ä»»æ„</p>
<p>â€‹           <strong>(å‚æ•°)</strong></p>
<p>â€‹               ()                    æ— å‚</p>
<p>â€‹               (int)                  ä¸€ä¸ªæ•´å‹</p>
<p>â€‹               (int ,int)               ä¸¤ä¸ª</p>
<p>â€‹               (..)                   å‚æ•°ä»»æ„</p>
<p>â€‹           <strong>throws</strong> ,å¯çœç•¥ï¼Œä¸€èˆ¬ä¸å†™ã€‚</p>
<p>ç»¼åˆ1</p>
<p>â€‹    <span style="color:red"><strong>execution(* com.springlearning.crm.*.service..*.*(..))</strong></span></p>
<p>ç»¼åˆ2</p>
<p>â€‹    &lt;aop:pointcut expression=â€execution(* com.springlearning.* WithCommit.*(..)) || </p>
<p>â€‹                                                      execution(* com.springlearning.* Service.*(..))â€ id=â€myPointCutâ€/&gt;</p>
<p>2.within:åŒ¹é…åŒ…æˆ–å­åŒ…ä¸­çš„æ–¹æ³•(äº†è§£)</p>
<p>â€‹    within(com.springlearning.aop..*)</p>
<p>3.this:åŒ¹é…å®ç°æ¥å£çš„ä»£ç†å¯¹è±¡ä¸­çš„æ–¹æ³•(äº†è§£)</p>
<p>â€‹    this(com.springlearning.aop.user.UserDAO)</p>
<p>4.target:åŒ¹é…å®ç°æ¥å£çš„ç›®æ ‡å¯¹è±¡ä¸­çš„æ–¹æ³•(äº†è§£)</p>
<p>â€‹    target(com.springlearning.aop.user.UserDAO)</p>
<p>5.args:åŒ¹é…å‚æ•°æ ¼å¼ç¬¦åˆæ ‡å‡†çš„æ–¹æ³•(äº†è§£)</p>
<p>â€‹    args(int,int)</p>
<p>6.bean(id) å¯¹æŒ‡å®šçš„beanæ‰€æœ‰çš„æ–¹æ³•(äº†è§£)</p>
<p>â€‹    bean(â€˜userServiceIdâ€™)</p>
<h3 id="2-3-AspectJ-é€šçŸ¥ç±»å‹"><a href="#2-3-AspectJ-é€šçŸ¥ç±»å‹" class="headerlink" title="2.3 AspectJ é€šçŸ¥ç±»å‹"></a>2.3 AspectJ é€šçŸ¥ç±»å‹</h3><ul>
<li><p>aopè”ç›Ÿå®šä¹‰é€šçŸ¥ç±»å‹ï¼Œå…·æœ‰ç‰¹æ€§æ¥å£ï¼Œå¿…é¡»å®ç°ï¼Œä»è€Œç¡®å®šæ–¹æ³•åç§°ã€‚</p>
</li>
<li><p>aspectj é€šçŸ¥ç±»å‹ï¼Œåªå®šä¹‰ç±»å‹åç§°ã€‚ä»¥åŠæ–¹æ³•æ ¼å¼ã€‚</p>
</li>
<li><p>ä¸ªæ•°ï¼š6ç§ï¼ŒçŸ¥é“5ç§ï¼ŒæŒæ¡1ä¸­ã€‚</p>
<p>â€‹    before:å‰ç½®é€šçŸ¥(åº”ç”¨ï¼šå„ç§æ ¡éªŒ)</p>
<p>â€‹                  åœ¨æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œï¼Œå¦‚æœé€šçŸ¥æŠ›å‡ºå¼‚å¸¸ï¼Œé˜»æ­¢æ–¹æ³•è¿è¡Œ</p>
<p>â€‹    afterReturning:åç½®é€šçŸ¥(åº”ç”¨ï¼šå¸¸è§„æ•°æ®å¤„ç†)</p>
</li>
</ul>
<p>â€‹                        æ–¹æ³•æ­£å¸¸è¿”å›åæ‰§è¡Œï¼Œå¦‚æœæ–¹æ³•ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œé€šçŸ¥æ— æ³•æ‰§è¡Œ</p>
<p>â€‹                       å¿…é¡»åœ¨æ–¹æ³•æ‰§è¡Œåæ‰æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥è·å¾—æ–¹æ³•çš„è¿”å›å€¼ã€‚</p>
<p>â€‹            <span style="color:red">around</span>:ç¯ç»•é€šçŸ¥(åº”ç”¨ï¼šååˆ†å¼ºå¤§ï¼Œå¯ä»¥åšä»»ä½•äº‹æƒ…)</p>
<p>â€‹                       æ–¹æ³•æ‰§è¡Œå‰ååˆ†åˆ«æ‰§è¡Œï¼Œå¯ä»¥é˜»æ­¢æ–¹æ³•çš„æ‰§è¡Œ</p>
<p>â€‹                       å¿…é¡»æ‰‹åŠ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•</p>
<p>â€‹            afterThrowing:æŠ›å‡ºå¼‚å¸¸é€šçŸ¥(åº”ç”¨ï¼šåŒ…è£…å¼‚å¸¸ä¿¡æ¯)</p>
<p>â€‹                       æ–¹æ³•æŠ›å‡ºå¼‚å¸¸åæ‰§è¡Œï¼Œå¦‚æœæ–¹æ³•æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸ï¼Œæ— æ³•æ‰§è¡Œ</p>
<pre><code>after:æœ€ç»ˆé€šçŸ¥(åº”ç”¨ï¼šæ¸…ç†ç°åœº)</code></pre><p>â€‹                       æ–¹æ³•æ‰§è¡Œå®Œæ¯•åæ‰§è¡Œï¼Œæ— è®ºæ–¹æ³•ä¸­æ˜¯å¦å‡ºç°å¼‚å¸¸</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ç¯ç»•é€šçŸ¥</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">     <span class="comment">//å‰ç½®ï¼šbefore</span></span><br><span class="line">    <span class="comment">//æ‰‹åŠ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//åç½®ï¼šafterRetruning</span></span><br><span class="line">&#125; <span class="keyword">catch</span>()&#123;</span><br><span class="line">    <span class="comment">//æŠ›å‡ºå¼‚å¸¸ afterThrowing</span></span><br><span class="line">&#125; <span class="keyword">finally</span>&#123;</span><br><span class="line">    <span class="comment">//æœ€ç»ˆ after</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-å¯¼å…¥jaråŒ…"><a href="#2-4-å¯¼å…¥jaråŒ…" class="headerlink" title="2.4 å¯¼å…¥jaråŒ…"></a>2.4 å¯¼å…¥jaråŒ…</h3><ul>
<li><p>4ä¸ªjaråŒ…ï¼š</p>
<p>â€‹    aopè”ç›Ÿè§„èŒƒ â€“&gt;com.springsource.org.aopaliance-1.0.0.jar</p>
<p>â€‹    spring aop å®ç°â€“&gt;spring-aop-4.2.4.RELEASE.jar</p>
<p>â€‹    aspect è§„èŒƒâ€“&gt;com.springsource.org.aspectj.weaver-1.6.8.RELEASE.jar</p>
<p>â€‹    spring aspect å®ç°â€“&gt;spring-aspects-4.2.4.RELEASE.jar</p>
</li>
</ul>
<h3 id="2-5-åŸºäºXML"><a href="#2-5-åŸºäºXML" class="headerlink" title="2.5 åŸºäºXML"></a>2.5 åŸºäºXML</h3><ol>
<li><p>ç›®æ ‡ç±»ï¼šæ¥å£ + å®ç°</p>
</li>
<li><p>åˆ‡é¢ç±»ï¼šç¼–å†™å¤šä¸ªé€šçŸ¥ï¼Œé‡‡ç”¨aspectj é€šçŸ¥åç§°ä»»æ„ï¼ˆæ–¹æ³•åä»»æ„ï¼‰</p>
</li>
<li><p>aopç¼–ç¨‹ï¼Œå°†é€šçŸ¥åº”ç”¨åˆ°ç›®æ ‡ç±»</p>
</li>
<li><p>æµ‹è¯•</p>
</li>
</ol>
<h4 id="2-5-1-åˆ‡é¢ç±»"><a href="#2-5-1-åˆ‡é¢ç±»" class="headerlink" title="2.5.1 åˆ‡é¢ç±»"></a>2.5.1 åˆ‡é¢ç±»</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ‡é¢ç±»ï¼Œå«æœ‰å¤šä¸ªé€šçŸ¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myBefore</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"å‰ç½®é€šçŸ¥ä¸å½“å‰ç›®æ ‡æ–¹æ³•åç§°ï¼š"</span>+joinPoint.getSignature().getName());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfterReturning</span><span class="params">(JoinPoint joinPoint,Object ret)</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"åç½®é€šçŸ¥ä¸å½“å‰ç›®æ ‡æ–¹æ³•åç§°ï¼š"</span>+joinPoint.getSignature().getName()+<span class="string">"ï¼Œç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼ä¸ºï¼š"</span>+ret);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">myAround</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable</span>&#123;<span class="comment">//å¿…é¡»æœ‰å‚æ•°ä¸ºå¯æ‰§è¡Œçš„joinPoint</span></span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"ç¯ç»•é€šçŸ¥çš„å‰é¢"</span>);</span><br><span class="line">		<span class="comment">//æ‰‹åŠ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></span><br><span class="line">		Object obj = joinPoint.proceed();</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"ç¯ç»•é€šçŸ¥çš„åé¢"</span>);</span><br><span class="line">		<span class="keyword">return</span> obj;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfterThrowing</span><span class="params">(JoinPoint joinPoint,Throwable e)</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"æŠ›å‡ºå¼‚å¸¸é€šçŸ¥ï¼š"</span>+e.getMessage());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfter</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"æœ€ç»ˆé€šçŸ¥ï¼ï¼ï¼ï¼"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-5-2-Springé…ç½®"><a href="#2-5-2-Springé…ç½®" class="headerlink" title="2.5.2  Springé…ç½®"></a>2.5.2  Springé…ç½®</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">                        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">                        http://www.springframework.org/schema/aop </span></span></span><br><span class="line"><span class="tag"><span class="string">       				    http://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line">                       </span><br><span class="line">    <span class="comment">&lt;!-- 1 åˆ›å»ºç›®æ ‡ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userServiceId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.d_aspect.a_xml.UserServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 2 åˆ›å»ºåˆ‡é¢ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myAspectId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.d_aspect.a_xml.MyAspect"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 3 aopç¼–ç¨‹ </span></span><br><span class="line"><span class="comment">		&lt;aop:aspect&gt; å°†åˆ‡é¢ç±» å£°æ˜â€œåˆ‡é¢â€ï¼Œä»è€Œè·å¾—é€šçŸ¥ï¼ˆæ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="comment">			ref åˆ‡é¢ç±»å¼•ç”¨</span></span><br><span class="line"><span class="comment">		&lt;aop:pointcut&gt; å£°æ˜ä¸€ä¸ªåˆ‡å…¥ç‚¹ï¼Œæ‰€æœ‰çš„é€šçŸ¥éƒ½å¯ä»¥ä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="comment">			expression åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">			id åç§°ï¼Œç”¨äºå…¶å®ƒé€šçŸ¥å¼•ç”¨</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"myAspectId"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* com.springlearning.d_aspect.a_xml.UserServiceImpl.*(..))"</span> <span class="attr">id</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">"myAfterThrowing"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span> <span class="attr">throwing</span>=<span class="string">"e"</span> /&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 3.1 å‰ç½®é€šçŸ¥ </span></span><br><span class="line"><span class="comment">				&lt;aop:before method="" pointcut="" pointcut-ref=""/&gt;</span></span><br><span class="line"><span class="comment">					method : é€šçŸ¥ï¼ŒåŠæ–¹æ³•å</span></span><br><span class="line"><span class="comment">					pointcut :åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œæ­¤è¡¨è¾¾å¼åªèƒ½å½“å‰é€šçŸ¥ä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="comment">					pointcut-ref ï¼š åˆ‡å…¥ç‚¹å¼•ç”¨ï¼Œå¯ä»¥ä¸å…¶ä»–é€šçŸ¥å…±äº«åˆ‡å…¥ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">				é€šçŸ¥æ–¹æ³•æ ¼å¼ï¼špublic void myBefore(JoinPoint joinPoint)&#123;</span></span><br><span class="line"><span class="comment">					å‚æ•°1ï¼šorg.aspectj.lang.JoinPoint  ç”¨äºæè¿°è¿æ¥ç‚¹ï¼ˆç›®æ ‡æ–¹æ³•ï¼‰ï¼Œè·å¾—ç›®æ ‡æ–¹æ³•åç­‰</span></span><br><span class="line"><span class="comment">				ä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="comment">			&lt;aop:before method="myBefore" pointcut-ref="myPointCut"/&gt;</span></span><br><span class="line"><span class="comment">			--&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 3.2åç½®é€šçŸ¥  ,ç›®æ ‡æ–¹æ³•åæ‰§è¡Œï¼Œè·å¾—è¿”å›å€¼</span></span><br><span class="line"><span class="comment">				&lt;aop:after-returning method="" pointcut-ref="" returning=""/&gt;</span></span><br><span class="line"><span class="comment">					returning é€šçŸ¥æ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°çš„åç§°</span></span><br><span class="line"><span class="comment">				é€šçŸ¥æ–¹æ³•æ ¼å¼ï¼špublic void myAfterReturning(JoinPoint joinPoint,Object ret)&#123;</span></span><br><span class="line"><span class="comment">					å‚æ•°1ï¼šè¿æ¥ç‚¹æè¿°</span></span><br><span class="line"><span class="comment">					å‚æ•°2ï¼šç±»å‹Objectï¼Œå‚æ•°å returning="ret" é…ç½®çš„</span></span><br><span class="line"><span class="comment">				ä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="comment">			&lt;aop:after-returning method="myAfterReturning" pointcut-ref="myPointCut" returning="ret" /&gt;</span></span><br><span class="line"><span class="comment">			--&gt;</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">&lt;!-- 3.3 ç¯ç»•é€šçŸ¥ </span></span><br><span class="line"><span class="comment">				&lt;aop:around method="" pointcut-ref=""/&gt;</span></span><br><span class="line"><span class="comment">				é€šçŸ¥æ–¹æ³•æ ¼å¼ï¼špublic Object myAround(ProceedingJoinPoint joinPoint) throws Throwable&#123;</span></span><br><span class="line"><span class="comment">					è¿”å›å€¼ç±»å‹ï¼šObject</span></span><br><span class="line"><span class="comment">					æ–¹æ³•åï¼šä»»æ„</span></span><br><span class="line"><span class="comment">					å‚æ•°ï¼šorg.aspectj.lang.ProceedingJoinPoint</span></span><br><span class="line"><span class="comment">					æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"><span class="comment">				æ‰§è¡Œç›®æ ‡æ–¹æ³•ï¼šObject obj = joinPoint.proceed();</span></span><br><span class="line"><span class="comment">				ä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="comment">			&lt;aop:around method="myAround" pointcut-ref="myPointCut"/&gt;</span></span><br><span class="line"><span class="comment">			--&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 3.4 æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"><span class="comment">				&lt;aop:after-throwing method="" pointcut-ref="" throwing=""/&gt;</span></span><br><span class="line"><span class="comment">					throwing ï¼šé€šçŸ¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°åç§°</span></span><br><span class="line"><span class="comment">				é€šçŸ¥æ–¹æ³•æ ¼å¼ï¼špublic void myAfterThrowing(JoinPoint joinPoint,Throwable e)&#123;</span></span><br><span class="line"><span class="comment">					å‚æ•°1ï¼šè¿æ¥ç‚¹æè¿°å¯¹è±¡</span></span><br><span class="line"><span class="comment">					å‚æ•°2ï¼šè·å¾—å¼‚å¸¸ä¿¡æ¯ï¼Œç±»å‹Throwable ï¼Œå‚æ•°åç”±throwing="e" é…ç½®</span></span><br><span class="line"><span class="comment">				ä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="comment">			&lt;aop:after-throwing method="myAfterThrowing" pointcut-ref="myPointCut" throwing="e"/&gt;</span></span><br><span class="line"><span class="comment">			--&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- 3.5 æœ€ç»ˆé€šçŸ¥ 	</span></span><br><span class="line"><span class="comment">			&lt;aop:after method="myAfter" pointcut-ref="myPointCut"/&gt;</span></span><br><span class="line"><span class="comment">			--&gt;</span>		</span><br><span class="line">			<span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"myAfter"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-5-3-ä¸ªäººç†è§£"><a href="#2-5-3-ä¸ªäººç†è§£" class="headerlink" title="2.5.3 ä¸ªäººç†è§£"></a>2.5.3 ä¸ªäººç†è§£</h4><p>â€‹            é¦–å…ˆè¦å†™çš„æ˜¯ç›®æ ‡ç±»ï¼Œç›®æ ‡ç±»åŒ…æ‹¬æ¥å£ä¸å®ç°ç±»ï¼Œæœ‰æ¥å£å®ç°é¢å‘åˆ‡é¢ç¼–ç¨‹ä½¿ç”¨çš„å°±æ˜¯JDKçš„åŠ¨æ€ä»£ç†ï¼Œæ²¡æœ‰çš„è¯å°±ä¼šä½¿ç”¨CGLIBçš„å­—èŠ‚ç å¢å¼ºï¼Œå¦‚æœæœ‰æ¥å£ä¹Ÿå¯ä»¥å¼ºåˆ¶ä½¿ç”¨CGLIBï¼Œåªéœ€åŠ ä¸€ä¸ªå£°æ˜ä»£ç ï¼ˆ<code>&lt;aop:config proxy-target-class=&quot;true&quot;&gt;</code>ï¼‰ã€‚å…¶æ¬¡å°±æ˜¯åˆ‡é¢ç±»ï¼Œè¿™é‡Œé¢è£…ç€è®¸å¤šæƒ³è¦ç»‡å…¥ç›®æ ‡æ–¹æ³•çš„ä¸€äº›ä¸ªé€šçŸ¥ï¼ˆä¹Ÿå°±æ˜¯ä¸€äº›æ–¹æ³•ï¼‰ï¼Œå› ä¸ºé‡‡ç”¨çš„æ˜¯aspectjï¼Œæ‰€ä»¥åœ¨åˆ‡é¢ç±»ä¸­æ–¹æ³•åéšæ„äº›ï¼Œåœ¨é…ç½®ä¸­æ‰ä¼šç‰¹æ„å£°æ˜è¿™ä¸ªé€šçŸ¥çš„ç±»å‹ï¼Œaspectjçš„é€šçŸ¥ç±»å‹æœ‰6ç±»ï¼ŒåŒ…æ‹¬ï¼š</p>
<p>1.aop:before å‰ç½®é€šçŸ¥ç±»å‹ï¼Œåœ¨ç›®æ ‡æ–¹æ³•ä¹‹å‰æ‰§è¡Œ</p>
<p>2.aop:after-returning åç½®é€šçŸ¥ç±»å‹ï¼Œåœ¨ç›®æ ‡æ–¹æ³•ä¹‹åæ‰§è¡Œ</p>
<p>3.aop:around ç¯ç»•é€šçŸ¥ç±»å‹ï¼Œå¯åœ¨ç›®æ ‡æ–¹æ³•å‰ååˆ†åˆ«æ‰§è¡Œï¼Œæ³¨æ„ï¼š<span style="color:red">éœ€æ‰‹åŠ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></p>
<p>4.aop:after-throwing æŠ›å‡ºå¼‚å¸¸é€šçŸ¥ç±»å‹ï¼Œå³å¯æŠ›å‡ºç›®æ ‡æ–¹æ³•ä¸­å­˜åœ¨çš„å¼‚å¸¸ï¼Œåœ¨å¼‚å¸¸ä¹‹åçš„æ–¹æ³•æ— æ³•æ‰§è¡Œ</p>
<p>5.aop:after æœ€ç»ˆè¦æ‰§è¡Œçš„æ–¹æ³•ï¼Œä¸trycatchä¸­çš„finallyä¸€æ ·</p>
<p>6.aop:delare-parents å¼•ä»‹é€šçŸ¥ç±»å‹ï¼Œæ²¡æ€ä¹ˆç”¨</p>
<p>â€‹    æœ€é‡è¦çš„å°±æ˜¯xmlæ–‡ä»¶çš„é…ç½®ï¼Œé¦–å…ˆï¼Œéœ€è¦å°†ç›®æ ‡ç±»ä¸åˆ‡é¢ç±»è½¬åŒ–æˆ<code>&lt;bean&gt;</code>æ ‡ç­¾ï¼Œæ–¹ä¾¿ä½¿ç”¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1 åˆ›å»ºç›®æ ‡ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userServiceId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.d_aspect.a_xml.UserServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 2 åˆ›å»ºåˆ‡é¢ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myAspectId"</span> <span class="attr">class</span>=<span class="string">"com.springlearning.d_aspect.a_xml.MyAspect"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¥ç€å°±æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹çš„é…ç½®ï¼Œç”¨<code>&lt;aop:config&gt;</code>æ ‡ç­¾è¡¨æ˜åœ¨è¿›è¡Œé¢å‘åˆ‡é¢ç¼–ç¨‹é…ç½®ï¼Œç„¶åå£°æ˜è¦è¿›è¡Œé…ç½®çš„åˆ‡é¢ï¼Œå°±æ˜¯<code>&lt;aop:aspect ref= &quot;myAspectId&quot; &gt;</code>,å¹¶å°†ä¹‹å‰å£°æ˜çš„åˆ‡é¢ç±»å¼•ç”¨è¿›æ¥ï¼Œå°±æ˜¯è¯´è¦åœ¨è¯¥åˆ‡é¢ç±»çš„åŸºç¡€ä¸Šè¿›è¡Œåˆ‡é¢ç¼–ç¨‹ï¼Œä¹‹åï¼Œè¿›è¡Œåˆ‡å…¥ç‚¹è¡¨è¾¾å¼çš„å£°æ˜<code>&lt;aop:pointcut expression=*&quot;execution(\* com.itheima.d_aspect.a_xml.UserServiceImpl.*(..))&quot; id=&quot;myPointCut&quot; /&gt;</code>ï¼Œå°±æ˜¯è¯´æˆ‘è¦å¯¹å“ªäº›åŒ…ä¸­çš„å“ªäº›ç±»ä¸­çš„å“ªäº›æ–¹æ³•ï¼ˆç›®æ ‡æ–¹æ³•ï¼‰è¿›è¡Œåˆ‡å…¥ï¼Œè¿™ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ä¹Ÿæ˜¯æœ‰ä¸€å®šçš„æ ¼å¼çš„ï¼Œä¹‹åä¾¿å¯ä»¥è¿›è¡Œå„ç§æ–¹æ³•çš„åˆ‡å…¥äº†ï¼Œæ ¼å¼å¤§è‡´ä¸º         <code>&lt;aop:before method=&quot;&quot; pointcut=&quot;&quot; pointcut-ref=&quot;&quot;/&gt;</code> ï¼Œå…ˆå£°æ˜é€šçŸ¥ç±»å‹ï¼Œå†å»åˆ‡é¢ç±»ä¸­æ‰¾å…·ä½“çš„æ–¹æ³•ï¼Œåˆ‡å…¥ç‚¹çš„è¯ï¼Œæœ‰ä¸Šè¿°ä¸¤ç§å†™æ³•ï¼Œpointcut=â€â€æŒ‡çš„æ˜¯å½“å‰é€šçŸ¥ç‹¬æœ‰ï¼Œpointcut-ref=â€â€å°±æ˜¯æ‰€æœ‰é€šçŸ¥å…±åŒçš„å¼•ç”¨ï¼Œåªæ˜¯åœ¨ç¯ç»•é€šçŸ¥çš„æ—¶å€™ï¼Œå®ƒçš„åˆ‡é¢ç±»å¿…é¡»å£°æ˜ä¸€ä¸ªå‚æ•°(ProceedingJoinPoint joinPoint)  å³å¯æ‰§è¡Œçš„joinPointï¼Œç”¨<code>Object obj = joinPoint.proceed();</code>æ¥æ‰‹åŠ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•ï¼Œå…¶ä»–é€šçŸ¥ç±»å‹çš„å‚æ•°éƒ½æ˜¯å¯æœ‰å¯æ— çš„ã€‚</p>
<h3 id="2-6-åŸºäºæ³¨è§£"><a href="#2-6-åŸºäºæ³¨è§£" class="headerlink" title="2.6 åŸºäºæ³¨è§£"></a>2.6 åŸºäºæ³¨è§£</h3><h4 id="2-6-1-æ›¿æ¢Bean"><a href="#2-6-1-æ›¿æ¢Bean" class="headerlink" title="2.6.1 æ›¿æ¢Bean"></a>2.6.1 æ›¿æ¢Bean</h4><p>â€‹            åœ¨åŸºäºxmlä¸­ï¼Œé¦–å…ˆéœ€è¦å£°æ˜ä¸¤ä¸ª<code>&lt;bean&gt;</code>æ ‡ç­¾ï¼Œç”¨æ¥åˆ›å»ºç›®æ ‡ç±»å’Œåˆ‡é¢ç±»(é€šçŸ¥)ï¼Œåœ¨åŸºäºæ³¨è§£ä¸­ï¼Œå°±å¯ä»¥çœç•¥è¿™ä¸ª<code>&lt;bean&gt;</code>æ ‡ç­¾ï¼Œåœ¨ç›®æ ‡ç±»çš„å¤´ä¸Šæ·»åŠ æ³¨è§£<code>@Service(&quot;UserServiceId&quot;)</code>ï¼Œåœ¨åˆ‡é¢ç±»çš„å¤´ä¸Šæ·»åŠ éƒ¨ä»¶æ³¨è§£<code>@Component</code>ï¼Œå°±å¯ä»¥åœ¨è¿è¡Œæµ‹è¯•æ—¶æ‰¾åˆ°è¿™ä¸¤ä¸ªç±»ã€‚åªä¸è¿‡è¦æ³¨æ„åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ‰«ææ³¨è§£ç±»ï¼›ä»¥åŠå‘½åç©ºé—´ä¹Ÿè¦åšæ·»åŠ ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">                        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">                        http://www.springframework.org/schema/aop </span></span></span><br><span class="line"><span class="tag"><span class="string">       				    http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">       				    http://www.springframework.org/schema/context </span></span></span><br><span class="line"><span class="tag"><span class="string">       					http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">                       </span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 1.æ‰«æ æ³¨è§£ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.springlearning.d_aspect.b_anno"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-6-2-æ›¿æ¢AOP"><a href="#2-6-2-æ›¿æ¢AOP" class="headerlink" title="2.6.2 æ›¿æ¢AOP"></a>2.6.2 æ›¿æ¢AOP</h4><ul>
<li><p>å¿…é¡»è¿›è¡Œaspectj è‡ªåŠ¨ä»£ç†</p>
<p><code>&lt;!-- 2.ç¡®å®š aopæ³¨è§£ç”Ÿæ•ˆ --&gt;</code></p>
<p><code>&lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</code></p>
</li>
<li><p>ä¹‹å‰å£°æ˜åˆ‡é¢æ˜¯åœ¨<code>&lt;aop config&gt;</code>çš„æ ‡ç­¾ä¸‹çš„<code>&lt;aop:aspect ref=&quot;myAspectId&quot;</code>ä¸­è¿›è¡Œçš„ï¼Œåœ¨åŸºäºæ³¨è§£ä¸­ï¼Œå°±å¯ä»¥åœ¨åˆ‡é¢ç±»çš„éƒ¨ä»¶æ³¨è§£ä¸‹é¢å†æ·»åŠ ä¸€ä¸ª<code>@Aspect</code>æ³¨è§£å°±å¯ä»¥æ‰¾åˆ°è¿™ä¸ªåˆ‡é¢ç±»ï¼Œå› ä¸ºæ‰€æœ‰æ–¹æ³•éœ€è¦è¿›è¡Œé€šçŸ¥çš„æ–¹æ³•éƒ½æ˜¯æ”¾åœ¨è¿™ä¸ªåˆ‡é¢ç±»ä¸­çš„ï¼Œæ‰€ä»¥å¯ä»¥ä¸å¯¹è¿™ä¸ªåˆ‡é¢ç±»çš„æ³¨è§£è¿›è¡Œå‘½åã€‚</p>
</li>
<li><p><strong>æ›¿æ¢å‰ç½®é€šçŸ¥ï¼Œ</strong>ä¹‹å‰æ˜¯åœ¨<code>&lt;aop:aspect ref=&quot;myAspectId&quot;</code>æ ‡ç­¾ä¸‹è¿›è¡Œé€šçŸ¥æ ‡ç­¾çš„è®¾ç½®ã€‚ä¾‹å¦‚å‰ç½®é€šçŸ¥<code>&lt;aop:before method=&quot;myBefore&quot; pointcut-ref=&quot;myPointCut&quot;/&gt;</code>ï¼Œåœ¨åŸºäºæ³¨è§£ä¸­ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨åˆ‡é¢ç±»ä¸­çš„å„ä¸ªæ–¹æ³•çš„å¤´éƒ¨ä»¥æ·»åŠ æ³¨è§£çš„æ–¹å¼ï¼Œå®ç°é€šçŸ¥æ–¹æ³•çš„ç»‡å…¥ï¼Œä¾‹å¦‚å‰ç½®é€šçŸ¥<code>@Before(&quot;execution(* com.springlearning.d_aspect.b_anno.UserServiceImpl.*(..))&quot;)</code>ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªåˆ‡å…¥ç‚¹ä¹Ÿåªæ˜¯å½“å‰é€šçŸ¥æœ‰æ•ˆï¼Œä¹Ÿå¯ä»¥åƒxmlä¸­ä¸€æ ·è®¾ç½®å…¬å…±åˆ‡å…¥ç‚¹ã€‚</p>
</li>
<li><p><strong>æ›¿æ¢å…¬å…±åˆ‡å…¥ç‚¹</strong>ï¼Œä¹‹å‰å£°æ˜å…¬å…±åˆ‡å…¥ç‚¹æ˜¯åœ¨<code>&lt;aop config&gt;</code>æ ‡ç­¾ä¸‹é…ç½®<code>&lt;aop:pointcut expression=&quot;execution(* com.springlearning.d_aspect.a_xml.UserServiceImpl.*(..))&quot; id=&quot;myPointCut&quot;/&gt;</code>æ ‡ç­¾ï¼Œåœ¨æ³¨è§£ä¸­ï¼Œå¯ä»¥åœ¨åˆ‡é¢ç±»ä¸­åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œåå­—å°±ä¸ºmyPointCutï¼Œåœ¨è¯¥æ–¹æ³•å¤´éƒ¨æ·»åŠ <code>@Pointcut(&quot;execution(* com.springlearning.d_aspect.b_anno.UserServiceImpl.*(..))&quot;)</code>ï¼Œæ³¨è§£ï¼Œä»¥åï¼Œå“ªä¸€ä¸ªæ–¹æ³•æƒ³ç”¨è¿™ä¸ªåˆ‡å…¥ç‚¹ï¼Œç›´æ¥åœ¨æ³¨è§£ä¸­è°ƒç”¨å¼•ç”¨<code>&quot;myPointCut()&quot;</code>è¿™ä¸ªæ–¹æ³•å³å¯ã€‚</p>
</li>
<li><p><strong>æ›¿æ¢åç½®</strong></p>
<ul>
<li>ä¹‹å‰</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:after-returning</span> <span class="attr">method</span>=<span class="string">"myAfterReturning"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span> <span class="attr">returning</span>=<span class="string">"ret"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åŸºäºæ³¨è§£</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">   <span class="meta">@AfterReturning</span>(value=<span class="string">"myPointCut()"</span>,returning=<span class="string">"ret"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfterReturning</span><span class="params">(JoinPoint joinPoint,Object ret)</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	System.out.println(<span class="string">"åç½®é€šçŸ¥ä¸å½“å‰ç›®æ ‡æ–¹æ³•åç§°ï¼š"</span>+joinPoint.getSignature().getName()+<span class="string">"ï¼Œç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼ä¸ºï¼š"</span>+ret);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>æ›¿æ¢ç¯ç»•</strong></p>
<ul>
<li>ä¹‹å‰</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">"myAround"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åŸºäºæ³¨è§£</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">   <span class="meta">@Around</span>(value = <span class="string">"myPointCut()"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">myAround</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable</span>&#123;<span class="comment">//å¿…é¡»æœ‰å‚æ•°ä¸ºå¯æ‰§è¡Œçš„joinPoint</span></span><br><span class="line">	</span><br><span class="line">	System.out.println(<span class="string">"ç¯ç»•é€šçŸ¥çš„å‰é¢"</span>);</span><br><span class="line">	<span class="comment">//æ‰‹åŠ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></span><br><span class="line">	Object obj = joinPoint.proceed();</span><br><span class="line">	</span><br><span class="line">	System.out.println(<span class="string">"ç¯ç»•é€šçŸ¥çš„åé¢"</span>);</span><br><span class="line">	<span class="keyword">return</span> obj;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>æ›¿æ¢æŠ›å‡ºå¼‚å¸¸</strong></p>
<ul>
<li>ä¹‹å‰</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">"myAfterThrowing"</span> <span class="attr">pointcut</span>=<span class="string">"execution(* com.springlearning.d_aspect.a_xml.UserServiceImpl.*(..))"</span> <span class="attr">throwing</span>=<span class="string">"e"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åŸºäºæ³¨è§£</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@AfterThrowing</span>(value=<span class="string">"execution(* com.springlearning.d_aspect.a_xml.UserServiceImpl.*(..))"</span>,throwing=<span class="string">"e"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfterThrowing</span><span class="params">(JoinPoint joinPoint,Throwable e)</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"æŠ›å‡ºå¼‚å¸¸é€šçŸ¥ï¼š"</span>+e.getMessage());</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>æ›¿æ¢æœ€ç»ˆé€šçŸ¥</strong></p>
<ul>
<li>ä¹‹å‰</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"myAfter"</span> <span class="attr">pointcut-ref</span>=<span class="string">"myPointCut"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åŸºäºæ³¨è§£</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@After</span>(value = <span class="string">"myPointCut()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfter</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"æœ€ç»ˆé€šçŸ¥ï¼ï¼ï¼ï¼"</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="2-6-3-åˆ‡é¢ç±»"><a href="#2-6-3-åˆ‡é¢ç±»" class="headerlink" title="2.6.3 åˆ‡é¢ç±»"></a>2.6.3 åˆ‡é¢ç±»</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springlearning.d_aspect.b_anno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ‡é¢ç±»ï¼Œå«æœ‰å¤šä¸ªé€šçŸ¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//åˆ‡å…¥ç‚¹å½“å‰æœ‰æ•ˆ</span></span><br><span class="line">	<span class="comment">//@Before("execution(* com.springlearning.d_aspect.b_anno.UserServiceImpl.*(..))")</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myBefore</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"å‰ç½®é€šçŸ¥ä¸å½“å‰ç›®æ ‡æ–¹æ³•åç§°ï¼š"</span>+joinPoint.getSignature().getName());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//å£°æ˜å…¬å…±åˆ‡å…¥ç‚¹</span></span><br><span class="line">	<span class="meta">@Pointcut</span>(<span class="string">"execution(* com.springlearning.d_aspect.b_anno.UserServiceImpl.*(..))"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">myPointCut</span><span class="params">()</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//@AfterReturning(value="myPointCut()",returning="ret")</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfterReturning</span><span class="params">(JoinPoint joinPoint,Object ret)</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"åç½®é€šçŸ¥ä¸å½“å‰ç›®æ ‡æ–¹æ³•åç§°ï¼š"</span>+joinPoint.getSignature().getName()+<span class="string">"ï¼Œç›®æ ‡æ–¹æ³•çš„è¿”å›å€¼ä¸ºï¼š"</span>+ret);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//@Around(value = "myPointCut()")</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">myAround</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable</span>&#123;<span class="comment">//å¿…é¡»æœ‰å‚æ•°ä¸ºå¯æ‰§è¡Œçš„joinPoint</span></span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"ç¯ç»•é€šçŸ¥çš„å‰é¢"</span>);</span><br><span class="line">		<span class="comment">//æ‰‹åŠ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•</span></span><br><span class="line">		Object obj = joinPoint.proceed();</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"ç¯ç»•é€šçŸ¥çš„åé¢"</span>);</span><br><span class="line">		<span class="keyword">return</span> obj;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//@AfterThrowing(value = "myPointCut()",throwing="e")</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfterThrowing</span><span class="params">(JoinPoint joinPoint,Throwable e)</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"æŠ›å‡ºå¼‚å¸¸é€šçŸ¥ï¼š"</span>+e.getMessage());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@After</span>(value = <span class="string">"myPointCut()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myAfter</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"æœ€ç»ˆé€šçŸ¥ï¼ï¼ï¼ï¼"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-6-4-Spring-é…ç½®"><a href="#2-6-4-Spring-é…ç½®" class="headerlink" title="2.6.4 Spring é…ç½®"></a>2.6.4 Spring é…ç½®</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1.æ‰«æ æ³¨è§£ç±» --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.springlearning.d_aspect.b_anno"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 2.ç¡®å®š aopæ³¨è§£ç”Ÿæ•ˆ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:aspectj-autoproxy</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-6-5-AOPæ³¨è§£æ€»ç»“"><a href="#2-6-5-AOPæ³¨è§£æ€»ç»“" class="headerlink" title="2.6.5 AOPæ³¨è§£æ€»ç»“"></a>2.6.5 AOPæ³¨è§£æ€»ç»“</h4><p>@Aspect å£°æ˜åˆ‡é¢ï¼Œä¿®é¥°åˆ‡é¢ç±»ï¼Œä»è€Œè·å¾— é€šçŸ¥ã€‚</p>
<p>é€šçŸ¥</p>
<p>â€‹    @Before å‰ç½®</p>
<p>â€‹    @AfterReturning åç½®</p>
<p>â€‹    @Around ç¯ç»•</p>
<p>â€‹    @AfterThrowing æŠ›å‡ºå¼‚å¸¸</p>
<p>â€‹    @After æœ€ç»ˆ</p>
<p>åˆ‡å…¥ç‚¹</p>
<p>â€‹    @PointCut ï¼Œä¿®é¥°æ–¹æ³• private void xxx(){} ä¹‹åé€šè¿‡â€œæ–¹æ³•åâ€è·å¾—åˆ‡å…¥ç‚¹å¼•ç”¨</p>
<h2 id="ä¸‰ã€JdbcTemplateï¼ˆjdbcæ¨¡æ¿ï¼‰"><a href="#ä¸‰ã€JdbcTemplateï¼ˆjdbcæ¨¡æ¿ï¼‰" class="headerlink" title="ä¸‰ã€JdbcTemplateï¼ˆjdbcæ¨¡æ¿ï¼‰"></a>ä¸‰ã€JdbcTemplateï¼ˆjdbcæ¨¡æ¿ï¼‰</h2><ul>
<li><p>spring æä¾›ç”¨äºæ“ä½œJDBCå·¥å…·ç±»ï¼Œç±»ä¼¼ï¼šDBUtilsã€‚</p>
</li>
<li><p>ä¾èµ– è¿æ¥æ± DataSource ï¼ˆæ•°æ®æºï¼‰</p>
</li>
</ul>
<h3 id="3-1-ç¯å¢ƒæ­å»º"><a href="#3-1-ç¯å¢ƒæ­å»º" class="headerlink" title="3.1 ç¯å¢ƒæ­å»º"></a>3.1 ç¯å¢ƒæ­å»º</h3><h4 id="3-1-1-åˆ›å»ºè¡¨"><a href="#3-1-1-åˆ›å»ºè¡¨" class="headerlink" title="3.1.1 åˆ›å»ºè¡¨"></a>3.1.1 åˆ›å»ºè¡¨</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> ee19_spring_day02;</span><br><span class="line"><span class="keyword">use</span> ee19_spring_day02;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_user(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">  username <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">  <span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">32</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_user(username,<span class="keyword">password</span>) <span class="keyword">values</span>(<span class="string">'jack'</span>,<span class="string">'1234'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_user(username,<span class="keyword">password</span>) <span class="keyword">values</span>(<span class="string">'rose'</span>,<span class="string">'5678'</span>);</span><br></pre></td></tr></table></figure>

<h4 id="3-1-2-å¯¼å…¥jaråŒ…"><a href="#3-1-2-å¯¼å…¥jaråŒ…" class="headerlink" title="3.1.2 å¯¼å…¥jaråŒ…"></a>3.1.2 å¯¼å…¥jaråŒ…</h4><p><img src="http://q1o3t6lvp.bkt.clouddn.com/jdbc%E6%A8%A1%E6%9D%BFjar%E5%8C%85.png" alt="æ²¡æœ‰æ‰¾åˆ°"></p>
<h4 id="3-1-3-javabean"><a href="#3-1-3-javabean" class="headerlink" title="3.1.3 javabean"></a>3.1.3 javabean</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-ä½¿ç”¨apiï¼ˆäº†è§£ï¼‰"><a href="#3-2-ä½¿ç”¨apiï¼ˆäº†è§£ï¼‰" class="headerlink" title="3.2 ä½¿ç”¨apiï¼ˆäº†è§£ï¼‰"></a>3.2 ä½¿ç”¨apiï¼ˆäº†è§£ï¼‰</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//1.åˆ›å»ºæ•°æ®æºï¼ˆè¿æ¥æ± ï¼‰dbcp</span></span><br><span class="line">		BasicDataSource dataSource = <span class="keyword">new</span> BasicDataSource();</span><br><span class="line">		<span class="comment">//*åŸºæœ¬4é¡¹</span></span><br><span class="line">		dataSource.setDriverClassName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">		dataSource.setUrl(<span class="string">"jdbc:mysql://localhost:3306/ee19_spring_day02"</span>);</span><br><span class="line">		dataSource.setUsername(<span class="string">"root"</span>);</span><br><span class="line">		dataSource.setPassword(<span class="string">"873383"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//2.åˆ›å»ºæ¨¡æ¿</span></span><br><span class="line">		JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate();</span><br><span class="line">		jdbcTemplate.setDataSource(dataSource);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//3.é€šè¿‡apiæ“ä½œ</span></span><br><span class="line">		jdbcTemplate.update(<span class="string">"insert into t_user(username,password) values(?,?);"</span>, <span class="string">"tom"</span>,<span class="string">"998"</span>);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-é…ç½®DBCP"><a href="#3-3-é…ç½®DBCP" class="headerlink" title="3.3 é…ç½®DBCP"></a>3.3 é…ç½®DBCP</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åˆ›å»ºæ•°æ®æº --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSourceId"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbcp.BasicDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/ee19_spring_day02?characterEncoding=utf8&amp;useSSL=true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"873383"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- åˆ›å»ºæ¨¡æ¿ ,éœ€è¦æ³¨å…¥æ•°æ®æº--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jdbcTemplateId"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.core.JdbcTemplate"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSourceId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®dao --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userDaoId"</span> <span class="attr">class</span>=<span class="string">"com.springjdbc.c_dbcp.UserDao"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcTemplate"</span> <span class="attr">ref</span>=<span class="string">"jdbcTemplateId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-4-é…ç½®C3P0"><a href="#3-4-é…ç½®C3P0" class="headerlink" title="3.4 é…ç½®C3P0"></a>3.4 é…ç½®C3P0</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åˆ›å»ºæ•°æ®æº c3p0 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSourceId"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/ee19_spring_day02?characterEncoding=utf8&amp;useSSL=true"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"873383"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- åˆ›å»ºæ¨¡æ¿ ,éœ€è¦æ³¨å…¥æ•°æ®æº--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jdbcTemplateId"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.core.JdbcTemplate"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSourceId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®dao --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userDaoId"</span> <span class="attr">class</span>=<span class="string">"com.springjdbc.d_c3p0.UserDao"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcTemplate"</span> <span class="attr">ref</span>=<span class="string">"jdbcTemplateId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-5-ä½¿ç”¨-JdbcDaoSupport"><a href="#3-5-ä½¿ç”¨-JdbcDaoSupport" class="headerlink" title="3.5 ä½¿ç”¨ JdbcDaoSupport"></a>3.5 ä½¿ç”¨ JdbcDaoSupport</h3><h4 id="3-5-1-daoå±‚"><a href="#3-5-1-daoå±‚" class="headerlink" title="3.5.1 daoå±‚"></a>3.5.1 daoå±‚</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> <span class="keyword">extends</span> <span class="title">JdbcDaoSupport</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">		String sql = <span class="string">"update t_user set username=?,password=?, where id =?"</span>;</span><br><span class="line">		Object[] args = &#123;user.getUsername(),user.getPassword(),user.getId()&#125;;</span><br><span class="line">		<span class="keyword">this</span>.getJdbcTemplate().update(sql, args);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-5-2-é…ç½®properties"><a href="#3-5-2-é…ç½®properties" class="headerlink" title="3.5.2 é…ç½®properties"></a>3.5.2 é…ç½®properties</h4><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">jdbc.driverClass</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">jdbc.jdbcUrl</span>=<span class="string">jdbc:mysql://localhost:3306/ee19_spring_day02</span></span><br><span class="line"><span class="meta">jdbc.user</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">jdbc.password</span>=<span class="string">873383</span></span><br></pre></td></tr></table></figure>

<h4 id="3-5-3-Spring-é…ç½®æ–‡ä»¶"><a href="#3-5-3-Spring-é…ç½®æ–‡ä»¶" class="headerlink" title="3.5.3 Spring é…ç½®æ–‡ä»¶"></a>3.5.3 Spring é…ç½®æ–‡ä»¶</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åŠ è½½é…ç½®æ–‡ä»¶ </span></span><br><span class="line"><span class="comment">       "classpath:"å‰ç¼€è¡¨ç¤º srcä¸‹</span></span><br><span class="line"><span class="comment">	åœ¨é…ç½®æ–‡ä»¶ä¹‹åé€šè¿‡  $&#123;key&#125; è·å¾—å†…å®¹</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:com/springjdbc/e_jdbcdaosupport/jdbcInfo.properties"</span>/&gt;</span></span><br><span class="line">        </span><br><span class="line">   <span class="comment">&lt;!-- åˆ›å»ºæ•°æ®æº c3p0 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSourceId"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driverClass&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.jdbcUrl&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.user&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>  <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®dao </span></span><br><span class="line"><span class="comment">  *dao ç»§æ‰¿ JdbcDaoSupportï¼Œä¹‹ååªéœ€è¦æ³¨å…¥æ•°æ®æºï¼Œåº•å±‚å°†è‡ªåŠ¨åˆ›å»ºæ¨¡æ¿</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userDaoId"</span> <span class="attr">class</span>=<span class="string">"com.springjdbc.e_jdbcdaosupport.UserDao"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSourceId"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><ul>
<li><p>AOP ï¼šåˆ‡é¢ç¼–ç¨‹</p>
<p>åˆ‡é¢ï¼šåˆ‡å…¥ç‚¹ å’Œ é€šçŸ¥ ç»“åˆ</p>
</li>
<li><p>spring aop ç¼–ç¨‹</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">æ–¹æ³•1ï¼š</span><br><span class="line">  <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"</span> <span class="attr">id</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">aop:adisor</span>  <span class="attr">advice-ref</span>=<span class="string">"é€šçŸ¥å¼•ç”¨"</span> <span class="attr">pointcut-ref</span>=<span class="string">"åˆ‡å…¥ç‚¹çš„å¼•ç”¨"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">æ–¹æ³•2ï¼š</span><br><span class="line">   <span class="tag">&lt;<span class="name">aop:advisor</span>  <span class="attr">advice-ref</span>=<span class="string">"é€šçŸ¥å¼•ç”¨"</span> <span class="attr">pointcut</span>=<span class="string">"åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>AspectJ xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"åˆ‡é¢ç±»"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">aop:pointcut</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">aop:before</span>&gt;</span>  å‰ç½®</span><br><span class="line">     <span class="tag">&lt;<span class="name">aop:afterReturning</span>  <span class="attr">returning</span>=<span class="string">"ç¬¬äºŒä¸ªå‚æ•°åç§°"</span>&gt;</span> åç½®</span><br><span class="line">     <span class="tag">&lt;<span class="name">aop:around</span>&gt;</span> ç¯ç»•</span><br><span class="line">     <span class="tag">&lt;<span class="name">aop:afterThrowing</span> <span class="attr">throwing</span>=<span class="string">"ç¬¬äºŒã€‚ã€‚ã€‚"</span>&gt;</span> æŠ›å‡ºå¼‚å¸¸</span><br><span class="line">     <span class="tag">&lt;<span class="name">aop:after</span>&gt;</span> æœ€ç»ˆ</span><br></pre></td></tr></table></figure>

<ul>
<li><p>AspectJ annotation </p>
<p>â€‹    @Aspect</p>
<p>â€‹    @Pointcut(â€œè¡¨è¾¾å¼â€) private void xxx(){}</p>
<p>â€‹    @Before @â€¦</p>
</li>
<li><p>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</p>
</li>
</ul>
<p><code>&lt;aop:pointcut expression=&quot;execution(* com.itheima.crm.*.service..*.*(..))&quot; id=&quot;&quot;&gt;</code></p>
]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ©ç”¨Eurekaæ³¨å†Œä¸­å¿ƒåŠ¨æ€è·å–æœåŠ¡</title>
    <url>/2019/12/21/%E5%88%A9%E7%94%A8Eureka%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E6%9C%8D%E5%8A%A1/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>â€‹        åœ¨ä¸Šä¸€èŠ‚çš„å¾®æœåŠ¡åœºæ™¯æ¨¡æ‹Ÿä¸­ï¼Œå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>åœ¨consumerä¸­ï¼Œæˆ‘ä»¬æŠŠurlåœ°å€ç¡¬ç¼–ç åˆ°äº†ä»£ç ä¸­ï¼Œä¸æ–¹ä¾¿åæœŸç»´æŠ¤</li>
<li>consumeréœ€è¦è®°å¿†user-serviceçš„åœ°å€ï¼Œå¦‚æœå‡ºç°å˜æ›´ï¼Œå¯èƒ½å¾—ä¸åˆ°é€šçŸ¥ï¼Œåœ°å€å°†å¤±æ•ˆ</li>
<li>consumerä¸æ¸…æ¥šuser-serviceçš„çŠ¶æ€ï¼ŒæœåŠ¡å®•æœºä¹Ÿä¸çŸ¥é“</li>
<li>user-serviceåªæœ‰1å°æœåŠ¡ï¼Œä¸å…·å¤‡é«˜å¯ç”¨æ€§</li>
<li>å³ä¾¿user-serviceå½¢æˆé›†ç¾¤ï¼Œconsumerè¿˜éœ€è‡ªå·±å®ç°è´Ÿè½½å‡è¡¡</li>
</ul>
<p>å…¶å®ä¸Šé¢è¯´çš„é—®é¢˜ï¼Œæ¦‚æ‹¬ä¸€ä¸‹å°±æ˜¯åˆ†å¸ƒå¼æœåŠ¡å¿…ç„¶è¦é¢ä¸´çš„é—®é¢˜ï¼š</p>
<ul>
<li>æœåŠ¡ç®¡ç†<ul>
<li>å¦‚ä½•è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°</li>
<li>å¦‚ä½•å®ç°çŠ¶æ€ç›‘ç®¡</li>
<li>å¦‚ä½•å®ç°åŠ¨æ€è·¯ç”±</li>
</ul>
</li>
<li>æœåŠ¡å¦‚ä½•å®ç°è´Ÿè½½å‡è¡¡</li>
<li>æœåŠ¡å¦‚ä½•è§£å†³å®¹ç¾é—®é¢˜</li>
<li>æœåŠ¡å¦‚ä½•å®ç°ç»Ÿä¸€é…ç½®</li>
</ul>
<a id="more"></a>

<h3 id="ä¸€ã€Eurekaæ³¨å†Œä¸­å¿ƒ"><a href="#ä¸€ã€Eurekaæ³¨å†Œä¸­å¿ƒ" class="headerlink" title="ä¸€ã€Eurekaæ³¨å†Œä¸­å¿ƒ"></a>ä¸€ã€Eurekaæ³¨å†Œä¸­å¿ƒ</h3><h4 id="1-1-äº†è§£Eureka"><a href="#1-1-äº†è§£Eureka" class="headerlink" title="1.1 äº†è§£Eureka"></a>1.1 äº†è§£Eureka</h4><p>â€‹        Eurekaå°±åƒæ˜¯ä¸€ä¸ªä¸­ä»‹ï¼Œè´Ÿè´£ç®¡ç†ã€è®°å½•æœåŠ¡æä¾›è€…çš„ä¿¡æ¯ï¼ŒæœåŠ¡æä¾›è€…åœ¨è¿™ä¸ªä¸­å¿ƒä¸Šæ³¨å†Œè‡ªå·±æ‰€æä¾›çš„æœåŠ¡ï¼ŒEurekaè´Ÿè´£æ£€æµ‹è¿™ä¸ªæœåŠ¡æä¾›è€…æ˜¯å¦åœ¨æŒç»­çš„æä¾›æœåŠ¡ï¼Œå¦‚æœæ£€æµ‹åˆ°æœåŠ¡ç»ˆæ­¢ï¼Œé‚£ä¹ˆå°±ä¼šåœ¨æ³¨å†Œä¸­å¿ƒè¿›è¡Œæ³¨é”€ï¼ŒæœåŠ¡è°ƒç”¨è€…ä¹Ÿå°±ä¸ä¼šä½¿ç”¨åˆ°æ²¡æ³•æä¾›æœåŠ¡çš„æœåŠ¡å•†ï¼›åŒæ—¶ï¼ŒæœåŠ¡è°ƒç”¨è€…ä¹Ÿéœ€åœ¨ä¸­å¿ƒè¿›è¡Œæ³¨å†Œï¼ŒæŠŠè‡ªå·±çš„éœ€æ±‚å‘Šè¯‰Eurekaï¼Œç„¶åEurekaä¼šæŠŠè´Ÿè·ä½ éœ€æ±‚çš„æœåŠ¡å‘Šè¯‰ä½ ã€‚</p>
<p>â€‹        Eurekaå®ç°äº†æœåŠ¡çš„è‡ªåŠ¨æ³¨å†Œã€å‘ç°ã€çŠ¶æ€ç›‘æ§ã€‚</p>
<h4 id="1-2-ç¼–å†™EurekaServer"><a href="#1-2-ç¼–å†™EurekaServer" class="headerlink" title="1.2 ç¼–å†™EurekaServer"></a>1.2 ç¼–å†™EurekaServer</h4><p>â€‹        åˆ›å»ºmoduleï¼Œä»¥cloud-demoä¸ºçˆ¶å·¥ç¨‹ï¼Œæ·»åŠ ä¾èµ–ã€‚</p>
<ul>
<li>å­å·¥ç¨‹Eureka-serverçš„pom.xmlé…ç½®æ–‡ä»¶</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.nedlee.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- EurekaæœåŠ¡ç«¯ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¯åŠ¨ç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.nedlee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableEurekaServer</span><span class="comment">//æ³¨è§£æä¾›EurekaæœåŠ¡</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EurekaServer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(EurekaServer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>application.ymlé…ç½®æ–‡ä»¶</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">10086</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">eureka-server</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://127.0.0.1:10086/eureka</span></span><br></pre></td></tr></table></figure>

<h3 id="äºŒã€å°†user-serviceæ³¨å†Œåˆ°Eureka"><a href="#äºŒã€å°†user-serviceæ³¨å†Œåˆ°Eureka" class="headerlink" title="äºŒã€å°†user-serviceæ³¨å†Œåˆ°Eureka"></a>äºŒã€å°†user-serviceæ³¨å†Œåˆ°Eureka</h3><p>â€‹        æ³¨å†ŒæœåŠ¡ï¼Œå°±æ˜¯åœ¨æœåŠ¡ä¸Šæ·»åŠ Eurekaçš„å®¢æˆ·ç«¯ä¾èµ–ï¼Œå®¢æˆ·ç«¯ä»£ç ä¼šè‡ªåŠ¨æŠŠæœåŠ¡æ³¨å†Œåˆ°EurekaServerä¸­ã€‚</p>
<ul>
<li>åœ¨user-serviceå­å·¥ç¨‹çš„pom.xmlä¸­æ·»åŠ springcloudä¾èµ–</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.nedlee.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>user-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨å¯åŠ¨ç±»ä¸Šå¼€å¯Eurekaå®¢æˆ·ç«¯åŠŸèƒ½</p>
</blockquote>
<p>é€šè¿‡æ·»åŠ <code>@EnableDiscoveryClient</code>æ¥å¼€å¯Eurekaå®¢æˆ·ç«¯åŠŸèƒ½</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span> <span class="comment">// å¼€å¯EurekaClientåŠŸèƒ½</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceDemoApplication</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SpringApplication.run(UserServiceDemoApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>application.ymlæ–‡ä»¶é…ç½®</p>
</blockquote>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">user-service</span> <span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/leyou</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">873383</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">cn.nedlee.user.pojo</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span> <span class="comment"># EurekaServeråœ°å€</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://127.0.0.1:10086/eureka</span></span><br><span class="line">      <span class="attr">ip-address:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="comment"># æŒ‡å®šè‡ªå·±çš„ipä¿¡æ¯ï¼Œä¸æŒ‡å®šçš„è¯ä¼šè‡ªå·±å¯»æ‰¾</span></span><br></pre></td></tr></table></figure>

<h3 id="ä¸‰ã€æ¶ˆè´¹è€…ä»Eurekaè·å–æœåŠ¡"><a href="#ä¸‰ã€æ¶ˆè´¹è€…ä»Eurekaè·å–æœåŠ¡" class="headerlink" title="ä¸‰ã€æ¶ˆè´¹è€…ä»Eurekaè·å–æœåŠ¡"></a>ä¸‰ã€æ¶ˆè´¹è€…ä»Eurekaè·å–æœåŠ¡</h3><p>â€‹        æ–¹æ³•ä¸æœåŠ¡æä¾›è€…ç±»ä¼¼ï¼Œåªéœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ EurekaClientä¾èµ–ï¼Œå°±å¯ä»¥é€šè¿‡æœåŠ¡åç§°æ¥è·å–ä¿¡æ¯äº†ï¼</p>
<ul>
<li>åœ¨å­å·¥ç¨‹consumer-demoçš„pom.xmlä¸­æ·»åŠ springcloudä¾èµ–</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.nedlee.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>consumer-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨å¯åŠ¨ç±»å¼€å¯Eurekaå®¢æˆ·ç«¯</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span> <span class="comment">// å¼€å¯Eurekaå®¢æˆ·ç«¯</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserConsumerDemoApplication</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">restTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestTemplate(<span class="keyword">new</span> OkHttp3ClientHttpRequestFactory());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(UserConsumerDemoApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¿®æ”¹application.ymlé…ç½®æ–‡ä»¶</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8088</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">consumer</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://127.0.0.1:10086/eureka</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ä¿®æ”¹ä»£ç ï¼Œç”¨DiscoveryClientç±»çš„æ–¹æ³•ï¼Œæ ¹æ®æœåŠ¡åç§°ï¼Œè·å–æœåŠ¡å®ä¾‹ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.nedlee.consumer.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.nedlee.consumer.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.ServiceInstance;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.DiscoveryClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"consumer"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DiscoveryClient discoveryClient;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">queryById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Long id)</span>&#123;</span><br><span class="line">        <span class="comment">//æ ¹æ®æœåŠ¡idè·å–å®ä¾‹</span></span><br><span class="line">        List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(<span class="string">"user-service"</span>);</span><br><span class="line">        <span class="comment">//ä»å®ä¾‹ä¸­å–å‡ºipå’Œç«¯å£</span></span><br><span class="line">        <span class="comment">// å› ä¸ºåªæœ‰ä¸€ä¸ªUser-Service,å› æ­¤æˆ‘ä»¬ç›´æ¥get(0)è·å–</span></span><br><span class="line">        ServiceInstance instance = instances.get(<span class="number">0</span>);</span><br><span class="line">        String url = <span class="string">"http://"</span>+instance.getHost() + <span class="string">":"</span> +instance.getPort()+<span class="string">"/user/"</span> + id;</span><br><span class="line">        User user = restTemplate.getForObject(url,User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€‹        è‡³æ­¤ï¼ŒEurekaæ³¨å†Œä¸­å¿ƒçš„åŠŸèƒ½ä»¥åŸºæœ¬å®ç°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯Eurekaæ³¨å†Œä¸­å¿ƒä¹Ÿéœ€è¦å°†è‡ªå·±æ³¨å†Œåˆ°è¯¥ä¸­å¿ƒï¼Œä»¥@EurekaServerçš„æ–¹å¼å¼€å¯æœåŠ¡ï¼Œåœ¨ä¸­å¿ƒçš„æœåŠ¡æä¾›è€…ä¸è°ƒç”¨è€…éƒ½æ˜¯ä»¥@EurekaDiscoveryClientçš„æ–¹å¼å¼€å¯å®¢æˆ·ç«¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨@EurekaClientï¼Œä½†æ˜¯å‰è€…æ›´åŠ é€šç”¨ï¼Œå› ä¸ºæœåŠ¡ä¸­å¿ƒä¸æ­¢Eurekaè¿™ä¸€å®¶ã€‚</p>
]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ ã€springbootä¸springcloud</category>
      </categories>
      <tags>
        <tag>springcloud</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ©ç”¨SpringBootæ¨¡æ‹Ÿå¾®æœåŠ¡åœºæ™¯</title>
    <url>/2019/12/19/%E5%88%A9%E7%94%A8SpringBoot%E6%A8%A1%E6%8B%9F%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%9C%BA%E6%99%AF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€äº†è§£å¾®æœåŠ¡"><a href="#ä¸€ã€äº†è§£å¾®æœåŠ¡" class="headerlink" title="ä¸€ã€äº†è§£å¾®æœåŠ¡"></a>ä¸€ã€äº†è§£å¾®æœåŠ¡</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ"></a>1.1 ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ</h3><p>â€‹         å¾®æœåŠ¡æ¶æ„çš„ç³»ç»Ÿæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ç³»ç»Ÿï¼ŒæŒ‰ä¸šåŠ¡è¿›è¡Œåˆ’åˆ†ä¸ºç‹¬ç«‹çš„æœåŠ¡å•å…ƒï¼Œè§£å†³å•ä½“ç³»ç»Ÿçš„ä¸è¶³ï¼ŒåŒæ—¶ä¹Ÿæ»¡è¶³è¶Šæ¥è¶Šå¤æ‚çš„ä¸šåŠ¡éœ€æ±‚ã€‚ </p>
<p>â€‹        æ€»çš„æ¥è¯´å¾®æœåŠ¡å°±æ˜¯å°†ä¸€ä¸ªå•ä½“æ¶æ„çš„åº”ç”¨æŒ‰ä¸šåŠ¡åˆ’åˆ†ä¸ºä¸€ä¸ªä¸ªç‹¬ç«‹è¿è¡Œçš„ç¨‹åºå³æœåŠ¡ï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡HTTPåè®®è¿›è¡Œé€šä¿¡ï¼ˆä¹Ÿå¯ä»¥é‡‡ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ¥é€šä¿¡ï¼Œå¦‚ RoocketMQï¼ŒKafakaç­‰ ï¼‰ï¼Œå¯ä»¥é‡‡ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œä½¿ç”¨ä¸åŒçš„å­˜å‚¨æŠ€æœ¯ï¼Œè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼ˆå¦‚Jenkinsï¼‰å‡å°‘äººä¸ºæ§åˆ¶ï¼Œé™ä½å‡ºé”™æ¦‚ç‡ã€‚æœåŠ¡æ•°é‡è¶Šå¤šï¼Œç®¡ç†èµ·æ¥è¶Šå¤æ‚ï¼Œå› æ­¤é‡‡ç”¨é›†ä¸­åŒ–ç®¡ç†ã€‚ä¾‹å¦‚ Eurekaï¼ŒZookeeperç­‰éƒ½æ˜¯æ¯”è¾ƒå¸¸è§çš„æœåŠ¡é›†ä¸­åŒ–ç®¡ç†æ¡†æ¶ã€‚ </p>
<p><strong>å¾®æœåŠ¡çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å•ä¸€èŒè´£ï¼šå¾®æœåŠ¡ä¸­æ¯ä¸€ä¸ªæœåŠ¡éƒ½å¯¹åº”å”¯ä¸€çš„ä¸šåŠ¡èƒ½åŠ›ï¼Œåšåˆ°å•ä¸€èŒè´£</li>
<li>å¾®ï¼šå¾®æœåŠ¡çš„æœåŠ¡æ‹†åˆ†ç²’åº¦å¾ˆå°ï¼Œä¾‹å¦‚ä¸€ä¸ªç”¨æˆ·ç®¡ç†å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªæœåŠ¡ã€‚æ¯ä¸ªæœåŠ¡è™½å°ï¼Œä½†â€œäº”è„ä¿±å…¨â€ã€‚</li>
<li>é¢å‘æœåŠ¡ï¼šé¢å‘æœåŠ¡æ˜¯è¯´æ¯ä¸ªæœåŠ¡éƒ½è¦å¯¹å¤–æš´éœ²æœåŠ¡æ¥å£APIã€‚å¹¶ä¸å…³å¿ƒæœåŠ¡çš„æŠ€æœ¯å®ç°ï¼Œåšåˆ°ä¸å¹³å°å’Œè¯­è¨€æ— å…³ï¼Œä¹Ÿä¸é™å®šç”¨ä»€ä¹ˆæŠ€æœ¯å®ç°ï¼Œåªè¦æä¾›Restçš„æ¥å£å³å¯ã€‚</li>
<li>è‡ªæ²»ï¼šè‡ªæ²»æ˜¯è¯´æœåŠ¡é—´äº’ç›¸ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°<ul>
<li>å›¢é˜Ÿç‹¬ç«‹ï¼šæ¯ä¸ªæœåŠ¡éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¼€å‘å›¢é˜Ÿï¼Œäººæ•°ä¸èƒ½è¿‡å¤šã€‚</li>
<li>æŠ€æœ¯ç‹¬ç«‹ï¼šå› ä¸ºæ˜¯é¢å‘æœåŠ¡ï¼Œæä¾›Restæ¥å£ï¼Œä½¿ç”¨ä»€ä¹ˆæŠ€æœ¯æ²¡æœ‰åˆ«äººå¹²æ¶‰</li>
<li>å‰åç«¯åˆ†ç¦»ï¼šé‡‡ç”¨å‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œæä¾›ç»Ÿä¸€Restæ¥å£ï¼Œåç«¯ä¸ç”¨å†ä¸ºPCã€ç§»åŠ¨æ®µå¼€å‘ä¸åŒæ¥å£</li>
<li>æ•°æ®åº“åˆ†ç¦»ï¼šæ¯ä¸ªæœåŠ¡éƒ½ä½¿ç”¨è‡ªå·±çš„æ•°æ®æº</li>
<li>éƒ¨ç½²ç‹¬ç«‹ï¼ŒæœåŠ¡é—´è™½ç„¶æœ‰è°ƒç”¨ï¼Œä½†è¦åšåˆ°æœåŠ¡é‡å¯ä¸å½±å“å…¶å®ƒæœåŠ¡ã€‚æœ‰åˆ©äºæŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜ã€‚æ¯ä¸ªæœåŠ¡éƒ½æ˜¯ç‹¬ç«‹çš„ç»„ä»¶ï¼Œå¯å¤ç”¨ï¼Œå¯æ›¿æ¢ï¼Œé™ä½è€¦åˆï¼Œæ˜“ç»´æŠ¤</li>
</ul>
</li>
</ul>
<a id="more"></a>

<p><strong>å¾®æœåŠ¡ä¸SOA(é¢å‘æœåŠ¡)æ¯”è¾ƒ</strong></p>
<table>
<thead>
<tr>
<th align="center">å¾®æœåŠ¡</th>
<th align="center">SOA</th>
</tr>
</thead>
<tbody><tr>
<td align="center">èƒ½æ‹†åˆ†çš„å°±æ‹†åˆ†</td>
<td align="center">æ˜¯æ•´ä½“çš„ï¼ŒæœåŠ¡èƒ½æ”¾ä¸€èµ·çš„éƒ½æ”¾ä¸€èµ·</td>
</tr>
<tr>
<td align="center">çºµå‘ä¸šåŠ¡åˆ’åˆ†</td>
<td align="center">æ˜¯æ°´å¹³åˆ†å¤šå±‚</td>
</tr>
<tr>
<td align="center">ç”±å•ä¸€ç»„ç»‡è´Ÿè´£</td>
<td align="center">æŒ‰å±‚çº§åˆ’åˆ†ä¸åŒéƒ¨é—¨çš„ç»„ç»‡è´Ÿè´£</td>
</tr>
<tr>
<td align="center">ç»†ç²’åº¦</td>
<td align="center">ç²—ç²’åº¦</td>
</tr>
<tr>
<td align="center">ä¸¤å¥è¯å¯ä»¥è§£é‡Šæ˜ç™½</td>
<td align="center">å‡ ç™¾å­—åªç›¸å½“äºSOAçš„ç›®å½•</td>
</tr>
<tr>
<td align="center">ç‹¬ç«‹çš„å­å…¬å¸</td>
<td align="center">ç±»ä¼¼å¤§å…¬å¸é‡Œé¢åˆ’åˆ†äº†ä¸€äº›ä¸šåŠ¡å•å…ƒï¼ˆBUï¼‰</td>
</tr>
<tr>
<td align="center">ç»„ä»¶å°</td>
<td align="center">å­˜åœ¨è¾ƒå¤æ‚çš„ç»„ä»¶</td>
</tr>
<tr>
<td align="center">ä¸šåŠ¡é€»è¾‘å­˜åœ¨äºæ¯ä¸€ä¸ªæœåŠ¡ä¸­</td>
<td align="center">ä¸šåŠ¡é€»è¾‘æ¨ªè·¨å¤šä¸ªä¸šåŠ¡é¢†åŸŸ</td>
</tr>
<tr>
<td align="center">ä½¿ç”¨è½»é‡çº§çš„é€šä¿¡æ–¹å¼ï¼Œå¦‚HTTP</td>
<td align="center">ä¼ä¸šæœåŠ¡ç”Ÿäº§æ€»çº¿(ESB)å……å½“äº†æœåŠ¡ä¹‹é—´é€šä¿¡çš„è§’è‰²</td>
</tr>
</tbody></table>
<h3 id="1-2-è¿œç¨‹è°ƒç”¨æ–¹å¼"><a href="#1-2-è¿œç¨‹è°ƒç”¨æ–¹å¼" class="headerlink" title="1.2 è¿œç¨‹è°ƒç”¨æ–¹å¼"></a>1.2 è¿œç¨‹è°ƒç”¨æ–¹å¼</h3><p>æ— è®ºæ˜¯å¾®æœåŠ¡è¿˜æ˜¯SOAï¼Œéƒ½é¢ä¸´ç€æœåŠ¡é—´çš„è¿œç¨‹è°ƒç”¨ã€‚é‚£ä¹ˆæœåŠ¡é—´çš„è¿œç¨‹è°ƒç”¨æ–¹å¼æœ‰å“ªäº›å‘¢ï¼Ÿ</p>
<p>å¸¸è§çš„è¿œç¨‹è°ƒç”¨æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li><p>RPCï¼šRemote Produce Callè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œç±»ä¼¼çš„è¿˜æœ‰RMIã€‚è‡ªå®šä¹‰æ•°æ®æ ¼å¼ï¼ŒåŸºäºåŸç”ŸTCPé€šä¿¡ï¼Œé€Ÿåº¦å¿«ï¼Œæ•ˆç‡é«˜ã€‚æ—©æœŸçš„webserviceï¼Œç°åœ¨çƒ­é—¨çš„dubboï¼Œéƒ½æ˜¯RPCçš„å…¸å‹</p>
</li>
<li><p>Httpï¼šhttpå…¶å®æ˜¯ä¸€ç§ç½‘ç»œä¼ è¾“åè®®ï¼ŒåŸºäºTCPï¼Œè§„å®šäº†æ•°æ®ä¼ è¾“çš„æ ¼å¼ã€‚ç°åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸æœåŠ¡ç«¯é€šä¿¡åŸºæœ¬éƒ½æ˜¯é‡‡ç”¨Httpåè®®ã€‚ä¹Ÿå¯ä»¥ç”¨æ¥è¿›è¡Œè¿œç¨‹æœåŠ¡è°ƒç”¨ã€‚ç¼ºç‚¹æ˜¯æ¶ˆæ¯å°è£…è‡ƒè‚¿ã€‚</p>
<p>ç°åœ¨çƒ­é—¨çš„Resté£æ ¼ï¼Œå°±å¯ä»¥é€šè¿‡httpåè®®æ¥å®ç°ã€‚</p>
</li>
</ul>
<p>æœ¬æ¬¡æ¨¡æ‹Ÿä½¿ç”¨çš„æ˜¯Httpæ–¹å¼å®ç°è¿œç¨‹è°ƒç”¨ã€‚</p>
<h2 id="äºŒã€å¾®æœåŠ¡åœºæ™¯æ¨¡æ‹Ÿ"><a href="#äºŒã€å¾®æœåŠ¡åœºæ™¯æ¨¡æ‹Ÿ" class="headerlink" title="äºŒã€å¾®æœåŠ¡åœºæ™¯æ¨¡æ‹Ÿ"></a>äºŒã€å¾®æœåŠ¡åœºæ™¯æ¨¡æ‹Ÿ</h2><p>ç†è§£å­¦ä¹ å¾®æœåŠ¡æ¶æ„</p>
<h3 id="2-1-åˆ›å»ºçˆ¶å·¥ç¨‹"><a href="#2-1-åˆ›å»ºçˆ¶å·¥ç¨‹" class="headerlink" title="2.1 åˆ›å»ºçˆ¶å·¥ç¨‹"></a>2.1 åˆ›å»ºçˆ¶å·¥ç¨‹</h3><p>â€‹        çˆ¶å·¥ç¨‹çš„ä½œç”¨å°±æ˜¯å¯¹å­å·¥ç¨‹å„ç§ä¾èµ–çš„ç‰ˆæœ¬æ§åˆ¶å®ç°ç»Ÿä¸€çš„ç®¡ç†ï¼Œä»¥ä¾¿ç‰ˆæœ¬å‡çº§æ—¶æ–¹ä¾¿æ§åˆ¶ã€‚å¾®æœåŠ¡ä¸­éœ€è¦åŒæ—¶åˆ›å»ºå¤šä¸ªé¡¹ç›®ï¼Œåˆ›å»ºäº†çˆ¶å·¥ç¨‹ï¼Œåç»­çš„å·¥ç¨‹éƒ½ä»¥è¿™ä¸ªå·¥ç¨‹ä¸ºçˆ¶ï¼Œå®ç°mavençš„èšåˆã€‚è¿™æ ·å¯ä»¥åœ¨ä¸€ä¸ªçª—å£çœ‹åˆ°æ‰€æœ‰å·¥ç¨‹ã€‚<strong>åœ¨å®é™…å¼€å‘ä¸­ï¼Œåº”è¯¥æ¯ä¸ªå¾®æœåŠ¡ç‹¬ç«‹ä¸€ä¸ªå·¥ç¨‹</strong></p>
<ul>
<li><p>çˆ¶å·¥ç¨‹çš„pom.xmlé…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.nedlee.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>user-service<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>consumer-demo<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--çˆ¶ç±»å‹éƒ½ä¸ºpomç±»å‹ï¼Œpom é¡¹ç›®é‡Œæ²¡æœ‰javaä»£ç ï¼Œä¹Ÿä¸æ‰§è¡Œä»»ä½•ä»£ç ï¼Œåªæ˜¯ä¸ºäº†èšåˆå·¥ç¨‹æˆ–ä¼ é€’ä¾èµ–ç”¨çš„ã€‚--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>Finchley.SR1<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper.starter.version</span>&gt;</span>2.0.3<span class="tag">&lt;/<span class="name">mapper.starter.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>5.1.32<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é€šè¿‡&lt;properties&gt;å…ƒç´ ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªMavenå±æ€§ï¼Œ</span></span><br><span class="line"><span class="comment">    ç„¶ååœ¨POMçš„å…¶ä»–åœ°æ–¹ä½¿ç”¨$&#123;å±æ€§å&#125;çš„æ–¹å¼å¼•ç”¨è¯¥å±æ€§ï¼Œè¿™ç§åšæ³•çš„æœ€å¤§æ„ä¹‰åœ¨äºæ¶ˆé™¤é‡å¤å’Œç»Ÿä¸€ç®¡ç†ã€‚--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--åœ¨&lt;dependencyManagement&gt;é‡Œçš„ä¾èµ–æ‰€æœ‰å­å·¥ç¨‹éƒ½éœ€è¦æ‰‹åŠ¨å¼•å…¥ï¼Œæ²¡åœ¨è¿™é‡Œé¢çš„å°±éƒ½ä¼šæœ‰è¿™ä¸ªä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springCloud--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é€šç”¨mapperå¯åŠ¨å™¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mapper.starter.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--Spring Bootçš„Mavenæ’ä»¶ï¼Œèƒ½å¤Ÿä»¥Mavençš„æ–¹å¼ä¸ºåº”ç”¨æä¾›Spring Bootçš„æ”¯æŒï¼Œ</span></span><br><span class="line"><span class="comment">                å³ä¸ºSpring Bootåº”ç”¨æä¾›äº†æ‰§è¡ŒMavenæ“ä½œçš„å¯èƒ½ã€‚--&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="2-2-æœåŠ¡æä¾›è€…"><a href="#2-2-æœåŠ¡æä¾›è€…" class="headerlink" title="2.2 æœåŠ¡æä¾›è€…"></a>2.2 æœåŠ¡æä¾›è€…</h3><p>æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå¯¹å¤–æä¾›æŸ¥è¯¢ç”¨æˆ·çš„æœåŠ¡ã€‚</p>
<h4 id="2-2-1-åˆ›å»ºmodule"><a href="#2-2-1-åˆ›å»ºmodule" class="headerlink" title="2.2.1 åˆ›å»ºmodule"></a>2.2.1 åˆ›å»ºmodule</h4><ul>
<li>åœ¨åˆ›å»ºå­å·¥ç¨‹æ—¶è¦é€‰ä¸­çˆ¶å·¥ç¨‹</li>
<li>æœåŠ¡æä¾›è€…çš„pom.xmlé…ç½®æ–‡ä»¶</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.nedlee.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>user-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>tk.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å­å·¥ç¨‹ä¸­çš„application.ymlé…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶åä¸ºapplicationï¼ŒSpringä¼šåœ¨æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨æ‰«æè¯¥é…ç½®æ–‡ä»¶ï¼Œåœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­é…ç½®äº†è¿æ¥æ•°æ®æºï¼Œæ•°æ®è®¿é—®çš„ç«¯å£å·ï¼Œä»¥åŠæŒ‡å®šPOJOæ‰«æåŒ…æ¥è®©mybatisè‡ªåŠ¨æ‰«æåˆ°è‡ªå®šä¹‰POJO( Plain Ordinary Java Object -&gt;ç®€å•çš„javaå¯¹è±¡)ï¼Œè¿˜å¯ä»¥çµæ´»é…ç½®è®¸å¤šå…¶ä»–æ¡ä»¶ã€‚</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/leyou</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">8733</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">cn.nedlee.user.pojo</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¯åŠ¨ç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan</span>(<span class="string">"cn.nedlee.user.mapper"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(UserApplication<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*@SpringBootApplicationå…¶å®å°±æ˜¯ä»¥ä¸‹ä¸‰ä¸ªæ³¨è§£çš„æ€»å’Œ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">@Configurationï¼šÂ ç”¨äºå®šä¹‰ä¸€ä¸ªé…ç½®ç±»</span></span><br><span class="line"><span class="comment">è¿™ä¸ªæ³¨è§£çš„ä½œç”¨ä¸@Configurationä½œç”¨ç›¸åŒï¼Œéƒ½</span></span><br><span class="line"><span class="comment">æ˜¯ç”¨æ¥å£°æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼å¯ä»¥é€šè¿‡ï¼ Beanæ³¨è§£ç”ŸæˆIOCå®¹å™¨ç®¡ç†çš„bean.</span></span><br><span class="line"><span class="comment">åœ¨QuickStartApplicationä¸­å®šä¹‰beanï¼Œå¹¶åœ¨ï¼ HelloControllerä¸­æ³¨å…¥ä½¿ç”¨</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">@EnableAutoConfigurationÂ ï¼šSpring Bootä¼šè‡ªåŠ¨æ ¹æ®ä½ jaråŒ…çš„ä¾èµ–æ¥è‡ªåŠ¨é…ç½®é¡¹ç›®ã€‚</span></span><br><span class="line"><span class="comment">@EnableAutoConfigurationæ˜¯springbootå®ç°è‡ªåŠ¨åŒ–é…ç½®çš„æ ¸å¿ƒæ³¨è§£ï¼Œé€šè¿‡è¿™ä¸ªæ³¨è§£æŠŠspringåº”ç”¨æ‰€éœ€çš„beanæ³¨å…¥å®¹å™¨ä¸­ï¼</span></span><br><span class="line"><span class="comment">@EnableAutoConfigurationæºç é€šè¿‡@Importæ³¨å…¥äº†ä¸€ä¸ªImportSelectorçš„å®ç°ç±»</span></span><br><span class="line"><span class="comment">AutoConfigurationImportSelector,è¿™ä¸ªImportSelectoræœ€ç»ˆå®ç°æ ¹æ®æˆ‘ä»¬çš„é…ç½®ï¼ŒåŠ¨æ€åŠ è½½æ‰€éœ€çš„bean.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">@ComponentScanï¼š å‘Šè¯‰Spring å“ªä¸ªpackages çš„ç”¨æ³¨è§£æ ‡è¯†çš„ç±» ä¼šè¢«springè‡ªåŠ¨æ‰«æå¹¶ä¸”è£…å…¥beanå®¹å™¨ã€‚</span></span><br><span class="line"><span class="comment">springé‡Œæœ‰å››å¤§æ³¨è§£ï¼š@Service,@Repository,@Component,@Controllerç”¨æ¥å®šä¹‰ä¸€ä¸ªbean.</span></span><br><span class="line"><span class="comment">@ComponentScanæ³¨è§£å°±æ˜¯ç”¨æ¥è‡ªåŠ¨æ‰«æè¢«è¿™äº›æ³¨è§£æ ‡è¯†çš„ç±»ï¼Œæœ€ç»ˆç”Ÿæˆiocå®¹å™¨é‡Œçš„beanï¼</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å®ä½“ç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Table</span>(name = <span class="string">"tb_user"</span>)</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@KeySql</span>(useGeneratedKeys = <span class="keyword">true</span>)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;<span class="comment">// ç”¨æˆ·å</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String password;<span class="comment">// å¯†ç </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;<span class="comment">// å§“å</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;<span class="comment">// å¹´é¾„</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer sex;<span class="comment">// æ€§åˆ«ï¼Œ1ç”·æ€§ï¼Œ2å¥³æ€§</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date birthday;<span class="comment">// å‡ºç”Ÿæ—¥æœŸ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date created;<span class="comment">// åˆ›å»ºæ—¶é—´</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date updated;<span class="comment">// æ›´æ–°æ—¶é—´</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String note;<span class="comment">// å¤‡æ³¨</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ã€‚ã€‚ã€‚çœç•¥getterså’Œsetters</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">@Tableæ³¨è§£  ä½œç”¨æ˜¯ ï¼š å£°æ˜æ­¤å¯¹è±¡æ˜ å°„åˆ°æ•°æ®åº“çš„æ•°æ®è¡¨ï¼Œé€šè¿‡å®ƒå¯ä»¥ä¸ºå®ä½“æŒ‡å®šè¡¨(talbe)</span></span><br><span class="line"><span class="comment">@Dataæ³¨è§£   ä½œç”¨æ˜¯ ï¼š å¸®ä½ çš„ç±»æä¾›äº†getXxx()ã€setXxx()æ–¹æ³•ã€equals()ã€hashCode()ã€toString() è¿™äº›æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´åªè¦ä½ çš„ç±»ä¸Šå†™äº†è¿™ä¸ªæ³¨è§£ï¼Œé‚£å°±ä¸éœ€è¦å†ç”Ÿæˆgetã€setã€toStringç­‰æ–¹æ³•äº†ã€‚</span></span><br><span class="line"><span class="comment">@Idæ³¨è§£  ä½œç”¨æ˜¯ ï¼š ç¡®å®šè¯¥å­—æ®µä¸ºæ•°æ®åº“ä¸­çš„ä¸»é”®</span></span><br><span class="line"><span class="comment">@KeySql(useGeneratedKeys = true)æ³¨è§£  ä½œç”¨æ˜¯ ï¼š ä½¿ç”¨ JDBC çš„æ–¹å¼è·å–æ•°æ®åº“è‡ªå¢çš„ä¸»é”®å€¼ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>mapper</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.nedlee.user.pojo.User;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.common.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*è¿™é‡Œç»§æ‰¿äº† tk.mybatis.mapper.common.Mapper æ¥å£ï¼Œåœ¨æ¥å£ä¸ŠæŒ‡å®šäº†æ³›å‹ç±»å‹ Userã€‚å½“ä½ ç»§æ‰¿äº† Mapper æ¥å£åï¼Œæ­¤æ—¶å°±å·²ç»æœ‰äº†é’ˆå¯¹ User çš„å¤§é‡æ–¹æ³•ï¼ŒåŒ…æ‹¬å¯¹å•è¡¨ç®€å•çš„å¢åˆ æ”¹æŸ¥ï¼Œæ‰€ä»¥å°±å¯ä»¥ä¸å†™æ•°æ®åº“è¯­å¥äº†*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>service</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.nedlee.user.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> cn.nedlee.user.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">queryById</span><span class="params">(<span class="keyword">long</span> id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.selectByPrimaryKey(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">@Serviceæ³¨è§£ï¼šå£°æ˜UserServiceæ˜¯ä¸€ä¸ªBeanï¼Œè¿™ä¸ªæ³¨è§£æ˜¯å†™åœ¨ç±»ä¸Šé¢çš„ï¼Œæ ‡æ³¨å°†è¿™ä¸ªç±»äº¤ç»™Springå®¹å™¨ç®¡ç†ï¼Œspringå®¹å™¨è¦ä¸ºä»–åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="comment">@Autowiredæ³¨è§£:å½“Springå‘ç°@Autowiredæ³¨è§£æ—¶ï¼Œå°†è‡ªåŠ¨åœ¨ä»£ç ä¸Šä¸‹æ–‡ä¸­æ‰¾åˆ°å’Œå…¶åŒ¹é…ï¼ˆé»˜è®¤æ˜¯ç±»å‹åŒ¹é…ï¼‰çš„Beanï¼Œå¹¶è‡ªåŠ¨æ³¨å…¥åˆ°ç›¸åº”çš„åœ°æ–¹å»ã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ·»åŠ ä¸€ä¸ªå¯¹å¤–æŸ¥è¯¢çš„æ¥å£</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.nedlee.user.pojo.User;</span><br><span class="line"><span class="keyword">import</span> cn.nedlee.user.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"user"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">queryById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Long id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.queryById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">@RestController = @Controller + @ResponseBodyç»„æˆ</span></span><br><span class="line"><span class="comment">@Controller å°†å½“å‰ä¿®é¥°çš„ç±»æ³¨å…¥SpringBoot IOCå®¹å™¨ï¼Œä½¿å¾—ä»è¯¥ç±»æ‰€åœ¨çš„é¡¹ç›®è·‘èµ·æ¥çš„è¿‡ç¨‹ä¸­ï¼Œè¿™ä¸ªç±»å°±è¢«å®ä¾‹åŒ–ã€‚å½“ç„¶ä¹Ÿæœ‰è¯­ä¹‰åŒ–çš„ä½œç”¨ï¼Œå³ä»£è¡¨è¯¥ç±»æ˜¯å……å½“Controllerçš„ä½œç”¨</span></span><br><span class="line"><span class="comment">@ResponseBody å®ƒçš„ä½œç”¨ç®€çŸ­æˆªè¯´å°±æ˜¯æŒ‡è¯¥ç±»ä¸­æ‰€æœ‰çš„APIæ¥å£è¿”å›çš„æ•°æ®ï¼Œç”­ç®¡ä½ å¯¹åº”çš„æ–¹æ³•è¿”å›Mapæˆ–æ˜¯å…¶ä»–Objectï¼Œå®ƒä¼šä»¥Jsonå­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ç»™å®¢æˆ·ç«¯.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">@RequestMapping("user")æ³¨è§£ï¼Œæ¸¸è§ˆå™¨è®¿é—®userçš„è¯·æ±‚ä¼šè¢«userControllerç±»çš„queryById()æ–¹æ³•å¤„ç†ã€‚</span></span><br><span class="line"><span class="comment">@GetMapping("/&#123;id&#125;")æ³¨è§£ï¼Œå¾—åˆ°URLä¸­çš„è¯·æ±‚å‚æ•°ï¼Œå¹¶é€šè¿‡ @PathVariable å¯ä»¥å°†URLä¸­å ä½ç¬¦å‚æ•°&#123;id&#125;ç»‘å®šåˆ°å¤„ç†å™¨ç±»çš„æ–¹æ³•å½¢å‚ä¸­ï¼Œ</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æµ‹è¯•</li>
</ul>
<p>è®¿é—®ï¼š(<a href="http://localhost:8081/user/9)ä¼šæŸ¥è¯¢ä¸€ä¸ªç»“æœæ‰“å°åœ¨æ¸¸è§ˆå™¨ä¸Šã€‚" target="_blank" rel="noopener">http://localhost:8081/user/9)ä¼šæŸ¥è¯¢ä¸€ä¸ªç»“æœæ‰“å°åœ¨æ¸¸è§ˆå™¨ä¸Šã€‚</a></p>
<h3 id="2-3-æœåŠ¡è°ƒç”¨è€…"><a href="#2-3-æœåŠ¡è°ƒç”¨è€…" class="headerlink" title="2.3 æœåŠ¡è°ƒç”¨è€…"></a>2.3 æœåŠ¡è°ƒç”¨è€…</h3><h4 id="2-3-1-åˆ›å»ºå·¥ç¨‹"><a href="#2-3-1-åˆ›å»ºå·¥ç¨‹" class="headerlink" title="2.3.1 åˆ›å»ºå·¥ç¨‹"></a>2.3.1 åˆ›å»ºå·¥ç¨‹</h4><p>ä¸ä¸Šé¢ç±»ä¼¼ï¼Œåˆ›å»ºmoduleï¼Œé€‰ä¸­çˆ¶å·¥ç¨‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤å·¥ç¨‹è°ƒç”¨çš„æ˜¯user-serviceçš„åŠŸèƒ½ï¼Œå› æ­¤ä¸éœ€è¦mybatisçš„ç›¸å…³ä¾èµ–äº†ã€‚</p>
<ul>
<li>æœåŠ¡è°ƒç”¨è€…consumer-demoçš„pom.xmlé…ç½®æ–‡ä»¶</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.nedlee.demo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>consumer-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¯åŠ¨ç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">restTemplate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestTemplate();<span class="comment">//å®ç°æœåŠ¡ä¹‹é—´çš„è°ƒç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ConsumerApplication<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å®ä½“ç±»</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;<span class="comment">// ç”¨æˆ·å</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String password;<span class="comment">// å¯†ç </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;<span class="comment">// å§“å</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;<span class="comment">// å¹´é¾„</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer sex;<span class="comment">// æ€§åˆ«ï¼Œ1ç”·æ€§ï¼Œ2å¥³æ€§</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date birthday;<span class="comment">// å‡ºç”Ÿæ—¥æœŸ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date created;<span class="comment">// åˆ›å»ºæ—¶é—´</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date updated;<span class="comment">// æ›´æ–°æ—¶é—´</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String note;<span class="comment">// å¤‡æ³¨</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ã€‚ã€‚ã€‚çœç•¥getterså’Œsetters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¼–å†™controllerï¼Œåœ¨controllerä¸­ç›´æ¥è°ƒç”¨RestTemplateï¼Œè¿œç¨‹è®¿é—®user-serviceçš„æœåŠ¡æ¥å£ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"consumer"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">queryById</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Long id)</span>&#123;</span><br><span class="line">        String url = <span class="string">"http://localhost:8081/user/"</span> + id;</span><br><span class="line">        User user = restTemplate.getForObject(url,User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-æ€»ç»“"><a href="#2-4-æ€»ç»“" class="headerlink" title="2.4 æ€»ç»“"></a>2.4 æ€»ç»“</h3><p>â€‹        é¦–å…ˆåˆ›å»ºçš„æ˜¯çˆ¶å·¥ç¨‹ï¼Œåœ¨çˆ¶å·¥ç¨‹çš„pomé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œæ•´ä½“çš„ä¾èµ–ç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹äºå­å·¥ç¨‹æ‰€éœ€çš„ä¾èµ–ï¼Œå¯ä»¥ä»çˆ¶å·¥ç¨‹ä¸­è¿›è¡Œå¼•å…¥ã€‚ä¹‹ååœ¨çˆ¶å·¥ç¨‹ä¸‹åˆ›å»ºmoduleå·¥ç¨‹ä¸€(user-service)æœåŠ¡æä¾›è€…ï¼Œåœ¨è¿™ä¸ªå·¥ç¨‹ä¸­éœ€è¦è¿›è¡Œå¯¹æ•°æ®åº“çš„è®¿é—®ï¼Œæ‰€ä»¥è¦å¼•å…¥mybatisçš„ä¾èµ–ã€‚åœ¨user-serviceå·¥ç¨‹ä¸­ï¼Œé¦–å…ˆè¦ç¼–å†™çš„æ˜¯å¯åŠ¨ç±»ï¼Œæ¥ç€æ˜¯å®ä½“ç±»ï¼Œç”¨äºæ¥æ”¶ä»æ•°æ®åº“ä¸­æŸ¥è¯¢åˆ°çš„ç›¸åº”æ•°æ®ï¼Œ@tableæ³¨è§£å°±æ˜¯ç”¨æ¥æŒ‡å®šåœ¨æ•°æ®åº“ä¸­çš„å“ªå¼ è¡¨å¯¹åº”äºè¯¥å®ä½“ç±»ã€‚æ¥ç€å°±æ˜¯mapperæ¥å£ä¸serviceï¼Œåœ¨mapperä¸­å®šä¹‰äº†ä¸€ä¸ªUserMapperæ¥å£ï¼Œç»§æ‰¿äº†é€šç”¨mybatisçš„mapperï¼Œæ³›å‹ä¸ºUserï¼Œspringå°±æ ¹æ®è¯¥æ³›å‹å®šä¹‰äº†è®¸å¤šé’ˆå¯¹å•è¡¨çš„æ•°æ®åº“è¯­å¥ï¼Œæ‰€ä»¥åœ¨è¯¥mapperä¸­æ— éœ€ç¼–å†™æ•°æ®åº“è¯­å¥ï¼Œè¦ç”¨çš„æ—¶å€™ï¼Œä¾‹å¦‚åœ¨serviceä¸­ï¼Œç›´æ¥æ³¨å…¥ä¸è°ƒç”¨å³å¯ã€‚æœ€åå°±æ˜¯ç¼–å†™ä¸€ä¸ªå¯¹å®ŒæŸ¥è¯¢çš„æ¥å£ï¼Œå®ç°å½“æ¸¸è§ˆå™¨è®¿é—®ç›¸åº”èµ„æºæ—¶ï¼Œè°ƒç”¨ç›¸åº”çš„æ–¹æ³•ï¼Œè¿”å›ç›¸åº”çš„å€¼ç»™æ¸¸è§ˆå™¨ã€‚å¯¹äºæœåŠ¡çš„è°ƒç”¨è€…ï¼Œä¸æœåŠ¡çš„æä¾›è€…ä¸€æ ·ï¼Œç°åœ¨çˆ¶å·¥ç¨‹ä¸‹åˆ›å»ºmoduleå·¥ç¨‹(consumer-demo)æœåŠ¡è°ƒç”¨è€…ï¼Œé¦–å…ˆç¼–å†™å¯åŠ¨ç±»ï¼Œæ¥ç€ç¼–å†™å®ä½“ç±»ï¼Œåªæ˜¯ç”¨æ¥æ¥æ”¶æŸ¥è¯¢åˆ°çš„ç›¸å…³çš„æ•°æ®ï¼Œå¹¶ä¸ä½œæŸ¥è¯¢æ•°æ®åº“ä¹‹ç”¨ï¼Œå†ç¼–å†™ä¸€ä¸ªå¯¹å¤–æŸ¥è¯¢çš„æ¥å£ï¼Œæ³¨å…¥Restemplateï¼Œå®ç°æœåŠ¡é—´çš„è°ƒç”¨ã€‚</p>
]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>SpringBoot</tag>
      </tags>
  </entry>
  <entry>
    <title>éšç¬”</title>
    <url>/2019/11/24/%E9%9A%8F%E7%AC%94/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script>]]></content>
      <categories>
        <category>file</category>
      </categories>
      <tags>
        <tag>éšç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaé”çš„ç§ç±»ä»¥åŠè¾¨æ</title>
    <url>/2020/05/12/Java%E9%94%81%E7%9A%84%E7%A7%8D%E7%B1%BB%E4%BB%A5%E5%8F%8A%E8%BE%A8%E6%9E%90/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h5 id="é”ä½œä¸ºå¹¶å‘å…±äº«æ•°æ®ï¼Œä¿è¯ä¸€è‡´æ€§çš„å·¥å…·ï¼Œåœ¨JAVAå¹³å°æœ‰å¤šç§å®ç°-å¦‚-synchronized-å’Œ-ReentrantLockç­‰ç­‰-ã€‚è¿™äº›å·²ç»å†™å¥½æä¾›çš„é”ä¸ºæˆ‘ä»¬å¼€å‘æä¾›äº†ä¾¿åˆ©ã€‚"><a href="#é”ä½œä¸ºå¹¶å‘å…±äº«æ•°æ®ï¼Œä¿è¯ä¸€è‡´æ€§çš„å·¥å…·ï¼Œåœ¨JAVAå¹³å°æœ‰å¤šç§å®ç°-å¦‚-synchronized-å’Œ-ReentrantLockç­‰ç­‰-ã€‚è¿™äº›å·²ç»å†™å¥½æä¾›çš„é”ä¸ºæˆ‘ä»¬å¼€å‘æä¾›äº†ä¾¿åˆ©ã€‚" class="headerlink" title="é”ä½œä¸ºå¹¶å‘å…±äº«æ•°æ®ï¼Œä¿è¯ä¸€è‡´æ€§çš„å·¥å…·ï¼Œåœ¨JAVAå¹³å°æœ‰å¤šç§å®ç°(å¦‚ synchronized å’Œ ReentrantLockç­‰ç­‰ ) ã€‚è¿™äº›å·²ç»å†™å¥½æä¾›çš„é”ä¸ºæˆ‘ä»¬å¼€å‘æä¾›äº†ä¾¿åˆ©ã€‚"></a>é”ä½œä¸ºå¹¶å‘å…±äº«æ•°æ®ï¼Œä¿è¯ä¸€è‡´æ€§çš„å·¥å…·ï¼Œåœ¨JAVAå¹³å°æœ‰å¤šç§å®ç°(å¦‚ synchronized å’Œ ReentrantLockç­‰ç­‰ ) ã€‚è¿™äº›å·²ç»å†™å¥½æä¾›çš„é”ä¸ºæˆ‘ä»¬å¼€å‘æä¾›äº†ä¾¿åˆ©ã€‚</h5><p>1ã€è‡ªæ—‹é” ,è‡ªæ—‹ï¼Œjvmé»˜è®¤æ˜¯10æ¬¡å§ï¼Œæœ‰jvmè‡ªå·±æ§åˆ¶ã€‚forå»äº‰å–é”</p>
<p>2ã€é˜»å¡é” è¢«é˜»å¡çš„çº¿ç¨‹ï¼Œä¸ä¼šäº‰å¤ºé”ã€‚</p>
<p>3ã€å¯é‡å…¥é” å¤šæ¬¡è¿›å…¥æ”¹é”çš„åŸŸ</p>
<p>4ã€è¯»å†™é”</p>
<p>5ã€äº’æ–¥é” é”æœ¬èº«å°±æ˜¯äº’æ–¥çš„</p>
<p>6ã€æ‚²è§‚é” ä¸ç›¸ä¿¡ï¼Œè¿™é‡Œä¼šæ˜¯å®‰å…¨çš„ï¼Œå¿…é¡»å…¨éƒ¨ä¸Šé”</p>
<p>7ã€ä¹è§‚é” ç›¸ä¿¡ï¼Œè¿™é‡Œæ˜¯å®‰å…¨çš„ã€‚</p>
<p>8ã€å…¬å¹³é” æœ‰ä¼˜å…ˆçº§çš„é”</p>
<p>9ã€éå…¬å¹³é” æ— ä¼˜å…ˆçº§çš„é”</p>
<p>10ã€åå‘é” æ— ç«äº‰ä¸é”ï¼Œæœ‰ç«äº‰æŒ‚èµ·ï¼Œè½¬ä¸ºè½»é‡é”</p>
<p>11ã€å¯¹è±¡é” é”ä½å¯¹è±¡</p>
<p>12ã€çº¿ç¨‹é”</p>
<p>13ã€é”ç²—åŒ– å¤šé”å˜æˆä¸€ä¸ªï¼Œè‡ªå·±å¤„ç†</p>
<p>14ã€è½»é‡çº§é” CAS å®ç°</p>
<p>15ã€é”æ¶ˆé™¤ åå‘é”å°±æ˜¯é”æ¶ˆé™¤çš„ä¸€ç§</p>
<p>16ã€é”è†¨èƒ€ jvmå®ç°ï¼Œé”ç²—åŒ–</p>
<p>17ã€ä¿¡å·é‡ ä½¿ç”¨é˜»å¡é” å®ç°çš„ä¸€ç§ç­–ç•¥</p>
<p>18ã€æ’å®ƒé”ï¼šXé”ï¼Œè‹¥äº‹åŠ¡Tå¯¹æ•°æ®å¯¹è±¡AåŠ ä¸ŠXé”ï¼Œåˆ™åªå…è®¸Tè¯»å–å’Œä¿®æ”¹Aï¼Œå…¶ä»–ä»»ä½•äº‹åŠ¡éƒ½ä¸èƒ½å†å¯¹AåŠ ä»»ä½•ç±»å‹çš„é”ï¼Œç›´åˆ°Té‡Šæ”¾Aä¸Šçš„é”ã€‚è¿™å°±ä¿è¯äº†å…¶ä»–äº‹åŠ¡åœ¨Té‡Šæ”¾Aä¸Šçš„é”ä¹‹å‰ä¸èƒ½å†è¯»å–å’Œä¿®æ”¹Aã€‚</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>Sleepå’Œwaitçš„åŒºåˆ«</title>
    <url>/2020/05/15/Sleep%E5%92%8Cwait%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h4 id="Sleepå’Œwaitçš„åŒºåˆ«"><a href="#Sleepå’Œwaitçš„åŒºåˆ«" class="headerlink" title="Sleepå’Œwaitçš„åŒºåˆ«"></a>Sleepå’Œwaitçš„åŒºåˆ«</h4><h5 id="1-æ‰€å±çš„ç±»ä¸åŒ"><a href="#1-æ‰€å±çš„ç±»ä¸åŒ" class="headerlink" title="1.æ‰€å±çš„ç±»ä¸åŒ"></a>1.æ‰€å±çš„ç±»ä¸åŒ</h5><p>sleepæ–¹æ³•æ˜¯å®šä¹‰åœ¨Threadä¸Šçš„</p>
<p>waitæ–¹æ³•æ˜¯å®šä¹‰åœ¨objectä¸Šçš„</p>
<h5 id="2-å¯¹äºé”èµ„æºçš„å¤„ç†æ–¹å¼ä¸åŒ"><a href="#2-å¯¹äºé”èµ„æºçš„å¤„ç†æ–¹å¼ä¸åŒ" class="headerlink" title="2.å¯¹äºé”èµ„æºçš„å¤„ç†æ–¹å¼ä¸åŒ"></a>2.å¯¹äºé”èµ„æºçš„å¤„ç†æ–¹å¼ä¸åŒ</h5><p>sleepä¸ä¼šé‡Šæ”¾é”ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥èµ„æºè¿˜æ˜¯åœ¨å½“å‰æ–¹æ³•ä¸Šï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®å…¶èµ„æº</p>
<p>waitä¼šé‡Šæ”¾é”ï¼Œè°ƒç”¨waitåï¼Œå…¶ä»–çº¿ç¨‹å¯è®¿é—®å…ˆå‰è¢«é”ä½çš„èµ„æº</p>
<h5 id="3-ä½¿ç”¨èŒƒå›´ä¸åŒ"><a href="#3-ä½¿ç”¨èŒƒå›´ä¸åŒ" class="headerlink" title="3.ä½¿ç”¨èŒƒå›´ä¸åŒ"></a>3.ä½¿ç”¨èŒƒå›´ä¸åŒ</h5><p>sleepå¯ä»¥ä½¿ç”¨åœ¨ä»»ä½•ä»£ç å—</p>
<p>waitå¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥ä»£ç å—æ‰§è¡Œ</p>
<h5 id="4-ä¸waité…å¥—ä½¿ç”¨çš„æ–¹æ³•"><a href="#4-ä¸waité…å¥—ä½¿ç”¨çš„æ–¹æ³•" class="headerlink" title="4.ä¸waité…å¥—ä½¿ç”¨çš„æ–¹æ³•"></a>4.ä¸waité…å¥—ä½¿ç”¨çš„æ–¹æ³•</h5><ul>
<li>void notify()</li>
</ul>
<p>ä½œç”¨ï¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹</p>
<ul>
<li>void notifyall()</li>
</ul>
<p>ä½œç”¨ï¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹</p>
<ul>
<li>void wait() </li>
</ul>
<p>ä½œç”¨ï¼šå¯¼è‡´å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„notify()æ–¹æ³•æˆ–notifyall()æ–¹æ³•</p>
<h5 id="5-ç”Ÿå‘½å‘¨æœŸ"><a href="#5-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="5.ç”Ÿå‘½å‘¨æœŸ"></a>5.ç”Ÿå‘½å‘¨æœŸ</h5><p>(1)å½“çº¿ç¨‹è°ƒç”¨wait()æˆ–è€…joinæ—¶ï¼Œçº¿ç¨‹éƒ½ä¼šè¿›å…¥åˆ°waitingçŠ¶æ€ï¼Œå½“è°ƒç”¨notifyæˆ–notifyallæ—¶ï¼Œæˆ–è€…joinçš„çº¿ç¨‹æ‰§è¡Œç»“æŸåï¼Œä¼šè¿›å…¥runnableçŠ¶æ€</p>
<p>(2)å½“çº¿ç¨‹è°ƒç”¨sleep(time)ï¼Œæˆ–è€…wait(time)æ—¶ï¼Œè¿›å…¥time waitingçŠ¶æ€</p>
<h5 id="6-ä¸ºä»€ä¹ˆwaitè¦å®šä¹‰åœ¨objectä¸­ï¼Œè€Œä¸å®šä¹‰åœ¨threadä¸­ï¼Ÿ"><a href="#6-ä¸ºä»€ä¹ˆwaitè¦å®šä¹‰åœ¨objectä¸­ï¼Œè€Œä¸å®šä¹‰åœ¨threadä¸­ï¼Ÿ" class="headerlink" title="6.ä¸ºä»€ä¹ˆwaitè¦å®šä¹‰åœ¨objectä¸­ï¼Œè€Œä¸å®šä¹‰åœ¨threadä¸­ï¼Ÿ"></a>6.ä¸ºä»€ä¹ˆwaitè¦å®šä¹‰åœ¨objectä¸­ï¼Œè€Œä¸å®šä¹‰åœ¨threadä¸­ï¼Ÿ</h5><p>å› ä¸ºJavaçš„é”æ˜¯å¯¹è±¡çº§åˆ«çš„ï¼Œè€Œä¸æ˜¯çº¿ç¨‹çº§åˆ«çš„</p>
<h5 id="7-ä¸ºä»€ä¹ˆwaitå¿…é¡»å¸è½½åŒæ­¥ä»£ç å—ä¸­"><a href="#7-ä¸ºä»€ä¹ˆwaitå¿…é¡»å¸è½½åŒæ­¥ä»£ç å—ä¸­" class="headerlink" title="7.ä¸ºä»€ä¹ˆwaitå¿…é¡»å¸è½½åŒæ­¥ä»£ç å—ä¸­"></a>7.ä¸ºä»€ä¹ˆwaitå¿…é¡»å¸è½½åŒæ­¥ä»£ç å—ä¸­</h5><p>åŸå› æ˜¯é¿å…CPUåˆ‡æ¢åˆ°å…¶ä»–çº¿ç¨‹ï¼Œè€Œå…¶ä»–çº¿ç¨‹åˆæå‰æ‰§è¡Œäº†notifyæ–¹æ³•ï¼Œé‚£æ ·å°±è¾¾ä¸åˆ°æˆ‘ä»¬çš„é¢„æœŸï¼ˆå…ˆwaitå†ç”±å…¶ä»–çº¿ç¨‹æ¥å”¤é†’ï¼‰ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªåŒæ­¥é”æ¥ä¿æŠ¤</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>javaä¸­çš„classloaderç±»åŠ è½½å™¨</title>
    <url>/2020/05/12/java%E4%B8%AD%E7%9A%84classloader%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>JDKä¸­æä¾›äº†ä¸‰ä¸ªClassLoaderï¼Œæ ¹æ®å±‚çº§ä»é«˜åˆ°ä½ä¸ºï¼š</p>
<p>1.Bootstrap ClassLoaderï¼Œï¼ˆæ ¹åŠ è½½å™¨ï¼‰ä¸»è¦åŠ è½½JVMè‡ªèº«å·¥ä½œéœ€è¦çš„ç±»ã€‚</p>
<p>2.Extension ClassLoaderï¼Œï¼ˆæ‰©å±•ç±»åŠ è½½å™¨ï¼‰ä¸»è¦åŠ è½½%JAVA_HOME%\lib\extç›®å½•ä¸‹çš„åº“ç±»ã€‚</p>
<p>3.Application ClassLoaderï¼Œï¼ˆç³»ç»Ÿç±»åŠ è½½å™¨ï¼‰ä¸»è¦åŠ è½½ClasspathæŒ‡å®šçš„åº“ç±»ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™æ˜¯ç¨‹åºä¸­çš„é»˜è®¤ç±»åŠ è½½å™¨ï¼Œä¹Ÿæ˜¯<strong>ClassLoader.getSystemClassLoader()</strong> çš„è¿”å›å€¼ã€‚ï¼ˆè¿™é‡Œçš„Classpathé»˜è®¤æŒ‡çš„æ˜¯ç¯å¢ƒå˜é‡ä¸­é…ç½®çš„Classpathï¼Œä½†æ˜¯å¯ä»¥åœ¨æ‰§è¡ŒJavaå‘½ä»¤çš„æ—¶å€™ä½¿ç”¨-cp å‚æ•°æ¥ä¿®æ”¹å½“å‰ç¨‹åºä½¿ç”¨çš„Classpathï¼‰</p>
<p>å³ä½¿åŒä¸€ä¸ªåï¼Œç”¨äº†ä¸åŒçš„ç±»åŠ è½½å™¨å°±åˆ¤å®šä¸ºä¸åŒçš„ç±»</p>
<p>JVMåŠ è½½ç±»çš„å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬ç§°ä¸º <strong>åŒäº²å§”æ‰˜æ¨¡å‹</strong>ï¼š</p>
<p>å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½çš„è¯·æ±‚ï¼Œä»–é¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™è‡ªå·±çš„çˆ¶åŠ è½½å™¨ï¼Œæ¯ä¸€å±‚çš„ç±»åŠ è½½å™¨éƒ½æ˜¯å¦‚æ­¤ï¼Œå› æ­¤æ‰€æœ‰çš„ç±»åŠ è½½è¯·æ±‚æœ€ç»ˆéƒ½åº”è¯¥ä¼ é€åˆ°é¡¶å±‚çš„<strong>Bootstrap ClassLoader</strong>ä¸­ï¼Œåªæœ‰å½“çˆ¶åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®ŒæˆåŠ è½½è¯·æ±‚æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±åŠ è½½ã€‚</p>
<p><strong>åŒäº²å§”æ‰˜æ¨¡å‹çš„é‡è¦ç”¨é€”æ˜¯ä¸ºäº†è§£å†³ç±»è½½å…¥è¿‡ç¨‹ä¸­çš„å®‰å…¨æ€§é—®é¢˜ã€‚</strong></p>
<p>å‡è®¾æœ‰ä¸€ä¸ªå¼€å‘è€…è‡ªå·±ç¼–å†™äº†ä¸€ä¸ªåä¸ºJava<em>.lang.Object</em>çš„ç±»ï¼Œæƒ³å€Ÿæ­¤æ¬ºéª—JVMã€‚ç°åœ¨ä»–è¦ä½¿ç”¨<strong>è‡ªå®šä¹‰ClassLoader</strong>æ¥åŠ è½½è‡ªå·±ç¼–å†™çš„<em>java.lang.Object</em>ç±»ã€‚ç„¶è€Œå¹¸è¿çš„æ˜¯ï¼Œ<strong>åŒäº²å§”æ‰˜æ¨¡å‹</strong>ä¸ä¼šè®©ä»–æˆåŠŸã€‚å› ä¸ºJVMä¼šä¼˜å…ˆåœ¨<strong>Bootstrap ClassLoader</strong>çš„è·¯å¾„ä¸‹æ‰¾åˆ°<em>java.lang.Object</em>ç±»ï¼Œå¹¶è½½å…¥å®ƒ</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>Mybatisç¬”è®°</title>
    <url>/2020/06/04/Mybatis%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>GitHubæºç : </p>
<p>åˆ†äº«è‡ªå†™æºç å’Œç¬”è®°</p>
<p>é…ç½®ç”¨çš„</p>
<ul>
<li>Jdk1.8 ï¼ˆjdk1.7ä»¥ä¸Šå‡å¯ï¼‰</li>
<li>Maven 3.6.3</li>
<li>MySQL 5.7 ï¼ˆmysql5.6ä»¥ä¸Šå‡å¯ï¼‰</li>
</ul>
<h1 id="1-é…ç½®"><a href="#1-é…ç½®" class="headerlink" title="1. é…ç½®"></a>1. é…ç½®</h1><p>å®˜ç½‘æ–‡æ¡£ï¼š <a href="https://mybatis.org/mybatis-3/zh/getting-started.html" target="_blank" rel="noopener">https://mybatis.org/mybatis-3/zh/getting-started.html</a></p>
<h3 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>batis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>batis-maven<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>mybatis-01<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¯¼å…¥ä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="src-main-resources"><a href="#src-main-resources" class="headerlink" title="src/main/resources"></a>src/main/resources</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?userSSL=true<span class="symbol">&amp;amp;</span></span></span></span><br><span class="line"><span class="tag"><span class="string">                userUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="src-main-java"><a href="#src-main-java" class="headerlink" title="src/main/java"></a>src/main/java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">//sqlSessionFactory --&gt; sqlSession</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨mybatisç¬¬ä¸€æ­¥ï¼šè·å–sqlSessionFactoryå¯¹è±¡</span></span><br><span class="line">            String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ—¢ç„¶æœ‰äº† SqlSessionFactoryï¼Œé¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­è·å¾— SqlSession çš„å®ä¾‹ã€‚SqlSession æä¾›äº†åœ¨æ•°æ®åº“æ‰§è¡Œ SQL å‘½ä»¤æ‰€éœ€çš„æ‰€æœ‰æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment">// ä½ å¯ä»¥é€šè¿‡ SqlSession å®ä¾‹æ¥ç›´æ¥æ‰§è¡Œå·²æ˜ å°„çš„ SQL è¯­å¥</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory.openSession();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h3><ul>
<li><p>å®ä½“ç±»</p>
<p>src/main/java</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.pogo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(<span class="keyword">int</span> id, String name, String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPwd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPwd</span><span class="params">(String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", pwd='"</span> + pwd + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Daoæ¥å£</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nedlee.pogo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ¥å£å®ç°ç±»</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespaceç»‘å®šä¸€ä¸ªå¯¹åº”çš„mapperæ¥å£--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.nedlee.dao.UserDao"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--idæ–¹æ³•å--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserList"</span> <span class="attr">resultType</span>=<span class="string">"com.nedlee.pogo.User"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>æ³¨æ„ç‚¹ï¼š</p>
<p>org.apache.ibatis.binding.BindingException: Type interface com.nedlee.dao.UserDao is not known to the MapperRegistry.</p>
<h3 id="mybatis-config-xml"><a href="#mybatis-config-xml" class="headerlink" title="mybatis-config.xml"></a>mybatis-config.xml</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?userSSL=true<span class="symbol">&amp;amp;</span></span></span></span><br><span class="line"><span class="tag"><span class="string">                userUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ¯ä¸€ä¸ªmapper.xmléƒ½éœ€è¦æ³¨å†Œ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/nedlee/dao/UserMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸¤ä¸ªpom.xmlä¸­åŠ å…¥</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--åœ¨buildä¸­é…ç½®resourcesï¼Œæ¥é˜²æ­¢æˆ‘ä»¬èµ„æºå¯¼å‡ºå¤±è´¥çš„é—®é¢˜--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><ol>
<li>å¯¼å…¥åŒ…</li>
<li>é…ç½®æ•°æ®åº“</li>
<li>å»ºé€ å·¥å…·ç±»</li>
</ol>
<h4 id="SqlSessionFactoryBuilder"><a href="#SqlSessionFactoryBuilder" class="headerlink" title="SqlSessionFactoryBuilder"></a>SqlSessionFactoryBuilder</h4><p>è¿™ä¸ªç±»å¯ä»¥è¢«å®ä¾‹åŒ–ã€ä½¿ç”¨å’Œä¸¢å¼ƒï¼Œä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†ã€‚ å› æ­¤ SqlSessionFactoryBuilder å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸï¼ˆä¹Ÿå°±æ˜¯å±€éƒ¨æ–¹æ³•å˜é‡ï¼‰ã€‚ ä½ å¯ä»¥é‡ç”¨ SqlSessionFactoryBuilder æ¥åˆ›å»ºå¤šä¸ª SqlSessionFactory å®ä¾‹ï¼Œä½†æœ€å¥½è¿˜æ˜¯ä¸è¦ä¸€ç›´ä¿ç•™ç€å®ƒï¼Œä»¥ä¿è¯æ‰€æœ‰çš„ XML è§£æèµ„æºå¯ä»¥è¢«é‡Šæ”¾ç»™æ›´é‡è¦çš„äº‹æƒ…ã€‚</p>
<h4 id="SqlSessionFactory"><a href="#SqlSessionFactory" class="headerlink" title="SqlSessionFactory"></a>SqlSessionFactory</h4><p>SqlSessionFactory ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹ã€‚ ä½¿ç”¨ SqlSessionFactory çš„æœ€ä½³å®è·µæ˜¯åœ¨åº”ç”¨è¿è¡ŒæœŸé—´ä¸è¦é‡å¤åˆ›å»ºå¤šæ¬¡ï¼Œå¤šæ¬¡é‡å»º SqlSessionFactory è¢«è§†ä¸ºä¸€ç§ä»£ç â€œåä¹ æƒ¯â€ã€‚å› æ­¤ SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚ æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åšåˆ°ï¼Œæœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚</p>
<h4 id="SqlSession"><a href="#SqlSession" class="headerlink" title="SqlSession"></a>SqlSession</h4><p>æ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹ã€‚SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚ ç»å¯¹ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä¸€ä¸ªç±»çš„é™æ€åŸŸï¼Œç”šè‡³ä¸€ä¸ªç±»çš„å®ä¾‹å˜é‡ä¹Ÿä¸è¡Œã€‚ ä¹Ÿç»ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä»»ä½•ç±»å‹çš„æ‰˜ç®¡ä½œç”¨åŸŸä¸­ï¼Œæ¯”å¦‚ Servlet æ¡†æ¶ä¸­çš„ HttpSessionã€‚ å¦‚æœä½ ç°åœ¨æ­£åœ¨ä½¿ç”¨ä¸€ç§ Web æ¡†æ¶ï¼Œè€ƒè™‘å°† SqlSession æ”¾åœ¨ä¸€ä¸ªå’Œ HTTP è¯·æ±‚ç›¸ä¼¼çš„ä½œç”¨åŸŸä¸­ã€‚ æ¢å¥è¯è¯´ï¼Œæ¯æ¬¡æ”¶åˆ° HTTP è¯·æ±‚ï¼Œå°±å¯ä»¥æ‰“å¼€ä¸€ä¸ª SqlSessionï¼Œè¿”å›ä¸€ä¸ªå“åº”åï¼Œå°±å…³é—­å®ƒã€‚ è¿™ä¸ªå…³é—­æ“ä½œå¾ˆé‡è¦ï¼Œä¸ºäº†ç¡®ä¿æ¯æ¬¡éƒ½èƒ½æ‰§è¡Œå…³é—­æ“ä½œï¼Œä½ åº”è¯¥æŠŠè¿™ä¸ªå…³é—­æ“ä½œæ”¾åˆ° finally å—ä¸­ã€‚ ä¸‹é¢çš„ç¤ºä¾‹å°±æ˜¯ä¸€ä¸ªç¡®ä¿ SqlSession å…³é—­çš„æ ‡å‡†æ¨¡å¼</p>
<h1 id="2-å¢åˆ æ”¹æŸ¥"><a href="#2-å¢åˆ æ”¹æŸ¥" class="headerlink" title="2. å¢åˆ æ”¹æŸ¥"></a>2. å¢åˆ æ”¹æŸ¥</h1><h3 id="1-namespace"><a href="#1-namespace" class="headerlink" title="1. namespace"></a>1. namespace</h3><p>namespaceä¸­çš„åŒ…åè¦å’Œæ¥å£ä¸€è‡´</p>
<h3 id="2-select"><a href="#2-select" class="headerlink" title="2. select"></a>2. select</h3><ul>
<li>idï¼šå°±æ˜¯å¯¹åº”çš„namespaceçš„æ–¹æ³•å</li>
<li>resultTypeï¼šsqlè¯­å¥çš„è¿”å›å€¼ï¼</li>
<li>parameterTypeï¼š å‚æ•°ç±»å‹ï¼</li>
</ul>
<ol>
<li>ç¼–å†™æ¥å£</li>
<li>ç¼–å†™å¯¹åº”çš„mapperä¸­çš„å¯¹åº”è¯­å¥</li>
<li>æµ‹è¯•</li>
</ol>
<h4 id="UserMapper"><a href="#UserMapper" class="headerlink" title="UserMapper"></a>UserMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nedlee.pogo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUserList</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">    <span class="function">User <span class="title">getUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ’å…¥ç”¨æˆ·</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¿®æ”¹ç”¨æˆ·</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤ç”¨æˆ·</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteUser</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="UserMapper-xml"><a href="#UserMapper-xml" class="headerlink" title="UserMapper.xml"></a>UserMapper.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespaceç»‘å®šä¸€ä¸ªå¯¹åº”çš„mapperæ¥å£--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.nedlee.dao.UserMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--idæ–¹æ³•å--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserList"</span> <span class="attr">resultType</span>=<span class="string">"com.nedlee.pogo.User"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserById"</span> <span class="attr">resultType</span>=<span class="string">"com.nedlee.pogo.User"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¯¹è±¡ä¸­çš„å±æ€§å¯ä»¥ç›´æ¥å–å‡ºæ¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.nedlee.pogo.User"</span>&gt;</span></span><br><span class="line">        insert into mybatis.user (id, name, pwd) values (#&#123;id&#125;, #&#123;name&#125;, #&#123;pwd&#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span> <span class="attr">parameterType</span>=<span class="string">"com.nedlee.pogo.User"</span>&gt;</span></span><br><span class="line">        update mybatis.user set name=#&#123;name&#125;, pwd=#&#123;pwd&#125; where id =#&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUser"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        delete from mybatis.user where id=#&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nedlee.pogo.User;</span><br><span class="line"><span class="keyword">import</span> com.nedlee.utils.MybatisUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// è·å¾—sqlsessionå¯¹è±¡</span></span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 1.æ‰§è¡Œ getmapper</span></span><br><span class="line">            UserMapper userDao = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            List&lt;User&gt; userList = userDao.getUserList();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// method 2</span></span><br><span class="line"><span class="comment">//        List&lt;User&gt; userList = sqlSession.selectList("com.nedlee.dao.UserDao.getUserList");</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(User user: userList)&#123;</span><br><span class="line">                System.out.println(user);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">//å…³é—­</span></span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserById</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        User user = mapper.getUserById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¢åˆ æ”¹éœ€è¦æäº¤äº‹åŠ¡</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        mapper.addUser(<span class="keyword">new</span> User(<span class="number">5</span>,<span class="string">"nedlee"</span>,<span class="string">"123456"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        mapper.updateUser(<span class="keyword">new</span> User(<span class="number">4</span>,<span class="string">"nedlee"</span>,<span class="string">"123"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        mapper.deleteUser(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ç‚¹ï¼šå¢åˆ æ”¹éœ€è¦æäº¤äº‹åŠ¡ã€‚</p>
<h3 id="3-Map"><a href="#3-Map" class="headerlink" title="3. Map"></a>3. Map</h3><p>å‡å¦‚æˆ‘ä»¬çš„å®ä½“ç±»å±æ€§è¿‡å¤šï¼Œç”¨mapï¼Œä¼ é€’mapçš„key</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser2"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">    insert into mybatis.user (id, name, pwd) values (#&#123;id1&#125;, #&#123;name1&#125;, #&#123;pwd1&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">int addUser2(Map<span class="tag">&lt;<span class="name">String,</span> <span class="attr">Object</span>&gt;</span> map);</span><br><span class="line">@Test</span><br><span class="line">public void addUser2()&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    Map<span class="tag">&lt;<span class="name">String,</span> <span class="attr">Object</span>&gt;</span> map = new HashMap<span class="tag">&lt;<span class="name">String,</span> <span class="attr">Object</span>&gt;</span>();</span><br><span class="line">    map.put("id1",5);</span><br><span class="line">    map.put("name1","dong");</span><br><span class="line">    map.put("pwd1","12345");</span><br><span class="line">    mapper.addUser2(map);</span><br><span class="line"></span><br><span class="line">    //æäº¤äº‹åŠ¡</span><br><span class="line">    sqlSession.commit();</span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-æ¨¡ç³ŠæŸ¥è¯¢"><a href="#4-æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="4.æ¨¡ç³ŠæŸ¥è¯¢"></a>4.æ¨¡ç³ŠæŸ¥è¯¢</h3><p>javaä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼ é€’é€šé…ç¬¦%</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserLike"</span> <span class="attr">resultType</span>=<span class="string">"com.nedlee.pogo.User"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where name like #&#123;value&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">@Test</span><br><span class="line">public void getUserLike()&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line"></span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    List<span class="tag">&lt;<span class="name">User</span>&gt;</span> list = mapper.getUserLike("%o%");</span><br><span class="line"></span><br><span class="line">    for(User user : list)&#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3-é…ç½®è§£æ"><a href="#3-é…ç½®è§£æ" class="headerlink" title="3. é…ç½®è§£æ"></a>3. é…ç½®è§£æ</h1><h3 id="1-æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#1-æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="1. æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>1. æ ¸å¿ƒé…ç½®æ–‡ä»¶</h3><ul>
<li>mybatis-config.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">configurationï¼ˆé…ç½®ï¼‰</span><br><span class="line">    propertiesï¼ˆå±æ€§ï¼‰</span><br><span class="line">    settingsï¼ˆè®¾ç½®ï¼‰</span><br><span class="line">    typeAliasesï¼ˆç±»å‹åˆ«åï¼‰</span><br><span class="line">    typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</span><br><span class="line">    objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</span><br><span class="line">    pluginsï¼ˆæ’ä»¶ï¼‰</span><br><span class="line">        environmentsï¼ˆç¯å¢ƒé…ç½®ï¼‰</span><br><span class="line">            environmentï¼ˆç¯å¢ƒå˜é‡ï¼‰</span><br><span class="line">            transactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰</span><br><span class="line">    dataSourceï¼ˆæ•°æ®æºï¼‰</span><br><span class="line">    databaseIdProviderï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰</span><br><span class="line">    mappersï¼ˆæ˜ å°„å™¨ï¼‰</span><br></pre></td></tr></table></figure>

<h3 id><a href="#" class="headerlink" title></a></h3><h3 id="2-ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰"><a href="#2-ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰" class="headerlink" title="2. ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰"></a>2. ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰</h3><p>MyBatis å¯ä»¥é…ç½®æˆé€‚åº”å¤šç§ç¯å¢ƒ</p>
<p><strong>ä¸è¿‡è¦è®°ä½ï¼šå°½ç®¡å¯ä»¥é…ç½®å¤šä¸ªç¯å¢ƒï¼Œä½†æ¯ä¸ª SqlSessionFactory å®ä¾‹åªèƒ½é€‰æ‹©ä¸€ç§ç¯å¢ƒã€‚</strong></p>
<p>Mybatis é»˜è®¤çš„äº‹åŠ¡ç®¡ç†å™¨æ˜¯JDBCï¼Œè¿æ¥æ± ï¼šPOOLED</p>
<h3 id="3-å±æ€§"><a href="#3-å±æ€§" class="headerlink" title="3. å±æ€§"></a>3. å±æ€§</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡propertieså±æ€§æ¥å¼•ç”¨é…ç½®æ–‡ä»¶</p>
<p>è¿™äº›å±æ€§å¯ä»¥åœ¨å¤–éƒ¨è¿›è¡Œé…ç½®ï¼Œå¹¶å¯ä»¥è¿›è¡ŒåŠ¨æ€æ›¿æ¢ã€‚ä½ æ—¢å¯ä»¥åœ¨å…¸å‹çš„ Java å±æ€§æ–‡ä»¶ä¸­é…ç½®è¿™äº›å±æ€§ï¼Œä¹Ÿå¯ä»¥åœ¨ properties å…ƒç´ çš„å­å…ƒç´ ä¸­è®¾ç½®ã€‚ ï¼ˆdb.propertiesï¼‰</p>
<p>ç¼–å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶</p>
<p>db.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">driver</span> = <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span> = <span class="string">"jdbc:mysql://localhost:3306/mybatis?userSSL=true&amp;userUnicode=true&amp;characterEncoding=UTF-8"</span></span><br><span class="line"><span class="attr">username</span> = <span class="string">root </span></span><br><span class="line"><span class="attr">password</span> = <span class="string">123456</span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­å¼•å…¥</p>
<p>mybatis-config.xml (åŒæ—¶æœ‰çš„è¯ï¼Œä¼˜å…ˆèµ°å¤–é¢properties)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¼•å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;properties resource="db.properties"/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;driver&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;url&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;username&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;password&#125;"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ¯ä¸€ä¸ªmapper.xmléƒ½éœ€è¦æ³¨å†Œ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/nedlee/dao/UserMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰"><a href="#4-ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰" class="headerlink" title="4. ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰"></a>4. ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰</h3><p>ç±»å‹åˆ«åå¯ä¸º Java ç±»å‹è®¾ç½®ä¸€ä¸ªç¼©å†™åå­—ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.nedlee.pogo.User"</span> <span class="attr">alias</span>=<span class="string">"User"</span>&gt;</span><span class="tag">&lt;/<span class="name">typeAlias</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰«æå®ä½“ç±»çš„åŒ…ï¼Œé»˜è®¤åˆ«åå°±ä¸ºè¿™ä¸ªç±»çš„ç±»åé¦–å­—æ¯å°å†™</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.nedlee.pogo"</span>&gt;</span><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨å®ä½“ç±»ï¼Œæ¯”è¾ƒå°‘çš„æ—¶å€™ä½¿ç”¨ç¬¬ä¸€ç§ï¼Œå®ä½“ç±»å¤šä½¿ç”¨ç¬¬äºŒç§ã€‚</p>
<p>ç¬¬ä¸€ç§å¯ä»¥è‡ªå®šä¹‰ï¼Œç¬¬äºŒåˆ™ä¸è¡Œï¼Œä½†æ˜¯ è‹¥æœ‰æ³¨è§£ï¼Œåˆ™åˆ«åä¸ºå…¶æ³¨è§£å€¼ ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Alias</span>(<span class="string">"hello"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-è®¾ç½®"><a href="#5-è®¾ç½®" class="headerlink" title="5. è®¾ç½®"></a>5. è®¾ç½®</h3><table>
<thead>
<tr>
<th align="left">è®¾ç½®å</th>
<th align="left">æè¿°</th>
<th align="left">æœ‰æ•ˆå€¼</th>
<th align="left">é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody><tr>
<td align="left">cacheEnabled</td>
<td align="left">å…¨å±€æ€§åœ°å¼€å¯æˆ–å…³é—­æ‰€æœ‰æ˜ å°„å™¨é…ç½®æ–‡ä»¶ä¸­å·²é…ç½®çš„ä»»ä½•ç¼“å­˜ã€‚</td>
<td align="left">true | false</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">lazyLoadingEnabled</td>
<td align="left">å»¶è¿ŸåŠ è½½çš„å…¨å±€å¼€å…³ã€‚å½“å¼€å¯æ—¶ï¼Œæ‰€æœ‰å…³è”å¯¹è±¡éƒ½ä¼šå»¶è¿ŸåŠ è½½ã€‚ ç‰¹å®šå…³è”å…³ç³»ä¸­å¯é€šè¿‡è®¾ç½® <code>fetchType</code> å±æ€§æ¥è¦†ç›–è¯¥é¡¹çš„å¼€å…³çŠ¶æ€ã€‚</td>
<td align="left">true | false</td>
<td align="left">false</td>
</tr>
<tr>
<td align="left">logImpl</td>
<td align="left">æŒ‡å®š MyBatis æ‰€ç”¨æ—¥å¿—çš„å…·ä½“å®ç°ï¼ŒæœªæŒ‡å®šæ—¶å°†è‡ªåŠ¨æŸ¥æ‰¾ã€‚</td>
<td align="left">SLF4J | LOG4J | LOG4J2 | JDK_LOGGING | COMMONS_LOGGING | STDOUT_LOGGING | NO_LOGGING</td>
<td align="left">æœªè®¾ç½®</td>
</tr>
</tbody></table>
<h3 id="6-å…¶ä»–"><a href="#6-å…¶ä»–" class="headerlink" title="6. å…¶ä»–"></a>6. å…¶ä»–</h3><ul>
<li><a href="https://mybatis.org/mybatis-3/zh/configuration.html#typeHandlers" target="_blank" rel="noopener">typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</a></li>
<li><a href="https://mybatis.org/mybatis-3/zh/configuration.html#objectFactory" target="_blank" rel="noopener">objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</a></li>
<li>pluginsï¼ˆæ’ä»¶ï¼‰<ul>
<li>mybatis-generator-core</li>
<li>mybatis-plus</li>
<li>é€šç”¨mapper</li>
</ul>
</li>
</ul>
<h3 id="7-æ˜ å°„å™¨"><a href="#7-æ˜ å°„å™¨" class="headerlink" title="7. æ˜ å°„å™¨"></a>7. æ˜ å°„å™¨</h3><p>æ–¹å¼ä¸€: [æ¨èä½¿ç”¨]</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/nedlee/dao/UserMapper.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ–¹å¼äºŒï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.nedlee.dao.UserMapper"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ¥å£å’Œå®ƒçš„Mapperå¿…é¡»åŒå</li>
<li>æ¥å£å’Œä»–çš„Mapperå¿…é¡»åœ¨åŒä¸€åŒ…ä¸‹</li>
</ul>
<p>æ–¹å¼ä¸‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mapper resource="com/nedlee/dao/UserMapper.xml"/&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mapper class="com.nedlee.dao.UserMapper" /&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.nedlee.dao"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ¥å£å’Œå®ƒçš„Mapperå¿…é¡»åŒå</li>
<li>æ¥å£å’Œä»–çš„Mapperå¿…é¡»åœ¨åŒä¸€åŒ…ä¸‹</li>
</ul>
<h3 id="8-ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"><a href="#8-ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ" class="headerlink" title="8.ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"></a>8.ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ</h3><p>ä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸç±»åˆ«æ˜¯è‡³å…³é‡è¦çš„ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„<strong>å¹¶å‘é—®é¢˜</strong>ã€‚</p>
<p><strong>SqlSessionFactoryBuilder</strong>:</p>
<ul>
<li>ä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº† ã€‚</li>
<li>å±€éƒ¨å˜é‡</li>
</ul>
<p><strong>SqlSessionFactory</strong>ï¼š</p>
<ul>
<li>å°±æ˜¯æ•°æ®åº“è¿æ¥æ± ã€‚</li>
<li>ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ ï¼Œ<strong>æ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹ ã€‚</strong> å¤šæ¬¡é‡å»º SqlSessionFactory è¢«è§†ä¸ºä¸€ç§ä»£ç â€œåä¹ æƒ¯â€ã€‚</li>
<li>å› æ­¤ SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚</li>
<li>æœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚</li>
</ul>
<p><strong>SqlSession</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹ã€‚</li>
<li>è¿æ¥åˆ°è¿æ¥æ± çš„è¯·æ±‚ï¼</li>
<li>SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚</li>
<li>ç”¨å®Œä¹‹åèµ¶ç´§å…³é—­ï¼Œå¦åˆ™èµ„æºè¢«å ç”¨ã€‚</li>
</ul>
<h1 id="4-è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜"><a href="#4-è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜" class="headerlink" title="4. è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜"></a>4. è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜</h1><p>æ•°æ®åº“ä¸­çš„å­—æ®µ</p>
<p>æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ‹·è´ä¹‹å‰ï¼Œæµ‹è¯•å®ä½“å­—æ®µä¸ä¸€è‡´çš„æƒ…å†µ</p>
<p>User</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.pogo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é—®é¢˜ï¼š</p>
<p>User{id=2, name=â€™wangâ€™, password=â€™nullâ€™}</p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<p>æ ¸å¿ƒé…ç½®æ–‡ä»¶</p>
<ul>
<li>èµ·åˆ«å</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserById"</span> <span class="attr">resultType</span>=<span class="string">"User"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        select id,name,pwd as password from mybatis.user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>resultMap ç»“æœé›†æ˜ å°„</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespaceç»‘å®šä¸€ä¸ªå¯¹åº”çš„mapperæ¥å£--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.nedlee.dao.UserMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserById"</span> <span class="attr">resultMap</span>=<span class="string">"UserMap"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»“æœé›†æ˜ å°„--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"UserMap"</span> <span class="attr">type</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--colunm æ•°æ®åº“ä¸­çš„å­—æ®µï¼Œpropertyå®ä½“ä¸­çš„å±æ€§--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pwd"</span> <span class="attr">property</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>resultMap</code> å…ƒç´ æ˜¯ MyBatis ä¸­æœ€é‡è¦æœ€å¼ºå¤§çš„å…ƒç´ ã€‚</li>
<li>ResultMap çš„è®¾è®¡æ€æƒ³æ˜¯ï¼Œå¯¹ç®€å•çš„è¯­å¥åšåˆ°é›¶é…ç½®ï¼Œå¯¹äºå¤æ‚ä¸€ç‚¹çš„è¯­å¥ï¼Œåªéœ€è¦æè¿°è¯­å¥ä¹‹é—´çš„å…³ç³»å°±è¡Œäº†ã€‚</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"UserMap"</span> <span class="attr">type</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--colunm æ•°æ®åº“ä¸­çš„å­—æ®µï¼Œpropertyå®ä½“ä¸­çš„å±æ€§--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;result column="id" property="id"&gt;&lt;/result&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;result column="name" property="name"&gt;&lt;/result&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pwd"</span> <span class="attr">property</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="5-æ—¥å¿—"><a href="#5-æ—¥å¿—" class="headerlink" title="5. æ—¥å¿—"></a>5. æ—¥å¿—</h1><h3 id="1-æ—¥å¿—å·¥å‚"><a href="#1-æ—¥å¿—å·¥å‚" class="headerlink" title="1. æ—¥å¿—å·¥å‚"></a>1. æ—¥å¿—å·¥å‚</h3><p>å¦‚æœä¸€ä¸ªæ•°æ®åº“æ“ä½œå‡ºç°äº†å¼‚å¸¸ï¼Œæˆ‘ä»¬éœ€è¦æ’é”™ã€‚æ—¥å¿—å°±æ˜¯æœ€å¥½çš„åŠ©æ‰‹ã€‚</p>
<p>æ›¾ç»ï¼šsoutï¼Œdebug</p>
<p>ç°åœ¨ï¼šæ—¥å¿—å·¥å‚</p>
<p>logImpl</p>
<ul>
<li>SLF4J</li>
<li>LOG4J [æŒæ¡]</li>
<li>LOG4J2</li>
<li>JDK_LOGGING</li>
<li>COMMONS_LOGGING</li>
<li>STDOUT_LOGGING [æŒæ¡]</li>
<li>NO_LOGGING</li>
</ul>
<p>å…·ä½“ä½¿ç”¨å“ªä¸€ä¸ªï¼Œåœ¨è®¾ç½®ä¸­è®¾å®š</p>
<p>STDOUT_LOGGING æ ‡å¿—æ—¥å¿—è¾“å‡º</p>
<p>mybatis-confiä¸­</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"STDOUT_LOGGING"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-Log4j"><a href="#2-Log4j" class="headerlink" title="2. Log4j"></a>2. Log4j</h3><ol>
<li><p>å…ˆå¯¼åŒ…</p>
<p>pom.xmlä¸‹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ–°å»ºlog4j.propertiesæ–‡ä»¶</p>
</li>
</ol>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment">### set log levels ###</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span> = <span class="string">DEBUG,console,file</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### è¾“å‡ºåˆ°æ§åˆ¶å° ###</span></span><br><span class="line"><span class="meta">log4j.appender.console</span> = <span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.console.Target</span> = <span class="string">System.out</span></span><br><span class="line"><span class="meta">log4j.appender.console.Threshold</span> = <span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout.ConversionPattern</span> = <span class="string">[%c]-%m%n</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ ###</span></span><br><span class="line"><span class="meta">log4j.appender.file</span>=<span class="string">org.apache.log4j.RollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.file.File</span>=<span class="string">./log/nedlee.log</span></span><br><span class="line"><span class="meta">log4j.appender.file.MaxFileSize</span>=<span class="string">10mb </span></span><br><span class="line"><span class="meta">log4j.appender.file.Threshold</span>=<span class="string">DEBUG </span></span><br><span class="line"><span class="meta">log4j.appender.file.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout.ConversionPattern</span>=<span class="string">[%p][%d&#123;yy-MM-dd&#125;][%c]%m%n</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—è¾“å‡ºçº§åˆ«</span></span><br><span class="line"><span class="meta">log4j.logger.org.mybatis</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.Statement</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.ResultSet</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.PreparedStatement</span>=<span class="string">DEBUG</span></span><br></pre></td></tr></table></figure>

<ol>
<li>é…ç½®å®ç°</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>Log4jä½¿ç”¨</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nedlee.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.nedlee.utils.MybatisUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Logger logger = Logger.getLogger(UserDaoTest<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// è·å¾—sqlsessionå¯¹è±¡</span></span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 1.æ‰§è¡Œ getmapper</span></span><br><span class="line">            UserMapper userDao = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            logger.info(<span class="string">"æµ‹è¯•"</span>);</span><br><span class="line">            User user = userDao.getUserById(<span class="number">2</span>);</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">//å…³é—­</span></span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLog4j</span><span class="params">()</span></span>&#123;</span><br><span class="line">        logger.info(<span class="string">"info:è¿›å…¥äº†testlog4j"</span>);</span><br><span class="line">        logger.debug(<span class="string">"debug:è¿›å…¥äº†testlog4j"</span>);</span><br><span class="line">        logger.error(<span class="string">"error:è¿›å…¥äº†testlog4j"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6-åˆ†é¡µ"><a href="#6-åˆ†é¡µ" class="headerlink" title="6. åˆ†é¡µ"></a>6. åˆ†é¡µ</h1><h3 id="1-Limit-åˆ†é¡µ"><a href="#1-Limit-åˆ†é¡µ" class="headerlink" title="1. Limit åˆ†é¡µ"></a>1. Limit åˆ†é¡µ</h3><p>è¯­æ³•ï¼š</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">limit</span> startIndex,pageSize;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">2</span>;</span><br><span class="line">package com.nedlee.dao;</span><br><span class="line"></span><br><span class="line">import com.nedlee.pojo.User;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">public interface UserMapper &#123;</span><br><span class="line"></span><br><span class="line">    //æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span><br><span class="line">    User getUserById(int id);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; getUserByLimit(Map&lt;String, Integer&gt; map);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespaceç»‘å®šä¸€ä¸ªå¯¹åº”çš„mapperæ¥å£--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.nedlee.dao.UserMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserById"</span> <span class="attr">resultMap</span>=<span class="string">"UserMap"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»“æœé›†æ˜ å°„--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"UserMap"</span> <span class="attr">type</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--colunm æ•°æ®åº“ä¸­çš„å­—æ®µï¼Œpropertyå®ä½“ä¸­çš„å±æ€§--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;result column="id" property="id"&gt;&lt;/result&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;result column="name" property="name"&gt;&lt;/result&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pwd"</span> <span class="attr">property</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUserByLimit"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">resultType</span>=<span class="string">"User"</span> <span class="attr">resultMap</span>=<span class="string">"UserMap"</span>&gt;</span></span><br><span class="line">      select * from mybatis.user limit #&#123;startIndex&#125;,#&#123;pageSize&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>testç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getByLimit</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    Map&lt;String, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();</span><br><span class="line">    map.put(<span class="string">"startIndex"</span>, <span class="number">1</span>);</span><br><span class="line">    map.put(<span class="string">"pageSize"</span>, <span class="number">2</span>);</span><br><span class="line">    List&lt;User&gt; userList = mapper.getUserByLimit(map);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(User user:userList)&#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-RowBoundsåˆ†é¡µ"><a href="#2-RowBoundsåˆ†é¡µ" class="headerlink" title="2. RowBoundsåˆ†é¡µ"></a>2. RowBoundsåˆ†é¡µ</h3><p>@Test</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getUserByRow</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">    <span class="comment">//RowBoundså®ç°</span></span><br><span class="line">    RowBounds rowBounds = <span class="keyword">new</span> RowBounds(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡javaä»£ç å±‚é¢</span></span><br><span class="line">    List&lt;User&gt; userList = sqlSession.selectList</span><br><span class="line">        (<span class="string">"com.nedlee.dao.UserMapper.getUserByRowBounds"</span>,</span><br><span class="line">         <span class="keyword">null</span>,rowBounds);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-åˆ†é¡µæ’ä»¶"><a href="#3-åˆ†é¡µæ’ä»¶" class="headerlink" title="3. åˆ†é¡µæ’ä»¶"></a>3. åˆ†é¡µæ’ä»¶</h3><ul>
<li>pageHelper</li>
</ul>
<h1 id="7-ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#7-ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="7. ä½¿ç”¨æ³¨è§£å¼€å‘"></a>7. ä½¿ç”¨æ³¨è§£å¼€å‘</h1><ol>
<li><p>åˆ é™¤ UserMapper.xml</p>
</li>
<li><p>UserMapper</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nedlee.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user"</span>)</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ ¸å¿ƒé…ç½® mybatis-config.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¼•å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¯ä»¥ç»™å®ä½“ç±»èµ·åˆ«å--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.nedlee.pojo.User"</span> <span class="attr">alias</span>=<span class="string">"User"</span>&gt;</span><span class="tag">&lt;/<span class="name">typeAlias</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;driver&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;url&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;username&#125;"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;password&#125;"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»‘å®šæ¥å£--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.nedlee.dao.UserMapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ¬è´¨ï¼šåå°„æœºåˆ¶</p>
<p>åº•å±‚ï¼šåŠ¨æ€ä»£ç†ï¼</p>
</li>
</ol>
<h3 id="Mybatisè¯¦ç»†æ‰§è¡Œæµç¨‹ï¼š"><a href="#Mybatisè¯¦ç»†æ‰§è¡Œæµç¨‹ï¼š" class="headerlink" title="Mybatisè¯¦ç»†æ‰§è¡Œæµç¨‹ï¼š"></a>Mybatisè¯¦ç»†æ‰§è¡Œæµç¨‹ï¼š</h3><ol>
<li>Resourceè·å–å…¨å±€é…ç½®æ–‡ä»¶</li>
<li>å®ä¾‹åŒ–SqlsessionFactoryBuilder</li>
<li>è§£æé…ç½®æ–‡ä»¶æµXMLCondigBuilder</li>
<li>Configrationæ‰€æœ‰çš„é…ç½®ä¿¡æ¯</li>
<li>SqlSessionFactoryå®ä¾‹åŒ–</li>
<li>trasactionaläº‹åŠ¡ç®¡ç†</li>
<li>åˆ›å»ºexecutoræ‰§è¡Œå™¨</li>
<li>åˆ›å»ºSqlSession</li>
<li>å®ç°CRUD</li>
<li>æŸ¥çœ‹æ˜¯å¦æ‰§è¡ŒæˆåŠŸ</li>
<li>æäº¤äº‹åŠ¡</li>
<li>å…³é—­</li>
</ol>
<h3 id="æ³¨è§£CRUD"><a href="#æ³¨è§£CRUD" class="headerlink" title="æ³¨è§£CRUD"></a>æ³¨è§£CRUD</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nedlee.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user"</span>)</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ–¹æ³•å­˜åœ¨å¤šä¸ªå‚æ•°ï¼Œæ‰€æœ‰çš„å‚æ•°å¿…é¡»åŠ @Param</span></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user where id = #&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function">User <span class="title">getUserById</span><span class="params">(@Param(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">"insert into user (id, name, pwd) values"</span> +</span><br><span class="line">            <span class="string">"(#&#123;id&#125;,#&#123;name&#125;,#&#123;password&#125;)"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update</span>(<span class="string">"update user set name=#&#123;name&#125;, pwd=#&#123;password&#125; "</span> +</span><br><span class="line">            <span class="string">"where id=#&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Delete</span>(<span class="string">"delete from user where id=#&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteUser</span><span class="params">(@Param(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MybatisUtile</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">//sqlSessionFactory --&gt; sqlSession</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨mybatisç¬¬ä¸€æ­¥ï¼šè·å–sqlSessionFactoryå¯¹è±¡</span></span><br><span class="line">            String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Test</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.nedlee.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.nedlee.utils.MybatisUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// è·å¾—sqlsessionå¯¹è±¡</span></span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 1.æ‰§è¡Œ getmapper</span></span><br><span class="line">            UserMapper userDao = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            List&lt;User&gt; userList = userDao.getUsers();</span><br><span class="line">            <span class="keyword">for</span> (User user : userList) &#123;</span><br><span class="line">                System.out.println(user);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">//å…³é—­</span></span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getuserById</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// è·å¾—sqlsessionå¯¹è±¡</span></span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 1.æ‰§è¡Œ getmapper</span></span><br><span class="line">            UserMapper userDao = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            User user = userDao.getUserById(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            System.out.println(user);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">//å…³é—­</span></span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// è·å¾—sqlsessionå¯¹è±¡</span></span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 1.æ‰§è¡Œ getmapper</span></span><br><span class="line">            UserMapper userDao = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            userDao.addUser(<span class="keyword">new</span> User(<span class="number">6</span>, <span class="string">"kun"</span>,<span class="string">"123"</span>));</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">//å…³é—­</span></span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// è·å¾—sqlsessionå¯¹è±¡</span></span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 1.æ‰§è¡Œ getmapper</span></span><br><span class="line">            UserMapper userDao = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            userDao.updateUser(<span class="keyword">new</span> User(<span class="number">6</span>, <span class="string">"fang"</span>,<span class="string">"123"</span>));</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">//å…³é—­</span></span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// è·å¾—sqlsessionå¯¹è±¡</span></span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 1.æ‰§è¡Œ getmapper</span></span><br><span class="line">            UserMapper userDao = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            userDao.deleteUser(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            <span class="comment">//å…³é—­</span></span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="8-Lombok"><a href="#8-Lombok" class="headerlink" title="8. Lombok"></a>8. Lombok</h1><ol>
<li><p>åœ¨IDEAä¸­å®‰è£…lombokæ’ä»¶</p>
</li>
<li><p>é…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><pre><code>@Getter and @Setter
@FieldNameConstants
@ToString
@EqualsAndHashCode
@AllArgsConstructor, @RequiredArgsConstructor and @NoArgsConstructor
@Log, @Log4j, @Log4j2, @Slf4j, @XSlf4j, @CommonsLog, @JBossLog, @Flogger, @CustomLog
@Data
@Builder
@SuperBuilder
@Singular
@Delegate
@Value
@Accessors
@Wither
@With
@SneakyThrows
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">@Data: æ— å‚æ„é€ ï¼Œgetï¼Œsetï¼ŒtoStringï¼ŒhashCode</span><br><span class="line"></span><br><span class="line">åœ¨å®ä½“ç±»ä¸ŠåŠ æ³¨è§£</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;java</span><br><span class="line">package com.nedlee.pojo;</span><br><span class="line"></span><br><span class="line">import lombok.AllArgsConstructor;</span><br><span class="line">import lombok.Data;</span><br><span class="line">import lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line">@Data</span><br><span class="line">@AllArgsConstructor</span><br><span class="line">@NoArgsConstructor</span><br><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line">    private int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private String password;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre></li>
</ol>
<h1 id="9-å¤šå¯¹ä¸€å¤„ç†"><a href="#9-å¤šå¯¹ä¸€å¤„ç†" class="headerlink" title="9. å¤šå¯¹ä¸€å¤„ç†"></a>9. å¤šå¯¹ä¸€å¤„ç†</h1><ul>
<li>å¤šä¸ªå­¦ç”Ÿ<strong>å…³è”</strong>ä¸€ä¸ªè€å¸ˆï¼ˆå¤šå¯¹ä¸€ï¼‰</li>
<li><strong>é›†åˆ</strong>ï¼ˆä¸€å¯¹å¤šï¼‰</li>
</ul>
<h3 id="1-å»ºè¡¨"><a href="#1-å»ºè¡¨" class="headerlink" title="1. å»ºè¡¨"></a>1. å»ºè¡¨</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`teacher`</span> (</span><br><span class="line">	<span class="string">`id`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">	<span class="string">`name`</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> teacher (<span class="string">`id`</span>, <span class="string">`name`</span>) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'nedlee'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`student`</span> (</span><br><span class="line">	<span class="string">`id`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">	<span class="string">`name`</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">	<span class="string">`tid`</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">	PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">	<span class="keyword">KEY</span> <span class="string">`fktid`</span> (<span class="string">`tid`</span>),</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> <span class="string">`fktid`</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (<span class="string">`tid`</span>) <span class="keyword">REFERENCES</span> <span class="string">`teacher`</span> (<span class="string">`id`</span>)</span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'xiao1'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">'xiao2'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">'xiao3'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">'xiao4'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (<span class="string">`id`</span>, <span class="string">`name`</span>, <span class="string">`tid`</span>) <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">'xiao5'</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<ol>
<li><p>æ–°å»ºå®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å­¦ç”Ÿéœ€è¦å…³è”ä¸€ä¸ªè€å¸ˆ</span></span><br><span class="line">    <span class="keyword">private</span> Teacher teacher;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å»ºç«‹Mapperæ¥å£</p>
</li>
<li><p>å»ºç«‹Mapper.xml</p>
</li>
<li><p>æµ‹è¯•æ˜¯å¦èƒ½å¤ŸæˆåŠŸ</p>
</li>
</ol>
<h3 id="2-æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#2-æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="2. æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>2. æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h3><p>StudentMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.nedlee.dao.StudentMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getStudent"</span> <span class="attr">resultMap</span>=<span class="string">"StudentTeacher"</span>&gt;</span></span><br><span class="line">      select * from student;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"StudentTeacher"</span> <span class="attr">type</span>=<span class="string">"com.nedlee.pojo.Student"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å¯¹è±¡ä½¿ç”¨assiociation--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é›†åˆç”¨collection--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">column</span>=<span class="string">"tid"</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">javaType</span>=<span class="string">"com.nedlee.pojo.Teacher"</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">select</span>=<span class="string">"getTeacher"</span>&gt;</span><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getTeacher"</span> <span class="attr">resultType</span>=<span class="string">"com.nedlee.pojo.Teacher"</span>&gt;</span></span><br><span class="line">      select * from teacher where id = #&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"><a href="#3-æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†" class="headerlink" title="3. æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"></a>3. æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> s.id <span class="keyword">sid</span>,s.name sname,t.name tname</span><br><span class="line"><span class="keyword">from</span> student s,teacher t <span class="keyword">where</span> s.tid=t.id;</span><br><span class="line">&lt;select id="getStudent2" resultMap="StudentTeacher2"&gt;</span><br><span class="line">    <span class="keyword">select</span> s.id <span class="keyword">sid</span>,s.name sname,t.name tname</span><br><span class="line">    <span class="keyword">from</span> student s,teacher t <span class="keyword">where</span> s.tid=t.id;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">&lt;resultMap id="StudentTeacher2" type="com.nedlee.pojo.Student"&gt;</span><br><span class="line">    &lt;result property="id" column="sid"&gt;&lt;/result&gt;</span><br><span class="line">    &lt;result property="name" column="sname"&gt;&lt;/result&gt;</span><br><span class="line">    &lt;association property="teacher" javaType="com.nedlee.pojo.Teacher"&gt;</span><br><span class="line">        &lt;result property="name" column="tname"&gt;&lt;/result&gt;</span><br><span class="line">    &lt;/association&gt;</span><br><span class="line"></span><br><span class="line">&lt;/resultMap&gt;</span><br></pre></td></tr></table></figure>

<p><strong>property</strong> æ˜ å°„åˆ°åˆ—ç»“æœçš„å­—æ®µæˆ–å±æ€§ã€‚</p>
<p><strong>column</strong> æ•°æ®åº“ä¸­çš„åˆ—åï¼Œæˆ–è€…æ˜¯åˆ—çš„åˆ«åã€‚</p>
<h1 id="10-ä¸€å¯¹å¤š"><a href="#10-ä¸€å¯¹å¤š" class="headerlink" title="10. ä¸€å¯¹å¤š"></a>10. ä¸€å¯¹å¤š</h1><p>ä¸€ä¸ªè€å¸ˆæ‹¥æœ‰å¤šä¸ªå­¦ç”Ÿ</p>
<p>å¯¹äºè€å¸ˆè€Œè¨€å°±æ˜¯ä¸€å¯¹å¤š</p>
<h3 id="1-ç¯å¢ƒæ­å»º"><a href="#1-ç¯å¢ƒæ­å»º" class="headerlink" title="1.ç¯å¢ƒæ­å»º"></a>1.ç¯å¢ƒæ­å»º</h3><p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; studentList;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">package</span> com.nedlee.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> tid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-æŒ‰ç…§ç»“æœæŸ¥è¯¢"><a href="#2-æŒ‰ç…§ç»“æœæŸ¥è¯¢" class="headerlink" title="2. æŒ‰ç…§ç»“æœæŸ¥è¯¢"></a>2. æŒ‰ç…§ç»“æœæŸ¥è¯¢</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getTeacher"</span> <span class="attr">resultMap</span>=<span class="string">"TeacherStudent"</span>&gt;</span></span><br><span class="line">    select s.id sid, s.name sname, t.name tname, t.id tid</span><br><span class="line">    from student s, teacher t</span><br><span class="line">    where s.tid = t.id and t.id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"TeacherStudent"</span> <span class="attr">type</span>=<span class="string">"com.nedlee.pojo.Teacher"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"tid"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"tname"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é›†åˆä¸­çš„æ³›å‹ä¿¡æ¯ï¼Œæˆ‘ä»¬ç”¨oftypeè·å–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"studentList"</span> <span class="attr">ofType</span>=<span class="string">"com.nedlee.pojo.Student"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"sid"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"sname"</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#3-æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="3. æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>3. æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getTeacher2"</span> <span class="attr">resultMap</span>=<span class="string">"TeacherStudent2"</span>&gt;</span></span><br><span class="line">    select * from mybatis.teacher where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"TeacherStudent2"</span> <span class="attr">type</span>=<span class="string">"com.nedlee.pojo.Teacher"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"studentList"</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">javaType</span>=<span class="string">"ArrayList"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">ofType</span>=<span class="string">"com.nedlee.pojo.Student"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">select</span>=<span class="string">"getStudentByTeacherId"</span>&gt;</span><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getStudentByTeacherId"</span> <span class="attr">resultType</span>=<span class="string">"com.nedlee.pojo.Student"</span>&gt;</span></span><br><span class="line">    select * from mybatis.student where tid = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ol>
<li>å…³è” - association å¤šå¯¹ä¸€</li>
<li>é›†åˆ - collection ä¸€å¯¹å¤š</li>
<li>javaType &amp; ofType<ol>
<li>JavaTypeç”¨æ¥æŒ‡å®šå®ä½“ä¸­å±æ€§ç±»å‹</li>
<li>ofTypeæ˜ å°„åˆ°listä¸­çš„ç±»å‹ï¼Œæ³›å‹ä¸­çš„çº¦æŸç±»å‹</li>
</ol>
</li>
</ol>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>ä¿è¯sqlå¯è¯»æ€§ï¼Œå°½é‡ä¿è¯é€šä¿—æ˜“æ‡‚</li>
<li>æ³¨æ„å­—æ®µé—®é¢˜</li>
<li>å¦‚æœé—®é¢˜ä¸å¥½æ’æŸ¥é”™è¯¯ï¼Œä½¿ç”¨æ—¥å¿—</li>
</ul>
<h1 id="11-åŠ¨æ€sql"><a href="#11-åŠ¨æ€sql" class="headerlink" title="11. åŠ¨æ€sql"></a>11. åŠ¨æ€sql</h1><p>åŠ¨æ€sqlï¼šæ ¹æ®ä¸åŒçš„æ¡ä»¶ç”Ÿæˆä¸åŒçš„SQLè¯­å¥</p>
<h3 id="1-æ­å»ºç¯å¢ƒ"><a href="#1-æ­å»ºç¯å¢ƒ" class="headerlink" title="1. æ­å»ºç¯å¢ƒ"></a>1. æ­å»ºç¯å¢ƒ</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">`blog`</span>(</span><br><span class="line">	<span class="string">`id`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'åšå®¢id'</span>,</span><br><span class="line">    <span class="string">`title`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'åšå®¢æ ‡é¢˜'</span>,</span><br><span class="line">    <span class="string">`author`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'åšå®¢ä½œè€…'</span>,</span><br><span class="line">    <span class="string">`create_time`</span> datetime <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'åˆ›å»ºæ—¶é—´'</span>,</span><br><span class="line">    <span class="string">`views`</span> <span class="built_in">int</span>(<span class="number">30</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'æµè§ˆé‡'</span></span><br><span class="line">	)<span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8</span><br></pre></td></tr></table></figure>

<p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Blog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> views;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¸å¿ƒé…ç½®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Mapper.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.nedlee.mapper.BlogMapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addBlog"</span> <span class="attr">parameterType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">        insert into mybatis.blog (id, title, author, create_time, views) values</span><br><span class="line">        (#&#123;id&#125;, #&#123;title&#125;, #&#123;author&#125;, #&#123;create_time&#125;, #&#123;views&#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ–°å»ºéšæœºç”ŸæˆIDåŒ…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"all"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IDUtiles</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getId</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> UUID.randomUUID().toString().replaceAll(<span class="string">"-"</span>,<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ç±»ï¼šæ·»åŠ æ•°æ®</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.nedlee.mapper.BlogMapper;</span><br><span class="line"><span class="keyword">import</span> com.nedlee.pojo.Blog;</span><br><span class="line"><span class="keyword">import</span> com.nedlee.utils.IDUtiles;</span><br><span class="line"><span class="keyword">import</span> com.nedlee.utils.MybatisUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBlog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">        BlogMapper blogMapper = sqlSession.getMapper(BlogMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        Blog blog = <span class="keyword">new</span> Blog();</span><br><span class="line">        blog.setId(IDUtiles.getId());</span><br><span class="line">        blog.setAuthor(<span class="string">"nedleedongun"</span>);</span><br><span class="line">        blog.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">        blog.setViews(<span class="number">999</span>);</span><br><span class="line">        blog.setTitle(<span class="string">"first"</span>);</span><br><span class="line"></span><br><span class="line">        blogMapper.addBlog(blog);</span><br><span class="line"></span><br><span class="line">        blog.setId(IDUtiles.getId());</span><br><span class="line">        blog.setTitle(<span class="string">"second"</span>);</span><br><span class="line">        blogMapper.addBlog(blog);</span><br><span class="line"></span><br><span class="line">        blog.setId(IDUtiles.getId());</span><br><span class="line">        blog.setTitle(<span class="string">"third"</span>);</span><br><span class="line">        blogMapper.addBlog(blog);</span><br><span class="line"></span><br><span class="line">        blog.setId(IDUtiles.getId());</span><br><span class="line">        blog.setTitle(<span class="string">"forth"</span>);</span><br><span class="line">        blogMapper.addBlog(blog);</span><br><span class="line"></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-if"><a href="#2-if" class="headerlink" title="2. if"></a>2. if</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryBlogIF"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog where 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">        and title = #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != author"</span>&gt;</span></span><br><span class="line">        and author = #&#123;author&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>test</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">queryBlogIF</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">    BlogMapper blogMapper = sqlSession.getMapper(BlogMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//        map.put("title", "second");</span></span><br><span class="line">    map.put(<span class="string">"author"</span>, <span class="string">"nedleedongun"</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;Blog&gt; list = blogMapper.queryBlogIF(map);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Blog blog : list) &#123;</span><br><span class="line">        System.out.println(blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-chooseã€whenã€otherwise"><a href="#3-chooseã€whenã€otherwise" class="headerlink" title="3. chooseã€whenã€otherwise"></a>3. chooseã€whenã€otherwise</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryBlogchoose"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">                title = #&#123;title&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">                and author = #&#123;author&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                and views = #&#123;views&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-trimã€whereã€set"><a href="#4-trimã€whereã€set" class="headerlink" title="4. trimã€whereã€set"></a>4. trimã€whereã€set</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateBlog"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">    update mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">            title = #&#123;title&#125;,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">            author = #&#123;author&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>trim å¯ä»¥è‡ªå®šä¹‰</p>
<h3 id="SQLç‰‡æ®µ"><a href="#SQLç‰‡æ®µ" class="headerlink" title="SQLç‰‡æ®µ"></a>SQLç‰‡æ®µ</h3><p>æœ‰äº›æ—¶å€™æˆ‘ä»¬æœ‰ä¸€äº›å…¬å…±éƒ¨åˆ†</p>
<ol>
<li>ä½¿ç”¨sqlä¾¿ç­¾æŠ½å–å…¬å…±éƒ¨åˆ†</li>
<li>åœ¨ä½¿ç”¨çš„åœ°æ–¹ä½¿ç”¨includeæ ‡ç­¾</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"if-title-author"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">        title = #&#123;title&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">        and author = #&#123;author&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryBlogIF"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"if-title-author"</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š</p>
<ul>
<li>æœ€å¥½åŸºäºå•è¡¨</li>
<li>sqlé‡Œä¸è¦å­˜åœ¨whereæ ‡ç­¾</li>
</ul>
<h3 id="5-for-each"><a href="#5-for-each" class="headerlink" title="5. for-each"></a>5. for-each</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--idsæ˜¯ä¼ çš„ï¼Œ#&#123;id&#125;æ˜¯éå†çš„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryBlogForeach"</span> <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"ids"</span> <span class="attr">item</span>=<span class="string">"id"</span> <span class="attr">open</span>=<span class="string">"and ("</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">close</span>=<span class="string">")"</span> <span class="attr">separator</span>=<span class="string">"or"</span>&gt;</span></span><br><span class="line">            id=#&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>test</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">queryBlogForeach</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">    BlogMapper blogMapper = sqlSession.getMapper(BlogMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line"></span><br><span class="line">    ArrayList&lt;Integer&gt; ids = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">    ids.add(<span class="number">1</span>);</span><br><span class="line">    ids.add(<span class="number">3</span>);</span><br><span class="line">    map.put(<span class="string">"ids"</span>,ids);</span><br><span class="line"></span><br><span class="line">    List&lt;Blog&gt; list = blogMapper.queryBlogForeach(map);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Blog blog : list) &#123;</span><br><span class="line">        System.out.println(blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sqlSession.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="12-ç¼“å­˜ï¼ˆäº†è§£ï¼‰"><a href="#12-ç¼“å­˜ï¼ˆäº†è§£ï¼‰" class="headerlink" title="12. ç¼“å­˜ï¼ˆäº†è§£ï¼‰"></a>12. ç¼“å­˜ï¼ˆäº†è§£ï¼‰</h1><h3 id="1-ä¸€çº§ç¼“å­˜"><a href="#1-ä¸€çº§ç¼“å­˜" class="headerlink" title="1. ä¸€çº§ç¼“å­˜"></a>1. ä¸€çº§ç¼“å­˜</h3><ol>
<li>å¼€å¯æ—¥å¿—</li>
<li>æµ‹è¯•ä¸€ä¸ªsessionä¸­æŸ¥è¯¢ä¸¤æ¬¡ç›¸åŒè®°å½•ã€‚</li>
</ol>
<p>ç¼“å­˜å¤±æ•ˆï¼š</p>
<ul>
<li>æ˜ å°„è¯­å¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰ insertã€update å’Œ delete è¯­å¥ä¼šåˆ·æ–°ç¼“å­˜ã€‚</li>
<li>æŸ¥è¯¢ä¸åŒçš„mapper.xml</li>
<li>æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜</li>
</ul>
<p>ä¸€çº§ç¼“å­˜é»˜è®¤å¼€å¯ï¼Œåªåœ¨ä¸€æ¬¡sqlseesionä¸­æœ‰æ•ˆ</p>
<h3 id="2-äºŒçº§ç¼“å­˜"><a href="#2-äºŒçº§ç¼“å­˜" class="headerlink" title="2. äºŒçº§ç¼“å­˜"></a>2. äºŒçº§ç¼“å­˜</h3><ol>
<li>å¼€å¯å…¨å±€ç¼“å­˜</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>åœ¨å½“å‰mapper.xmlä¸­ä½¿ç”¨äºŒçº§ç¼“å­˜</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">"FIFO"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">flushInterval</span>=<span class="string">"60000"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">size</span>=<span class="string">"512"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">readOnly</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>test</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqlSession sqlSession = MybatisUtils.getSqlSession();</span><br><span class="line">    SqlSession sqlSession1 = MybatisUtils.getSqlSession();</span><br><span class="line">    UserMapper userMapper = sqlSession.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    User user = userMapper.queryUserByid(<span class="number">1</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    sqlSession.close();</span><br><span class="line"></span><br><span class="line">    UserMapper userMapper1 = sqlSession1.getMapper(UserMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    User user1 = userMapper1.queryUserByid(<span class="number">1</span>);</span><br><span class="line">    System.out.println(user1);</span><br><span class="line">    System.out.println(user==user1);</span><br><span class="line">    sqlSession1.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åªç”¨cacheæ—¶åŠ åºåˆ—åŒ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.nedlee.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(<span class="keyword">int</span> id, String name, String pwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.pwd = pwd;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°ç»“ï¼š</p>
<ul>
<li>åªæœ‰å¼€å¯äº†äºŒçº§ç¼“å­˜ï¼Œåœ¨Mapperä¸‹æœ‰æ•ˆ</li>
<li>æ‰€æœ‰æ•°æ®éƒ½ä¼šå…ˆæ”¾åœ¨ä¸€çº§ç¼“å­˜</li>
<li>åªæœ‰å½“å›è¯æäº¤ï¼Œæˆ–è€…å…³é—­çš„æ—¶å€™ï¼Œæ‰ä¼šæäº¤åˆ°äºŒçº§ç¼“å­˜</li>
</ul>
<h3 id="3-è‡ªå®šä¹‰ç¼“å­˜-ehcache"><a href="#3-è‡ªå®šä¹‰ç¼“å­˜-ehcache" class="headerlink" title="3. è‡ªå®šä¹‰ç¼“å­˜-ehcache"></a>3. è‡ªå®šä¹‰ç¼“å­˜-ehcache</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.caches/mybatis-ehcache --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.caches<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ehcache.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ehcache</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">"http://ehcache.org/ehcache.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">updateCheck</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       diskStoreï¼šä¸ºç¼“å­˜è·¯å¾„ï¼Œehcacheåˆ†ä¸ºå†…å­˜å’Œç£ç›˜ä¸¤çº§ï¼Œæ­¤å±æ€§å®šä¹‰ç£ç›˜çš„ç¼“å­˜ä½ç½®ã€‚å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">       user.home â€“ ç”¨æˆ·ä¸»ç›®å½•</span></span><br><span class="line"><span class="comment">       user.dir  â€“ ç”¨æˆ·å½“å‰å·¥ä½œç›®å½•</span></span><br><span class="line"><span class="comment">       java.io.tmpdir â€“ é»˜è®¤ä¸´æ—¶æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">"java.io.tmpdir/Tmp_EhCache"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       defaultCacheï¼šé»˜è®¤ç¼“å­˜ç­–ç•¥ï¼Œå½“ehcacheæ‰¾ä¸åˆ°å®šä¹‰çš„ç¼“å­˜æ—¶ï¼Œåˆ™ä½¿ç”¨è¿™ä¸ªç¼“å­˜ç­–ç•¥ã€‚åªèƒ½å®šä¹‰ä¸€ä¸ªã€‚</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      name:ç¼“å­˜åç§°ã€‚</span></span><br><span class="line"><span class="comment">      maxElementsInMemory:ç¼“å­˜æœ€å¤§æ•°ç›®</span></span><br><span class="line"><span class="comment">      maxElementsOnDiskï¼šç¡¬ç›˜æœ€å¤§ç¼“å­˜ä¸ªæ•°ã€‚</span></span><br><span class="line"><span class="comment">      eternal:å¯¹è±¡æ˜¯å¦æ°¸ä¹…æœ‰æ•ˆï¼Œä¸€ä½†è®¾ç½®äº†ï¼Œtimeoutå°†ä¸èµ·ä½œç”¨ã€‚</span></span><br><span class="line"><span class="comment">      overflowToDisk:æ˜¯å¦ä¿å­˜åˆ°ç£ç›˜ï¼Œå½“ç³»ç»Ÿå½“æœºæ—¶</span></span><br><span class="line"><span class="comment">      timeToIdleSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰çš„å…è®¸é—²ç½®æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯é—²ç½®æ—¶é—´æ— ç©·å¤§ã€‚</span></span><br><span class="line"><span class="comment">      timeToLiveSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰å…è®¸å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚æœ€å¤§æ—¶é—´ä»‹äºåˆ›å»ºæ—¶é—´å’Œå¤±æ•ˆæ—¶é—´ä¹‹é—´ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯0.ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡å­˜æ´»æ—¶é—´æ— ç©·å¤§ã€‚</span></span><br><span class="line"><span class="comment">      diskPersistentï¼šæ˜¯å¦ç¼“å­˜è™šæ‹Ÿæœºé‡å¯æœŸæ•°æ® Whether the disk store persists between restarts of the Virtual Machine. The default value is false.</span></span><br><span class="line"><span class="comment">      diskSpoolBufferSizeMBï¼šè¿™ä¸ªå‚æ•°è®¾ç½®DiskStoreï¼ˆç£ç›˜ç¼“å­˜ï¼‰çš„ç¼“å­˜åŒºå¤§å°ã€‚é»˜è®¤æ˜¯30MBã€‚æ¯ä¸ªCacheéƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒºã€‚</span></span><br><span class="line"><span class="comment">      diskExpiryThreadIntervalSecondsï¼šç£ç›˜å¤±æ•ˆçº¿ç¨‹è¿è¡Œæ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯120ç§’ã€‚</span></span><br><span class="line"><span class="comment">      memoryStoreEvictionPolicyï¼šå½“è¾¾åˆ°maxElementsInMemoryé™åˆ¶æ—¶ï¼ŒEhcacheå°†ä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥å»æ¸…ç†å†…å­˜ã€‚é»˜è®¤ç­–ç•¥æ˜¯LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€‚ä½ å¯ä»¥è®¾ç½®ä¸ºFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æˆ–æ˜¯LFUï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">      clearOnFlushï¼šå†…å­˜æ•°é‡æœ€å¤§æ—¶æ˜¯å¦æ¸…é™¤ã€‚</span></span><br><span class="line"><span class="comment">      memoryStoreEvictionPolicy:å¯é€‰ç­–ç•¥æœ‰ï¼šLRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼Œé»˜è®¤ç­–ç•¥ï¼‰ã€FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ã€LFUï¼ˆæœ€å°‘è®¿é—®æ¬¡æ•°ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">      FIFOï¼Œfirst in first outï¼Œè¿™ä¸ªæ˜¯å¤§å®¶æœ€ç†Ÿçš„ï¼Œå…ˆè¿›å…ˆå‡ºã€‚</span></span><br><span class="line"><span class="comment">      LFUï¼Œ Less Frequently Usedï¼Œå°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­ä½¿ç”¨çš„ç­–ç•¥ï¼Œç›´ç™½ä¸€ç‚¹å°±æ˜¯è®²ä¸€ç›´ä»¥æ¥æœ€å°‘è¢«ä½¿ç”¨çš„ã€‚å¦‚ä¸Šé¢æ‰€è®²ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªhitå±æ€§ï¼Œhitå€¼æœ€å°çš„å°†ä¼šè¢«æ¸…å‡ºç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment">      LRUï¼ŒLeast Recently Usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå½“ç¼“å­˜å®¹é‡æ»¡äº†ï¼Œè€Œåˆéœ€è¦è…¾å‡ºåœ°æ–¹æ¥ç¼“å­˜æ–°çš„å…ƒç´ çš„æ—¶å€™ï¼Œé‚£ä¹ˆç°æœ‰ç¼“å­˜å…ƒç´ ä¸­æ—¶é—´æˆ³ç¦»å½“å‰æ—¶é—´æœ€è¿œçš„å…ƒç´ å°†è¢«æ¸…å‡ºç¼“å­˜ã€‚</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">defaultCache</span></span></span><br><span class="line"><span class="tag">            <span class="attr">eternal</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">maxElementsInMemory</span>=<span class="string">"10000"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">overflowToDisk</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">diskPersistent</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">timeToIdleSeconds</span>=<span class="string">"1800"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">timeToLiveSeconds</span>=<span class="string">"259200"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">memoryStoreEvictionPolicy</span>=<span class="string">"LRU"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">cache</span></span></span><br><span class="line"><span class="tag">            <span class="attr">name</span>=<span class="string">"cloud_user"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">eternal</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">maxElementsInMemory</span>=<span class="string">"5000"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">overflowToDisk</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">diskPersistent</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">timeToIdleSeconds</span>=<span class="string">"1800"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">timeToLiveSeconds</span>=<span class="string">"1800"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">memoryStoreEvictionPolicy</span>=<span class="string">"LRU"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>æ¡†æ¶å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>javaä¸­çš„å¼ºåˆ¶ç±»å‹è½¬æ¢</title>
    <url>/2020/05/12/java%E4%B8%AD%E7%9A%84%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h4 id="ç»è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢ä»¥åï¼Œå˜é‡a-bçš„å€¼åˆ†åˆ«ä¸ºï¼ˆ128-128-ï¼‰short-a-128-byte-b-byte-a"><a href="#ç»è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢ä»¥åï¼Œå˜é‡a-bçš„å€¼åˆ†åˆ«ä¸ºï¼ˆ128-128-ï¼‰short-a-128-byte-b-byte-a" class="headerlink" title="ç»è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢ä»¥åï¼Œå˜é‡a, bçš„å€¼åˆ†åˆ«ä¸ºï¼ˆ128 -128 ï¼‰short a = 128; byte b = (byte) a;"></a>ç»è¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢ä»¥åï¼Œå˜é‡a, bçš„å€¼åˆ†åˆ«ä¸ºï¼ˆ128 -128 ï¼‰<code>short a = 128; byte b = (byte) a;</code></h4><p>1ã€Javaä¸­ç”¨è¡¥ç å½¢å¼è¡¨ç¤º</p>
<p>2ã€ç¬¬ä¸€ä½æ­£è´Ÿä½ï¼Œ1è¡¨ç¤ºè´Ÿï¼Œ0è¡¨ç¤ºæ­£ã€‚</p>
<p>3ã€åŸç ï¼šä¸€ä¸ªæ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚</p>
<p>â€‹         3çš„åŸç 00000011  -3çš„ åŸç  10000011</p>
<p>4ã€åç ï¼šè´Ÿæ•°åŸç æŒ‰ä½å–åï¼ˆç¬¦å·ä½ä¸å˜ï¼‰ã€‚æ­£æ•°åŸç æœ¬èº«ã€‚</p>
<p>â€‹        3çš„åç 00000011  -3çš„åç 11111100</p>
<p>5ã€è¡¥ç ï¼šæ­£æ•°æ˜¯åŸç æœ¬èº«ã€‚è´Ÿæ•°åç åŠ 1ã€‚</p>
<p>â€‹         3çš„è¡¥ç æ˜¯00000011 -3çš„è¡¥ç æ˜¯11111101</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>intå 4ä¸ªå­—èŠ‚ï¼Œ32ä½</p>
<p>byteå 1ä¸ªå­—èŠ‚ï¼Œ8ä½</p>
<p>æ‰€ä»¥å¼ºè½¬æ—¶ä¼šæˆªæ–­ã€‚å‰24ä½</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“</p>
<p>åœ¨å†…å­˜ä¸­è¡¨ç¤ºå½¢å¼ï¼ˆ æ³¨æ„javaä¸­æ˜¯ä»¥è¡¥ç è¡¨ç¤ºä¸€ä¸ªæ•°ï¼Œæ‰€ä»¥è¡¨ç¤ºå½¢å¼æ˜¯è¡¥ç ï¼Œä¸æ˜¯åŸç ï¼ ï¼‰ï¼š</p>
<p>int a = 3     00000000 00000000 00000000 00000011 ï¼ˆå¼ºè½¬byteæ—¶å‰é¢24ä¸ª0è¢«æˆªæ–­ï¼‰</p>
<p>byte b = 3   00000011</p>
<p>int a = -3    11111111 11111111  11111111  11111101 ï¼ˆå¼ºè½¬byteæ—¶å‰é¢24ä¸ª1è¢«æˆªæ–­ï¼‰</p>
<p>byte b = -3   11111101</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>å·²çŸ¥è´Ÿæ•°çš„è¡¥ç ï¼Œæ±‚è´Ÿæ•°ï¼š</p>
<p>è¡¥ç -1=åç ï¼Œåç æŒ‰ä½å–å=è¯¥è´Ÿæ•°ç»å¯¹å€¼</p>
<p>å·²çŸ¥è´Ÿæ•°ï¼Œæ±‚è´Ÿæ•°çš„è¡¥ç ï¼š</p>
<p>1ã€è´Ÿæ•°åŸç é™¤äº†ç¬¦å·ä½ï¼ŒæŒ‰ä½å–åï¼ˆä¸å«ç¬¦å·ä½ï¼‰ï¼ŒåŠ 1ã€‚</p>
<p>2ã€è´Ÿæ•°ç»å¯¹å€¼çš„è¡¥ç ï¼ˆä¹Ÿå°±æ˜¯åŸç ï¼‰ï¼ŒæŒ‰ä½å–åï¼ˆå«ç¬¦å·ä½ï¼‰ï¼ŒåŠ 1</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>ä¾‹å­ï¼š</p>
<p>java int 128è½¬ä¸ºbyteï¼Œå€¼ï¼š</p>
<p>128ä¸ºæ­£æ•°ï¼Œè¡¥ç ä¸º10000000ï¼ˆå‰é¢24ä¸ª0çœç•¥ï¼‰ï¼Œå˜æˆbyteï¼Œåªå‰©ä¸‹10000000ï¼ˆbyteä¸º1ä¸ªå­—èŠ‚ï¼‰ï¼Œå› ä¸ºå¼€å¤´æ˜¯1ï¼Œæ‰€ä»¥ä¸ºè´Ÿæ•°ã€‚å³1ä¸ªè´Ÿæ•°çš„è¡¥ç æ˜¯10000000ã€‚åç æ˜¯01111111ï¼ŒåŸç æ˜¯1000000ã€‚æ˜¯128.å› ä¸ºæ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥æ˜¯-128ã€‚</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>javaåˆ›å»ºå¯¹è±¡çš„å‡ ç§æ–¹å¼</title>
    <url>/2020/05/12/java%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h4 id="javaæœ‰5ç§æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ï¼š"><a href="#javaæœ‰5ç§æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ï¼š" class="headerlink" title="javaæœ‰5ç§æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ï¼š"></a>javaæœ‰5ç§æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ï¼š</h4><p>1ã€ä½¿ç”¨ new å…³é”®å­—ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š <code>ObjectName obj = new ObjectName();</code></p>
<p>2ã€ä½¿ç”¨åå°„çš„Classç±»çš„newInstance()æ–¹æ³•ï¼š<code>ObjectName obj = ObjectName.class.newInstance();</code></p>
<p>3ã€ä½¿ç”¨åå°„çš„Constructorç±»çš„newInstance()æ–¹æ³•ï¼š <code>ObjectName obj = ObjectName.class.getConstructor.newInstance();</code></p>
<p> 4ã€ä½¿ç”¨å¯¹è±¡å…‹éš†clone()æ–¹æ³•ï¼š<code>ObjectName obj = obj.clone();</code></p>
<p>5ã€ä½¿ç”¨ååºåˆ—åŒ–ï¼ˆObjectInputStreamï¼‰çš„readObject()æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> (ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(FILE_NAME))) &#123; ObjectName obj = ois.readObject(); &#125;</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>javaå­çˆ¶ç±»æ„é€ å™¨çš„è°ƒç”¨</title>
    <url>/2020/05/13/java%E5%AD%90%E7%88%B6%E7%B1%BB%E6%9E%84%E9%80%A0%E5%99%A8%E7%9A%84%E8%B0%83%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>â€‹        åœ¨è°ƒç”¨å­ç±»æ„é€ å™¨ä¹‹å‰ï¼Œä¼šå…ˆè°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Œå½“å­ç±»æ„é€ å™¨ä¸­æ²¡æœ‰ä½¿ç”¨â€super(å‚æ•°æˆ–æ— å‚æ•°)â€æŒ‡å®šè°ƒç”¨çˆ¶ç±»æ„é€ å™¨æ—¶ï¼Œæ˜¯é»˜è®¤è°ƒç”¨çˆ¶ç±»çš„æ— å‚æ„é€ å™¨ï¼Œå¦‚æœçˆ¶ç±»ä¸­åŒ…å«æœ‰å‚æ„é€ å™¨ï¼Œå´æ²¡æœ‰æ— å‚æ„é€ å™¨ï¼Œåˆ™åœ¨å­ç±»æ„é€ å™¨ä¸­ä¸€å®šè¦ä½¿ç”¨â€œsuper(å‚æ•°)â€æŒ‡å®šè°ƒç”¨çˆ¶ç±»çš„æœ‰å‚æ„é€ å™¨ï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™ã€‚</p>
<h5 id="å­çˆ¶ç±»ä»£ç æ‰§è¡Œé¡ºåº"><a href="#å­çˆ¶ç±»ä»£ç æ‰§è¡Œé¡ºåº" class="headerlink" title="å­çˆ¶ç±»ä»£ç æ‰§è¡Œé¡ºåº"></a>å­çˆ¶ç±»ä»£ç æ‰§è¡Œé¡ºåº</h5><p>çˆ¶ç±»é™æ€ä»£ç å— -&gt;å­ç±»é™æ€ä»£ç å— -&gt;çˆ¶ç±»éé™æ€ä»£ç å— -&gt; çˆ¶ç±»æ„é€ å‡½æ•° -&gt; å­ç±»éé™æ€ä»£ç å— -&gt; å­ç±»æ„é€ å‡½æ•°ã€‚</p>
<p>æ¡ˆä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Father</span> </span>&#123;  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span> &#123;  System.out.println(<span class="string">"çˆ¶ç±»é™æ€ä»£ç å—"</span>);    &#125;</span><br><span class="line"></span><br><span class="line">        &#123; System.out.println(<span class="string">"çˆ¶ç±»éé™æ€ä»£ç å—"</span>);  &#125; </span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Father</span><span class="params">()</span></span>&#123;  System.out.println(<span class="string">"çˆ¶ç±»æ„é€ å‡½æ•°"</span>);    &#125;   </span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span></span>&#123; </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span> &#123;  System.out.println(<span class="string">"å­ç±»é™æ€ä»£ç å—"</span>);    &#125;</span><br><span class="line"></span><br><span class="line">      &#123;  System.out.println(<span class="string">"å­ç±»éé™æ€ä»£ç å—"</span>);    &#125; </span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Son</span><span class="params">()</span></span>&#123; System.out.println(<span class="string">"å­ç±»æ„é€ å‡½æ•°"</span>);    &#125; </span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Son son = <span class="keyword">new</span> Son();   </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">ç»“æœä¸ºï¼š   çˆ¶ç±»é™æ€ä»£ç å—</span><br><span class="line">           å­ç±»é™æ€ä»£ç å—</span><br><span class="line">           çˆ¶ç±»éé™æ€ä»£ç å—</span><br><span class="line">           çˆ¶ç±»æ„é€ å‡½æ•°</span><br><span class="line">           å­ç±»éé™æ€ä»£ç å—</span><br><span class="line">           å­ç±»æ„é€ å‡½æ•°</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>synchronizedå’Œlockçš„åŒºåˆ«</title>
    <url>/2020/05/16/synchronized%E5%92%8Clock%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h4 id="1-ä½œç”¨çš„ä½ç½®ä¸åŒ"><a href="#1-ä½œç”¨çš„ä½ç½®ä¸åŒ" class="headerlink" title="1.ä½œç”¨çš„ä½ç½®ä¸åŒ"></a>1.ä½œç”¨çš„ä½ç½®ä¸åŒ</h4><p>synchronizedå¯ä»¥ç»™æ–¹æ³•ï¼Œä»£ç å—åŠ é”</p>
<p>lockåªèƒ½ç»™ä»£ç å—åŠ é”</p>
<h4 id="2-é”çš„è·å–é”å’Œé‡Šæ”¾æœºåˆ¶ä¸åŒ"><a href="#2-é”çš„è·å–é”å’Œé‡Šæ”¾æœºåˆ¶ä¸åŒ" class="headerlink" title="2.é”çš„è·å–é”å’Œé‡Šæ”¾æœºåˆ¶ä¸åŒ"></a>2.é”çš„è·å–é”å’Œé‡Šæ”¾æœºåˆ¶ä¸åŒ</h4><p>synchronizedæ— éœ€æ‰‹åŠ¨è·å–é”å’Œé‡Šæ”¾é”ï¼Œå‘ç”Ÿå¼‚å¸¸ä¼šè‡ªåŠ¨è§£é”ï¼Œä¸ä¼šå‡ºç°æ­»é”ã€‚</p>
<p>lockéœ€è¦è‡ªå·±åŠ é”å’Œé‡Šæ”¾é”ï¼Œå¦‚lock()å’Œunlock()ï¼Œå¦‚æœå¿˜è®°ä½¿ç”¨unlock()ï¼Œåˆ™ä¼šå‡ºç°æ­»é”ï¼Œ</p>
<p>æ‰€ä»¥ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šåœ¨finallyé‡Œé¢ä½¿ç”¨unlock().</p>
<h4 id="3-locké”çš„ç‰¹æ®Šè¦æ±‚"><a href="#3-locké”çš„ç‰¹æ®Šè¦æ±‚" class="headerlink" title="3.locké”çš„ç‰¹æ®Šè¦æ±‚"></a>3.locké”çš„ç‰¹æ®Šè¦æ±‚</h4><p>//æ˜ç¡®é‡‡ç”¨äººå·¥çš„æ–¹å¼æ¥ä¸Šé”</p>
<p>lock.lock();</p>
<p>//æ˜ç¡®é‡‡ç”¨æ‰‹å·¥çš„æ–¹å¼æ¥é‡Šæ”¾é”</p>
<p>lock.unlock();</p>
<h4 id="4-å…³äºsynchronized"><a href="#4-å…³äºsynchronized" class="headerlink" title="4.å…³äºsynchronized"></a>4.å…³äºsynchronized</h4><p>synchronizedä¿®é¥°æˆå‘˜æ–¹æ³•æ—¶ï¼Œé»˜è®¤çš„é”å¯¹è±¡ï¼Œå°±æ˜¯å½“å‰å¯¹è±¡</p>
<p>synchronizedä¿®é¥°é™æ€æ–¹æ³•æ—¶ï¼Œé»˜è®¤çš„é”å¯¹è±¡ï¼Œå½“å‰ç±»çš„classå¯¹è±¡ï¼Œæ¯”å¦‚User.class</p>
<p>synchronizedä¿®é¥°ä»£ç å—æ—¶ï¼Œå¯ä»¥è‡ªå·±æ¥è®¾ç½®é”å¯¹è±¡ï¼Œæ¯”å¦‚</p>
<p>synchronized(this){</p>
<p>//çº¿ç¨‹è¿›å…¥ï¼Œå°±è‡ªåŠ¨è·å–åˆ°é”</p>
<p>//çº¿ç¨‹æ‰§è¡Œç»“æŸï¼Œè‡ªåŠ¨é‡Šæ”¾é”</p>
<p>}</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>äºŒå‰æ ‘æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦</title>
    <url>/2020/05/12/%E4%BA%8C%E5%8F%89%E6%A0%91%E6%9F%A5%E6%89%BE%E7%9A%84%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h4 id="äºŒå‰æ ‘æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦"><a href="#äºŒå‰æ ‘æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦" class="headerlink" title="äºŒå‰æ ‘æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦"></a>äºŒå‰æ ‘æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦</h4><p>â€‹        ç»™å®šå€¼çš„æ¯”è¾ƒæ¬¡æ•°ç­‰äºç»™å®šå€¼èŠ‚ç‚¹åœ¨äºŒå‰æ’åºæ ‘ä¸­çš„å±‚æ•°ã€‚å¦‚æœäºŒå‰æ’åºæ ‘æ˜¯å¹³è¡¡çš„ï¼Œåˆ™nä¸ªèŠ‚ç‚¹çš„äºŒå‰æ’åºæ ‘çš„é«˜åº¦ä¸ºLog2(n+1),å…¶æŸ¥æ‰¾æ•ˆç‡ä¸ºO(Log2n)ï¼Œè¿‘ä¼¼äºæŠ˜åŠæŸ¥æ‰¾ã€‚å¦‚æœäºŒå‰æ’åºæ ‘å®Œå…¨ä¸å¹³è¡¡ï¼Œåˆ™å…¶æ·±åº¦å¯è¾¾åˆ°nï¼ŒæŸ¥æ‰¾æ•ˆç‡ä¸ºO(n)ï¼Œé€€åŒ–ä¸ºé¡ºåºæŸ¥æ‰¾ã€‚ä¸€èˆ¬çš„ï¼ŒäºŒå‰æ’åºæ ‘çš„æŸ¥æ‰¾æ€§èƒ½åœ¨O(Log2n)åˆ°O(n)ä¹‹é—´ã€‚å› æ­¤ï¼Œä¸ºäº†è·å¾—è¾ƒå¥½çš„æŸ¥æ‰¾æ€§èƒ½ï¼Œå°±è¦æ„é€ ä¸€æ£µå¹³è¡¡çš„äºŒå‰æ’åºæ ‘ã€‚</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»€ä¹ˆæ“ä½œä¼šä½¿å¾—å½“å‰çº¿ç¨‹åœæ­¢ï¼Ÿ</title>
    <url>/2020/05/12/%E4%BB%80%E4%B9%88%E6%93%8D%E4%BD%9C%E4%BC%9A%E4%BD%BF%E5%BE%97%E5%BD%93%E5%89%8D%E7%BA%BF%E7%A8%8B%E5%81%9C%E6%AD%A2%EF%BC%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>Aï¼šä¸€ä¸ªInterruptedException å¼‚å¸¸è¢«æ•è· å¤§å®¶éƒ½çŸ¥é“çš„å˜› ï¼ˆä¸€èˆ¬é€šè¿‡interruptæ–¹æ³• ä¸­æ–­çº¿ç¨‹ï¼‰ å¦‚æœæŠ“åˆ°ä¸€ä¸ªçº¿ç¨‹ éƒ½ä¼šå…³è¿›catché‡Œé¢ ç„¶åä¸­æ–­å½“å‰æ“ä½œã€‚</p>
<p>Bï¼šçº¿ç¨‹æ‰§è¡Œäº†wait()æ–¹æ³•ã€‚  çº¿ç¨‹ä½¿ç”¨äº†waitæ–¹æ³•ï¼Œä¼šå¼ºè¡Œæ‰“æ–­å½“å‰æ“ä½œï¼Œï¼ˆæš‚åœçŠ¶æ€ï¼Œä¸ä¼šä¸­æ–­çº¿ç¨‹ï¼‰ è¿›å…¥é˜»å¡ï¼ˆæš‚åœï¼‰çŠ¶æ€ï¼Œç„¶åéœ€è¦notifyæ–¹æ³•æˆ–notifyAllæ–¹æ³•æ‰èƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚</p>
<p>Cï¼šå½“å‰çº¿ç¨‹åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„çº¿ç¨‹ã€‚  æ–°åˆ›å»ºçš„çº¿ç¨‹ä¸ä¼šæŠ¢å æ—¶é—´ç‰‡ï¼Œåªæœ‰ç­‰å½“å‰çº¿ç¨‹æŠŠæ—¶é—´ç‰‡ç”¨å®Œï¼Œå…¶ä»–çº¿ç¨‹æ‰æœ‰èµ„æ ¼æ‹¿åˆ°æ—¶é—´ç‰‡å»æ‰§è¡Œã€‚</p>
<p>Dï¼šä¸€ä¸ªé«˜ä¼˜å…ˆçº§åˆ«çš„çº¿ç¨‹å°±ç»ªã€‚ å¦‚Cç›¸åŒï¼Œä½ ä¼˜å…ˆçº§åˆ«å†é«˜ ä¹Ÿå¾…ç­‰æˆ‘ç°åœ¨å¼„å®Œæ‰ä¼šç»™ä½ ã€‚</p>
<p>Eï¼šçº¿ç¨‹åœ¨MediaTrackerä¸Šæ‰§è¡Œäº†waitforIDï¼ˆï¼‰è°ƒç”¨ã€‚ </p>
<p>è¿™ä¸ªç±»æ˜¯awté‡Œé¢çš„ï¼Œä»–çš„åŠŸèƒ½æ˜¯åŠ è½½å›¾åƒï¼Œç›´åˆ°å®Œæˆä¹‹å‰ï¼Œè¯¥æ–¹æ³•ä¸€ç›´ç­‰å¾…ï¼è¿™ä¸ªæ–¹æ³•æ˜¯å¿…é¡»è¦æŠ›å‡ºAé€‰é¡¹çš„InterruptedException å¼‚å¸¸çš„ è¯´æ˜è¿™ç©æ„ä¼šè®©å…¶ä»–çº¿ç¨‹ waitä»–å®Œæˆï¼  æ‰€ä»¥ä¼šæš‚åœå½“å‰çº¿ç¨‹~~å¤§æ¦‚æ˜¯è¿™æ ·å§ã€‚</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ</title>
    <url>/2020/05/11/%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8B%E5%8A%A1%EF%BC%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><strong>äº‹åŠ¡ï¼š</strong>æ˜¯æ•°æ®åº“æ“ä½œçš„æœ€å°å·¥ä½œå•å…ƒï¼Œæ˜¯ä½œä¸ºå•ä¸ªé€»è¾‘å·¥ä½œå•å…ƒæ‰§è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼›è¿™äº›æ“ä½œä½œä¸ºä¸€ä¸ªæ•´ä½“ä¸€èµ·å‘ç³»ç»Ÿæäº¤ï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œã€è¦ä¹ˆéƒ½ä¸æ‰§è¡Œï¼›äº‹åŠ¡æ˜¯ä¸€ç»„ä¸å¯å†åˆ†å‰²çš„æ“ä½œé›†åˆï¼ˆå·¥ä½œé€»è¾‘å•å…ƒï¼‰ï¼›</p>
<p><strong>äº‹åŠ¡çš„å››å¤§ç‰¹æ€§ï¼š</strong></p>
<h6 id="1-ã€åŸå­æ€§"><a href="#1-ã€åŸå­æ€§" class="headerlink" title="1 ã€åŸå­æ€§"></a>1 ã€åŸå­æ€§</h6><p>äº‹åŠ¡æ˜¯æ•°æ®åº“çš„é€»è¾‘å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­åŒ…å«çš„å„æ“ä½œè¦ä¹ˆéƒ½åšï¼Œè¦ä¹ˆéƒ½ä¸åš</p>
<h6 id="2-ã€ä¸€è‡´æ€§"><a href="#2-ã€ä¸€è‡´æ€§" class="headerlink" title="2 ã€ä¸€è‡´æ€§"></a>2 ã€ä¸€è‡´æ€§</h6><p>äº‹åŠ¡æ‰§è¡Œçš„ç»“æœå¿…é¡»æ˜¯ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚å› æ­¤å½“æ•°æ®åº“åªåŒ…å«æˆåŠŸäº‹åŠ¡æäº¤çš„ç»“æœæ—¶ï¼Œå°±è¯´æ•°æ®åº“å¤„äºä¸€è‡´æ€§çŠ¶æ€ã€‚å¦‚æœæ•°æ®åº“ç³»ç»Ÿè¿è¡Œä¸­å‘ç”Ÿæ•…éšœï¼Œæœ‰äº›äº‹åŠ¡å°šæœªå®Œæˆå°±è¢«è¿«ä¸­æ–­ï¼Œè¿™äº›æœªå®Œæˆäº‹åŠ¡å¯¹æ•°æ®åº“æ‰€åšçš„ä¿®æ”¹æœ‰ä¸€éƒ¨åˆ†å·²å†™å…¥ç‰©ç†æ•°æ®åº“ï¼Œè¿™æ—¶æ•°æ®åº“å°±å¤„äºä¸€ç§ä¸æ­£ç¡®çš„çŠ¶æ€ï¼Œæˆ–è€…è¯´æ˜¯ ä¸ä¸€è‡´çš„çŠ¶æ€ã€‚ </p>
<h6 id="3-ã€éš”ç¦»æ€§"><a href="#3-ã€éš”ç¦»æ€§" class="headerlink" title="3 ã€éš”ç¦»æ€§"></a>3 ã€éš”ç¦»æ€§</h6><p>ä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½å…¶å®ƒäº‹åŠ¡å¹²æ‰°ã€‚å³ä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®å¯¹å…¶å®ƒå¹¶å‘äº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„å„ä¸ªäº‹åŠ¡ä¹‹é—´ä¸èƒ½äº’ç›¸å¹²æ‰°ã€‚</p>
<h6 id="4-ã€æŒç»­æ€§"><a href="#4-ã€æŒç»­æ€§" class="headerlink" title="4 ã€æŒç»­æ€§"></a>4 ã€æŒç»­æ€§</h6><p>ä¹Ÿç§°æ°¸ä¹…æ€§ï¼ŒæŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜å°±åº”è¯¥æ˜¯æ°¸ä¹…æ€§çš„ã€‚æ¥ä¸‹æ¥çš„å…¶å®ƒæ“ä½œæˆ–æ•…éšœä¸åº”è¯¥å¯¹å…¶æ‰§è¡Œç»“æœæœ‰ä»»ä½•å½±å“ã€‚</p>
<p>åŸå­æ€§æ˜¯åŸºç¡€ï¼Œéš”ç¦»æ€§æ˜¯æ‰‹æ®µï¼Œä¸€è‡´æ€§æ˜¯çº¦æŸæ¡ä»¶ï¼Œè€ŒæŒä¹…æ€§æ˜¯ç›®çš„ã€‚</p>
<p>ç®€ç§°ACID</p>
<p>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰,éš”ç¦»æ€§ï¼ˆIsolationï¼‰å’ŒæŒä¹…æ€§ï¼ˆDurabilityï¼‰</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºArrayLinstä¸LinkList</title>
    <url>/2020/05/12/%E5%85%B3%E4%BA%8EArrayLinst%E4%B8%8ELinkList/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>A. ArrayListæ˜¯å®ç°äº†åŸºäºåŠ¨æ€æ•°ç»„çš„æ•°æ®ç»“æ„ï¼ŒLinkedListåŸºäºé“¾è¡¨çš„æ•°æ®ç»“æ„ã€‚ è¿™é‡Œçš„æ‰€è°“åŠ¨æ€æ•°ç»„å¹¶ä¸æ˜¯é‚£ä¸ªâ€œ æœ‰å¤šå°‘å…ƒç´ å°±ç”³è¯·å¤šå°‘ç©ºé—´ â€çš„æ„æ€ï¼Œé€šè¿‡æŸ¥çœ‹æºç ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™ä¸ªåŠ¨æ€æ•°ç»„æ˜¯è¿™æ ·å®ç°çš„ï¼Œå¦‚æœæ²¡æŒ‡å®šæ•°ç»„å¤§å°ï¼Œåˆ™ç”³è¯·é»˜è®¤å¤§å°ä¸º10çš„æ•°ç»„ï¼Œå½“å…ƒç´ ä¸ªæ•°å¢åŠ ï¼Œæ•°ç»„æ— æ³•å­˜å‚¨æ—¶ï¼Œç³»ç»Ÿä¼šå¦ä¸ªç”³è¯·ä¸€ä¸ªé•¿åº¦ä¸ºå½“å‰é•¿åº¦1.5å€çš„æ•°ç»„ï¼Œç„¶åï¼ŒæŠŠä¹‹å‰çš„æ•°æ®æ‹·è´åˆ°æ–°å»ºçš„æ•°ç»„ã€‚</p>
<p>- â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>B. å¯¹äºéšæœºè®¿é—®getå’Œsetï¼ŒArrayListç»å¯¹ä¼˜äºLinkedListï¼Œå› ä¸ºLinkedListè¦ç§»åŠ¨æŒ‡é’ˆã€‚ArrayListæ˜¯æ•°ç»„ï¼Œæ‰€ä»¥ï¼Œç›´æ¥å®šä½åˆ°ç›¸åº”ä½ç½®å–å…ƒç´ ï¼ŒLinkedLIstæ˜¯é“¾è¡¨ï¼Œæ‰€ä»¥éœ€è¦ä»å‰å¾€åéå†ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>C. å¯¹äºæ–°å¢å’Œåˆ é™¤æ“ä½œaddå’Œremoveï¼ŒLinedListæ¯”è¾ƒå ä¼˜åŠ¿ï¼Œå› ä¸ºArrayListè¦ç§»åŠ¨æ•°æ®ã€‚ArrayListçš„æ–°å¢å’Œåˆ é™¤å°±æ˜¯æ•°ç»„çš„æ–°å¢å’Œåˆ é™¤ï¼ŒLinkedListä¸é“¾è¡¨ä¸€è‡´ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>D. ArrayListçš„ç©ºé—´æµªè´¹ä¸»è¦ä½“ç°åœ¨åœ¨liståˆ—è¡¨çš„ç»“å°¾é¢„ç•™ä¸€å®šçš„å®¹é‡ç©ºé—´ï¼Œè€ŒLinkedListçš„ç©ºé—´èŠ±è´¹åˆ™ä½“ç°åœ¨å®ƒçš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½éœ€è¦æ¶ˆè€—ç›¸å½“çš„ç©ºé—´ã€‚å› ä¸ºArrayListç©ºé—´çš„å¢é•¿ç‡ä¸º1.5å€ï¼Œæ‰€ä»¥ï¼Œæœ€åå¾ˆå¯èƒ½ç•™ä¸‹ä¸€éƒ¨åˆ†ç©ºé—´æ˜¯æ²¡æœ‰ç”¨åˆ°çš„ï¼Œå› æ­¤ï¼Œä¼šé€ æˆæµªè´¹çš„æƒ…å†µã€‚å¯¹äºLInkedListçš„è¯ï¼Œç”±äºæ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦é¢å¤–çš„æŒ‡é’ˆï¼Œæ‰€ä»¥ï¼Œä½ æ‡‚çš„ã€‚</p>
<p>ä¸‹é¢æ”¾ä¸€å¼ ArrayListå’ŒLinkedListçš„åŒºåˆ«è¡¨ï¼š</p>
<img src="/2020/05/12/%E5%85%B3%E4%BA%8EArrayLinst%E4%B8%8ELinkList/p1.png" class title="ArrayListå’ŒLinkedListçš„åŒºåˆ«è¡¨">

]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºJavaä¸­çš„æ„é€ æ–¹æ³•</title>
    <url>/2020/05/12/%E5%85%B3%E4%BA%8EJava%E4%B8%AD%E7%9A%84%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>æ„é€ æ–¹æ³•æ¯æ¬¡éƒ½æ˜¯æ„é€ å‡ºæ–°çš„å¯¹è±¡ï¼Œä¸å­˜åœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™åŒä¸€å¯¹è±¡ä¸­çš„å±æ€§çš„é—®é¢˜ï¼Œæ‰€ä»¥ä¸éœ€è¦åŒæ­¥ ã€‚<br> å¦‚æœçˆ¶ç±»ä¸­çš„æŸä¸ªæ–¹æ³•ä½¿ç”¨äº† synchronizedå…³é”®å­—ï¼Œè€Œå­ç±»ä¸­ä¹Ÿè¦†ç›–äº†è¿™ä¸ªæ–¹æ³•ï¼Œé»˜è®¤æƒ…å†µä¸‹å­ç±»ä¸­çš„è¿™ä¸ªæ–¹æ³•å¹¶ä¸æ˜¯åŒæ­¥çš„ï¼Œå¿…é¡»æ˜¾ç¤ºçš„åœ¨å­ç±»çš„è¿™ä¸ªæ–¹æ³•ä¸­åŠ ä¸Š synchronizedå…³é”®å­—æ‰å¯ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»ä¸­ç›¸åº”çš„æ–¹æ³•ï¼Œè¿™æ ·è™½ç„¶å­ç±»ä¸­çš„æ–¹æ³•å¹¶ä¸æ˜¯åŒæ­¥çš„ï¼Œä½†å­ç±»è°ƒç”¨äº†çˆ¶ç±»ä¸­çš„åŒæ­¥æ–¹æ³•ï¼Œä¹Ÿå°±ç›¸å½“å­ç±»æ–¹æ³•ä¹ŸåŒæ­¥äº†ã€‚è¯¦è§ï¼š<a href="http://blog.csdn.net/welcome000yy/article/details/8941644" target="_blank" rel="noopener">http://blog.csdn.net/welcome000yy/article/details/8941644</a><br> æ¥å£é‡Œé¢çš„å˜é‡ä¸ºå¸¸é‡ï¼Œå…¶å®é™…æ˜¯ public static final ï¼›æ¥å£é‡Œé¢çš„æ–¹æ³•ä¸ºæŠ½è±¡æ–¹æ³•ï¼Œå…¶å®é™…æ˜¯public abstractã€‚</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºJavaä¸­çš„å…³é”®å­—ä¸ä¿ç•™å­—</title>
    <url>/2020/05/12/%E5%85%B3%E4%BA%8EJava%E4%B8%AD%E7%9A%84%E5%85%B3%E9%94%AE%E5%AD%97%E4%B8%8E%E4%BF%9D%E7%95%99%E5%AD%97/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>Javaå…³é”®å­—æ˜¯<a href="https://baike.baidu.com/item/ç”µè„‘è¯­è¨€/7105622" target="_blank" rel="noopener">ç”µè„‘è¯­è¨€</a>é‡Œäº‹å…ˆå®šä¹‰çš„ï¼Œæœ‰ç‰¹åˆ«æ„ä¹‰çš„æ ‡è¯†ç¬¦ï¼Œæœ‰æ—¶åˆå«<a href="https://baike.baidu.com/item/ä¿ç•™å­—/7674788" target="_blank" rel="noopener">ä¿ç•™å­—</a>ï¼Œè¿˜æœ‰ç‰¹åˆ«æ„ä¹‰çš„å˜é‡ã€‚Javaçš„å…³é”®å­—å¯¹Javaçš„<a href="https://baike.baidu.com/item/ç¼–è¯‘å™¨/8853067" target="_blank" rel="noopener">ç¼–è¯‘å™¨</a>æœ‰ç‰¹æ®Šçš„æ„ä¹‰ï¼Œä»–ä»¬ç”¨æ¥è¡¨ç¤ºä¸€ç§æ•°æ®ç±»å‹ï¼Œæˆ–è€…è¡¨ç¤ºç¨‹åºçš„ç»“æ„ç­‰ï¼Œå…³é”®å­—ä¸èƒ½ç”¨ä½œå˜é‡åã€æ–¹æ³•åã€ç±»åã€åŒ…åå’Œå‚æ•°ã€‚</p>
<p> javaä¸­true ,false , nullåœ¨javaä¸­ä¸æ˜¯å…³é”®å­—ï¼Œä¹Ÿä¸æ˜¯ä¿ç•™å­—ï¼Œå®ƒä»¬åªæ˜¯æ˜¾å¼å¸¸é‡å€¼ï¼Œä½†æ˜¯ä½ åœ¨ç¨‹åºä¸­ä¸èƒ½ä½¿ç”¨å®ƒä»¬ä½œä¸ºæ ‡è¯†ç¬¦ã€‚</p>
<p>å…¶ä¸­constå’Œgotoæ˜¯javaçš„ä¿ç•™å­—ã€‚javaä¸­æ‰€æœ‰çš„å…³é”®å­—éƒ½æ˜¯å°å†™çš„ï¼Œè¿˜æœ‰è¦æ³¨æ„true,false,null,ã€€friendlyï¼Œsizeofä¸æ˜¯javaçš„å…³é”®å­—,ä½†æ˜¯ä½ ä¸èƒ½æŠŠå®ƒä»¬ä½œä¸ºjavaæ ‡è¯†ç¬¦ç”¨ã€‚</p>
<p>gotoå’Œconstæ˜¯ä¿ç•™å­—ä¹Ÿæ˜¯å…³é”®å­—ã€‚</p>
<p>å…³é”®å­—åˆ—è¡¨ (ä¾å­—æ¯æ’åº å…±50ç»„)ï¼š</p>
<p>abstract, assert, boolean, break, byte, case, catch, char, class, constï¼ˆä¿ç•™å…³é”®å­—ï¼‰, continue, default, do, double, else, enum, extends, final, finally, float, for, gotoï¼ˆä¿ç•™å…³é”®å­—ï¼‰, if, implements, import, instanceof, int, interface, long, native, new, package, private, protected, public, return, short, static, strictfp, super, switch, synchronized, this, throw, throws, transient, try, void, volatile, while</p>
<p>ä¿ç•™å­—åˆ—è¡¨ (ä¾å­—æ¯æ’åº å…±14ç»„)ï¼ŒJavaä¿ç•™å­—æ˜¯æŒ‡ç°æœ‰Javaç‰ˆæœ¬å°šæœªä½¿ç”¨ï¼Œä½†ä»¥åç‰ˆæœ¬å¯èƒ½ä¼šä½œä¸ºå…³é”®å­—ä½¿ç”¨ï¼š</p>
<p>byValue, cast, false, future, generic, inner, operator, outer, rest, true, var, goto ï¼ˆä¿ç•™å…³é”®å­—ï¼‰ , const ï¼ˆä¿ç•™å…³é”®å­—ï¼‰ , null</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºJavaçš„åå°„</title>
    <url>/2020/05/12/%E5%85%B3%E4%BA%8EJava%E7%9A%84%E5%8F%8D%E5%B0%84/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>åå°„æŒ‡çš„æ˜¯åœ¨è¿è¡Œæ—¶èƒ½å¤Ÿåˆ†æç±»çš„èƒ½åŠ›çš„ç¨‹åºã€‚</p>
<p>åå°„æœºåˆ¶å¯ä»¥ç”¨æ¥ï¼š</p>
<p>1.åœ¨è¿è¡Œæ—¶åˆ†æç±»çš„èƒ½åŠ›â€“æ£€æŸ¥ç±»çš„ç»“æ„â€“æ‰€ç”¨åˆ°çš„å°±æ˜¯<strong>java.lang.reflectåŒ…ä¸­çš„Fieldã€Methodã€Constructorï¼Œåˆ†åˆ«ç”¨äºæè¿°ç±»çš„åŸŸã€æ–¹æ³•å’Œæ„é€ å™¨</strong>ã€‚</p>
<p>2.åœ¨è¿è¡Œæ—¶æŸ¥çœ‹å¯¹è±¡ã€‚</p>
<p>3.å®ç°é€šç”¨çš„æ•°ç»„æ“ä½œä»£ç ã€‚</p>
<p><strong>åå°„æœºåˆ¶çš„åŠŸèƒ½ï¼š</strong></p>
<p>åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ï¼›åœ¨è¿è¡Œæ—¶æ„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼›åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼›åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼›ç”ŸæˆåŠ¨æ€æ–¹æ³•ã€‚</p>
<p><strong>åå°„æœºåˆ¶å¸¸è§ä½œç”¨ï¼š</strong></p>
<p>åŠ¨æ€åŠ è½½ç±»ã€åŠ¨æ€è·å–ç±»çš„ä¿¡æ¯ï¼ˆå±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨ï¼‰ï¼›åŠ¨æ€æ„é€ å¯¹è±¡ï¼›åŠ¨æ€è°ƒç”¨ç±»å’Œå¯¹è±¡çš„ä»»æ„æ–¹æ³•ã€æ„é€ å™¨ï¼›åŠ¨æ€è°ƒç”¨å’Œå¤„ç†å±æ€§ï¼›è·å–æ³›å‹ä¿¡æ¯ï¼ˆæ–°å¢ç±»å‹ï¼šParameterizedType,GenericArrayTypeç­‰ï¼‰ï¼›å¤„ç†æ³¨è§£ï¼ˆåå°„API:getAnnotationsdengç­‰ï¼‰ã€‚</p>
<p><strong>åå°„æœºåˆ¶æ€§èƒ½é—®é¢˜ï¼š</strong></p>
<p>åå°„ä¼šé™ä½æ•ˆç‡ã€‚</p>
<p>void setAccessible(boolean flag):æ˜¯å¦å¯ç”¨è®¿é—®å®‰å…¨æ£€æŸ¥çš„å¼€å…³ï¼Œtrueå±è”½Javaè¯­è¨€çš„è®¿é—®æ£€æŸ¥ï¼Œä½¿å¾—å¯¹è±¡çš„ç§æœ‰å±æ€§ä¹Ÿå¯ä»¥è¢«æŸ¥è¯¢å’Œè®¾ç½®ã€‚ç¦æ­¢å®‰å…¨æ£€æŸ¥ï¼Œå¯ä»¥æé«˜åå°„çš„è¿è¡Œé€Ÿåº¦ã€‚</p>
<p>å¯ä»¥è€ƒè™‘ä½¿ç”¨ï¼šcglib/javaassistæ“ä½œã€‚</p>
<p> Javaè¯­è¨€åå°„æä¾›ä¸€ç§åŠ¨æ€é“¾æ¥ç¨‹åºç»„ä»¶çš„å¤šåŠŸèƒ½æ–¹æ³•ã€‚å®ƒå…è®¸ç¨‹åºåˆ›å»ºå’Œæ§åˆ¶ä»»ä½•ç±»çš„å¯¹è±¡(æ ¹æ®å®‰å…¨æ€§é™åˆ¶)ï¼Œæ— éœ€æå‰ç¡¬ç¼–ç ç›®æ ‡ç±»ã€‚è¿™äº›ç‰¹æ€§ä½¿å¾—åå°„ç‰¹åˆ«é€‚ç”¨äºåˆ›å»ºä»¥éå¸¸æ™®é€šçš„æ–¹å¼ä¸å¯¹è±¡åä½œçš„åº“ã€‚ä¾‹å¦‚ï¼Œåå°„ç»å¸¸åœ¨æŒç»­å­˜å‚¨å¯¹è±¡ä¸ºæ•°æ®åº“ã€XMLæˆ–å…¶å®ƒå¤–éƒ¨æ ¼å¼çš„æ¡†æ¶ä¸­ä½¿ç”¨ã€‚Java reflectionéå¸¸æœ‰ç”¨ï¼Œå®ƒä½¿ç±»å’Œæ•°æ®ç»“æ„èƒ½æŒ‰åç§°åŠ¨æ€æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œå¹¶å…è®¸åœ¨è¿è¡Œç€çš„ç¨‹åºä¸­æ“ä½œè¿™äº›ä¿¡æ¯ã€‚Javaçš„è¿™ä¸€ç‰¹æ€§éå¸¸å¼ºå¤§ï¼Œå¹¶ä¸”æ˜¯å…¶å®ƒä¸€äº›å¸¸ç”¨è¯­è¨€ï¼Œå¦‚Cã€C++ã€Fortran æˆ–è€…Pascalç­‰éƒ½ä¸å…·å¤‡çš„ã€‚</p>
<p>   ä½†åå°„æœ‰ä¸¤ä¸ªç¼ºç‚¹ã€‚ç¬¬ä¸€ä¸ªæ˜¯æ€§èƒ½é—®é¢˜ã€‚ç”¨äºå­—æ®µå’Œæ–¹æ³•æ¥å…¥æ—¶åå°„è¦è¿œæ…¢äºç›´æ¥ä»£ç ã€‚æ€§èƒ½é—®é¢˜çš„ç¨‹åº¦å–å†³äºç¨‹åºä¸­æ˜¯å¦‚ä½•ä½¿ç”¨åå°„çš„ã€‚å¦‚æœå®ƒä½œä¸ºç¨‹åºè¿è¡Œä¸­ç›¸å¯¹å¾ˆå°‘æ¶‰åŠçš„éƒ¨åˆ†ï¼Œç¼“æ…¢çš„æ€§èƒ½å°†ä¸ä¼šæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚å³ä½¿æµ‹è¯•ä¸­æœ€åæƒ…å†µä¸‹çš„è®¡æ—¶å›¾æ˜¾ç¤ºçš„åå°„æ“ä½œåªè€—ç”¨å‡ å¾®ç§’ã€‚ä»…åå°„åœ¨æ€§èƒ½å…³é”®çš„åº”ç”¨çš„æ ¸å¿ƒé€»è¾‘ä¸­ä½¿ç”¨æ—¶æ€§èƒ½é—®é¢˜æ‰å˜å¾—è‡³å…³é‡è¦ã€‚</p>
<p>   è®¸å¤šåº”ç”¨ä¸­æ›´ä¸¥é‡çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯ä½¿ç”¨åå°„ä¼šæ¨¡ç³Šç¨‹åºå†…éƒ¨å®é™…è¦å‘ç”Ÿçš„äº‹æƒ…ã€‚ç¨‹åºäººå‘˜å¸Œæœ›åœ¨æºä»£ç ä¸­çœ‹åˆ°ç¨‹åºçš„é€»è¾‘ï¼Œåå°„ç­‰ç»•è¿‡äº†æºä»£ç çš„æŠ€æœ¯ä¼šå¸¦æ¥ç»´æŠ¤é—®é¢˜ã€‚åå°„ä»£ç æ¯”ç›¸åº”çš„ç›´æ¥ä»£ç æ›´å¤æ‚ï¼Œæ­£å¦‚æ€§èƒ½æ¯”è¾ƒçš„ä»£ç å®ä¾‹ä¸­çœ‹åˆ°çš„ä¸€æ ·ã€‚è§£å†³è¿™äº›é—®é¢˜çš„æœ€ä½³æ–¹æ¡ˆæ˜¯ä¿å®ˆåœ°ä½¿ç”¨åå°„ä¸€-ä»…åœ¨å®ƒå¯ä»¥çœŸæ­£å¢åŠ çµæ´»æ€§çš„åœ°æ–¹ä¸€è®°å½•å…¶åœ¨ ç›®æ ‡ç±»ä¸­çš„ä½¿ç”¨ã€‚</p>
<p>   Reflectionæ˜¯Javaç¨‹åºå¼€å‘è¯­è¨€çš„ç‰¹å¾ä¹‹ä¸€ï¼Œå®ƒå…è®¸è¿è¡Œä¸­çš„Javaç¨‹åºå¯¹è‡ªèº«è¿›è¡Œæ£€æŸ¥ï¼Œæˆ–è€…è¯´â€è‡ªå®¡â€ï¼Œå¹¶èƒ½ç›´æ¥æ“ä½œç¨‹åºçš„å†…éƒ¨å±æ€§ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å®ƒèƒ½è·å¾—Javaç±»ä¸­å„æˆå‘˜çš„åç§°å¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>   Javaçš„è¿™-èƒ½åŠ›åœ¨å®é™…åº”ç”¨ä¸­ä¹Ÿè®¸ç”¨å¾—ä¸æ˜¯å¾ˆå¤šï¼Œä½†æ˜¯åœ¨å…¶å®ƒçš„ç¨‹åºè®¾è®¡è¯­è¨€ä¸­æ ¹æœ¬å°±ä¸å­˜åœ¨è¿™ä¸€-ç‰¹æ€§ã€‚ä¾‹å¦‚ï¼ŒPascal. Cæˆ–è€…C++ä¸­å°±æ²¡æœ‰åŠæ³•åœ¨ç¨‹åºä¸­è·å¾—å‡½æ•°å®šä¹‰ç›¸å…³çš„ä¿¡æ¯ã€‚</p>
<p>   JavaBeanæ˜¯reflectionçš„å®é™…åº”ç”¨ä¹‹ä¸€ï¼Œå®ƒèƒ½è®©ä¸€äº›å·¥å…·å¯è§†åŒ–çš„æ“ä½œè½¯ä»¶ç»„ä»¶ã€‚è¿™äº›å·¥å…·é€šè¿‡reflectionåŠ¨æ€çš„è½½å…¥å¹¶å–å¾—Javaç»„ä»¶(ç±»)çš„å±æ€§ã€‚</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºjavaå†…å­˜åŒºåŸŸ</title>
    <url>/2020/05/12/%E5%85%B3%E4%BA%8Ejava%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>A.ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒçš„ä½œç”¨å¯ä»¥çœ‹åšæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„ä¿¡å·æŒ‡ç¤ºå™¨ï¼ˆåç§»åœ°å€ï¼‰ï¼ŒJavaç¼–è¯‘è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å­—èŠ‚ç æœ‰ç‚¹ç±»ä¼¼ç¼–è¯‘åŸç†çš„æŒ‡ä»¤ï¼Œç¨‹åºè®¡æ•°å™¨çš„å†…å­˜ç©ºé—´å­˜å‚¨çš„æ˜¯å½“å‰æ‰§è¡Œçš„å­—èŠ‚ç çš„åç§»åœ°å€ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼ˆç¨‹åºè®¡æ•°å™¨çš„å†…å­˜ç©ºé—´æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼‰ï¼Œå› ä¸ºå½“æ‰§è¡Œè¯­å¥æ—¶ï¼Œæ”¹å˜çš„æ˜¯ç¨‹åºè®¡æ•°å™¨çš„å†…å­˜ç©ºé—´ï¼Œå› æ­¤å®ƒä¸ä¼šå‘ç”Ÿå†…å­˜æº¢å‡º ï¼Œå¹¶ä¸”ç¨‹åºè®¡æ•°å™¨æ˜¯jvmè™šæ‹Ÿæœºè§„èŒƒä¸­å”¯ä¸€ä¸€ä¸ªæ²¡æœ‰è§„å®š OutOfMemoryError å¼‚å¸¸ çš„åŒºåŸŸï¼›</p>
<p>B.javaè™šæ‹Ÿæœºæ ˆï¼šçº¿ç¨‹ç§æœ‰ï¼Œç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ä¸€è‡´ã€‚æè¿°çš„æ˜¯ Java æ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§(Stack Frame)ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œç»“æŸï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§ä»è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚ æ²¡æœ‰ç±»ä¿¡æ¯ï¼Œç±»ä¿¡æ¯æ˜¯åœ¨æ–¹æ³•åŒºä¸­</p>
<p>C.javaå †ï¼šå¯¹äºç»å¤§å¤šæ•°åº”ç”¨æ¥è¯´ï¼Œè¿™å—åŒºåŸŸæ˜¯ JVM æ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ã€‚çº¿ç¨‹å…±äº«ï¼Œä¸»è¦æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹å’Œæ•°ç»„</p>
<p>D.æ–¹æ³•åŒºï¼šå±äºå…±äº«å†…å­˜åŒºåŸŸï¼Œå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ›å»ºå¤šçº¿ç¨‹çš„4ç§æ–¹å¼</title>
    <url>/2020/05/11/%E5%88%9B%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%844%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h4 id="javaä¸­åˆ›å»ºå¤šçº¿ç¨‹çš„4ç§æ–¹å¼"><a href="#javaä¸­åˆ›å»ºå¤šçº¿ç¨‹çš„4ç§æ–¹å¼" class="headerlink" title="javaä¸­åˆ›å»ºå¤šçº¿ç¨‹çš„4ç§æ–¹å¼"></a>javaä¸­åˆ›å»ºå¤šçº¿ç¨‹çš„4ç§æ–¹å¼</h4><h5 id="1-çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>â€‹    çº¿ç¨‹è¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ï¼Œæ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ï¼Œå®ƒæ˜¯æŒ‡åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œèƒ½å¤Ÿæ‰§è¡Œä»£ç çš„ä¸€ä¸ªæ‰§è¡Œå•ä½ã€‚æ¯ä¸ªç¨‹åºéƒ½è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿå³æ˜¯ç¨‹åºæœ¬èº«ã€‚</p>
<h5 id="2-çº¿ç¨‹çŠ¶æ€"><a href="#2-çº¿ç¨‹çŠ¶æ€" class="headerlink" title="2.çº¿ç¨‹çŠ¶æ€"></a>2.çº¿ç¨‹çŠ¶æ€</h5><p>â€‹    Javaè¯­è¨€å®šä¹‰äº†5ç§çº¿ç¨‹çŠ¶æ€ï¼Œåœ¨ä»»æ„ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œä¸€ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸”åªæœ‰å…¶ä¸­ä¸€ä¸ªçŠ¶æ€ã€‚ï¼Œè¿™5ç§çŠ¶æ€å¦‚ä¸‹ï¼š</p>
<p>ï¼ˆ1ï¼‰æ–°å»ºï¼ˆNewï¼‰ï¼šåˆ›å»ºåå°šæœªå¯åŠ¨çš„çº¿ç¨‹å¤„äºè¿™ç§çŠ¶æ€</p>
<p>ï¼ˆ2ï¼‰è¿è¡Œï¼ˆRunableï¼‰ï¼šRunableåŒ…æ‹¬äº†æ“ä½œç³»ç»Ÿçº¿ç¨‹çŠ¶æ€çš„Runningå’ŒReadyï¼Œä¹Ÿå°±æ˜¯å¤„äºæ­¤çŠ¶æ€çš„çº¿ç¨‹æœ‰å¯èƒ½æ­£åœ¨æ‰§è¡Œï¼Œä¹Ÿæœ‰å¯èƒ½æ­£åœ¨ç­‰å¾…ç€CPUä¸ºå®ƒåˆ†é…æ‰§è¡Œæ—¶é—´ã€‚</p>
<p>ï¼ˆ3ï¼‰ç­‰å¾…ï¼ˆWatingï¼‰ï¼šå¤„äºè¿™ç§çŠ¶æ€çš„çº¿ç¨‹ä¸ä¼šè¢«åˆ†é…CPUæ‰§è¡Œæ—¶é—´ã€‚ç­‰å¾…çŠ¶æ€åˆåˆ†ä¸ºæ— é™æœŸç­‰å¾…å’Œæœ‰é™æœŸç­‰å¾…ï¼Œå¤„äºæ— é™æœŸç­‰å¾…çš„çº¿ç¨‹éœ€è¦è¢«å…¶ä»–çº¿ç¨‹æ˜¾ç¤ºåœ°å”¤é†’ï¼Œæ²¡æœ‰è®¾ç½®Timeoutå‚æ•°çš„Object.wait()ã€æ²¡æœ‰è®¾ç½®Timeoutå‚æ•°çš„Thread.join()æ–¹æ³•éƒ½ä¼šä½¿çº¿ç¨‹è¿›å…¥æ— é™æœŸç­‰å¾…çŠ¶æ€ï¼›æœ‰é™æœŸç­‰å¾…çŠ¶æ€æ— é¡»ç­‰å¾…è¢«å…¶ä»–çº¿ç¨‹æ˜¾ç¤ºåœ°å”¤é†’ï¼Œåœ¨ä¸€å®šæ—¶é—´ä¹‹åå®ƒä»¬ä¼šç”±ç³»ç»Ÿè‡ªåŠ¨å”¤é†’ï¼ŒThread.sleep()ã€è®¾ç½®äº†Timeoutå‚æ•°çš„Object.wait()ã€è®¾ç½®äº†Timeoutå‚æ•°çš„Thread.join()æ–¹æ³•éƒ½ä¼šä½¿çº¿ç¨‹è¿›å…¥æœ‰é™æœŸç­‰å¾…çŠ¶æ€ã€‚</p>
<p>ï¼ˆ4ï¼‰é˜»å¡ï¼ˆBlockedï¼‰ï¼šçº¿ç¨‹è¢«é˜»å¡äº†ï¼Œâ€œé˜»å¡çŠ¶æ€â€ä¸â€ç­‰å¾…çŠ¶æ€â€œçš„åŒºåˆ«æ˜¯ï¼šâ€é˜»å¡çŠ¶æ€â€œåœ¨ç­‰å¾…ç€è·å–åˆ°ä¸€ä¸ªæ’ä»–é”ï¼Œè¿™ä¸ªæ—¶é—´å°†åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ”¾å¼ƒè¿™ä¸ªé”çš„æ—¶å€™å‘ç”Ÿï¼›è€Œâ€ç­‰å¾…çŠ¶æ€â€œåˆ™æ˜¯åœ¨ç­‰å¾…ä¸€æ®µæ—¶é—´æˆ–è€…å”¤é†’åŠ¨ä½œçš„å‘ç”Ÿã€‚åœ¨ç¨‹åºç­‰å¾…è¿›å…¥åŒæ­¥åŒºåŸŸçš„æ—¶å€™ï¼Œçº¿ç¨‹å°†è¿›å…¥è¿™ç§çŠ¶æ€ã€‚</p>
<p>ï¼ˆ5ï¼‰ç»“æŸï¼ˆTerminatedï¼‰ï¼šå·²ç»ˆæ­¢çº¿ç¨‹çš„çº¿ç¨‹çŠ¶æ€ï¼Œçº¿ç¨‹å·²ç»ç»“æŸæ‰§è¡Œã€‚</p>
<h5 id="3-javaåˆ›å»ºå¤šçº¿ç¨‹çš„å››ç§æ–¹å¼"><a href="#3-javaåˆ›å»ºå¤šçº¿ç¨‹çš„å››ç§æ–¹å¼" class="headerlink" title="3.javaåˆ›å»ºå¤šçº¿ç¨‹çš„å››ç§æ–¹å¼"></a>3.javaåˆ›å»ºå¤šçº¿ç¨‹çš„å››ç§æ–¹å¼</h5><p>ï¼ˆ1ï¼‰   ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹</p>
<p>ï¼ˆ2ï¼‰   å®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹</p>
<p>ï¼ˆ3ï¼‰   ä½¿ç”¨Callableå’ŒFutureTaskåˆ›å»ºçº¿ç¨‹</p>
<p>ï¼ˆ4ï¼‰   ä½¿ç”¨çº¿ç¨‹æ± ï¼Œä¾‹å¦‚ç”¨Executoræ¡†æ¶åˆ›å»ºçº¿ç¨‹</p>
<p><strong>1)ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p>
<p>å®šä¹‰ä¸€ä¸ªç»§æ‰¿Threadçº¿ç¨‹ç±»çš„ç±»ï¼Œåœ¨ç±»ä¸­é‡å†™runæ–¹æ³•ã€‚</p>
<p>åœ¨mainå‡½æ•°ä¸­å®ä¾‹åŒ–è¿™ä¸ªç±»ï¼Œåˆå§‹åŒ–å®ç°ç»§æ‰¿Threadç±»çš„å¯¹è±¡ã€‚</p>
<p>ç”¨è¿™ä¸ªç±»çš„å®ä¾‹è°ƒç”¨startæ–¹æ³•ï¼Œæ‰§è¡Œè¦†å†™çš„runæ–¹æ³•ã€‚è¿™é‡Œæ˜¯çˆ¶ç±»å³Threadæ¥æ”¶åˆ›å»ºçš„å¯¹è±¡ï¼Œç”±äºè‡ªèº«æ²¡æœ‰startæ–¹æ³•ï¼Œæ‰€ä»¥æ˜¯è°ƒç”¨çˆ¶ç±»Threadçš„startæ–¹æ³•åˆ›å»ºçº¿ç¨‹ã€‚</p>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;<span class="comment">//ç»§æ‰¿Threadç±»</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="comment">//é‡å†™runæ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="keyword">new</span> MyThread().start();<span class="comment">//åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2)å®ç°Runnableæ¥å£åˆ›å»ºçº¿ç¨‹æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p>
<p>å®šä¹‰ä¸€ä¸ªå®ç°Runnableæ¥å£çš„ç±»Aï¼Œåœ¨ç±»ä¸­é‡å†™runæ–¹æ³•ã€‚</p>
<p>åœ¨mainå‡½æ•°ä¸­å®ä¾‹åŒ–è¿™ä¸ªç±»ï¼Œä½†æ˜¯æ³¨æ„ï¼Œè¿™ä¸æ˜¯çº¿ç¨‹ç±»æˆ–è€…å…¶å­ç±»ï¼Œæ— æ³•ä½¿ç”¨startæ–¹æ³•ï¼Œæ‰€ä»¥æ— æ³•åƒ1)æ–¹æ³•ä¸€æ ·ç”¨çˆ¶ç±»æ¥æ”¶å…¶å¯¹è±¡ç›´æ¥è°ƒç”¨startæ–¹æ³•æ‰§è¡Œrunæ–¹æ³•ã€‚</p>
<p>å®ä¾‹åŒ–çº¿ç¨‹ç±»ï¼Œå°†ä¸Šä¸€æ­¥å®ä¾‹åŒ–çš„Runnableæ¥å£çš„ç±»ä½œä¸ºå‚æ•°ä¼ ç»™Threadçº¿ç¨‹ç±»ï¼Œåˆå§‹åŒ–çº¿ç¨‹å¯¹è±¡ï¼Œå³ Thread t = new Thread(new A());</p>
<p>çº¿ç¨‹ç±»å®ä¾‹è°ƒç”¨startæ–¹æ³•æ‰§è¡Œrunæ–¹æ³•ä½“ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸ç›´æ¥è°ƒç”¨runæ–¹æ³•ï¼Œè€Œæ˜¯å¿…é¡»å…ˆè°ƒç”¨startæ–¹æ³•å‘¢ï¼Ÿ</p>
<p>å› ä¸ºstartæ–¹æ³•ä¼šå¯åŠ¨çº¿ç¨‹ï¼Œæ­¤æ—¶è¯¥çº¿ç¨‹å¤„äºå°±ç»ªçŠ¶æ€ï¼Œstartæ–¹æ³•ä½“ä¸­æœ‰ä¸€ä¸ªstart0çš„nativeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œåˆ›å»ºäº†çº¿ç¨‹ï¼Œå¹¶ä¸”æ‰§è¡Œè°ƒç”¨äº†é‡å†™çš„runæ–¹æ³•ï¼Œåœ¨runæ–¹æ³•ç»“æŸæ—¶ï¼Œçº¿ç¨‹ä¾¿ä¼šä¸­æ­¢ï¼Œä¹Ÿå°±æ˜¯start0æ–¹æ³•é€€å‡ºæ—¶ã€‚å¦‚æœæ˜¯ç›´æ¥è°ƒç”¨runæ–¹æ³•ï¼Œå³è°ƒç”¨é‡å†™çš„runæ–¹æ³•ï¼Œè¿™å’Œæ™®é€šæ–¹æ³•æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ä¼šåˆ›å»ºæ–°çº¿ç¨‹ï¼Œå› ä¸ºåˆ›å»ºæ–°çº¿ç¨‹ï¼Œä½¿çº¿ç¨‹å¤„äºå°±ç»ªçŠ¶æ€çš„æ“ä½œåœ¨startæ–¹æ³•ä¸­ï¼Œè€Œrunæ–¹æ³•ä¼šè¢«jvmåœ¨startæ–¹æ³•ä¸­çš„start0ä¸­è°ƒç”¨ã€‚</p>
<p> ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread2</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;<span class="comment">//å®ç°Runnableæ¥å£</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="comment">//é‡å†™runæ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€MyThread2 myThread=<span class="keyword">new</span> MyThread2();</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€Thread thread=<span class="keyword">new</span> Thread(myThread);</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€thread().start();</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//æˆ–è€…    new Thread(new MyThread2()).start();</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>start0æ–¹æ³•æºç è§£æè¯·çœ‹<a href="https://www.jianshu.com/p/81a56497e073" target="_blank" rel="noopener">https://www.jianshu.com/p/81a56497e073</a></p>
<p>ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è°ƒç”¨startæ–¹æ³•å—?</p>
<p>ä¸èƒ½ï¼Œä¼šæŠ›å‡ºä¸‹åˆ—å¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯éæ³•çº¿ç¨‹çŠ¶æ€å¼‚å¸¸ï¼Œå±äºè¿è¡Œå¼‚å¸¸ã€‚æŸ¥çœ‹æºç å¯ä»¥çœ‹åˆ°åœ¨æ‰§è¡Œstartæ—¶ï¼Œä¼šå¯¹çº¿ç¨‹çŠ¶æ€è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœçº¿ç¨‹å·²ç»å¯åŠ¨è¿‡ï¼Œé‚£ä¹ˆé€šå¸¸æƒ…å†µä¸‹æ— æ³•å†æ¬¡è¿›è¡Œå¯åŠ¨ï¼Œè¿™ä¸€ç‚¹åœ¨æºç æ³¨é‡Šä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°ã€‚å³åœ¨åŒä¸€ä¸ªçº¿ç¨‹åªèƒ½startä¸€æ¬¡ï¼Œå¤šæ¬¡è°ƒç”¨startæ–¹æ³•ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å½“è°ƒç”¨startæ–¹æ³•æ—¶ï¼Œçº¿ç¨‹ä¼šè¢«æ·»åŠ åˆ°çº¿ç¨‹ç»„ä¸­ï¼Œç­‰å¾…çº¿ç¨‹è°ƒåº¦å™¨è°ƒç”¨ï¼Œå½“è·å–åˆ°èµ„æºæ—¶ï¼Œå°±è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚</p>
<p>æºç åˆ†æè¯·çœ‹<a href="https://cloud.tencent.com/developer/article/1386458" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1386458</a></p>
<p><strong>3)ä½¿ç”¨Callableå’ŒFutureTaskåˆ›å»ºçº¿ç¨‹æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p>
<p>å’ŒRunnableæ¥å£ä¸ä¸€æ ·ï¼ŒCallableæ¥å£æä¾›äº†ä¸€ä¸ªcallï¼ˆï¼‰æ–¹æ³•ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œcall()æ–¹æ³•æ¯”run()æ–¹æ³•åŠŸèƒ½è¦å¼ºå¤§ã€‚</p>
<blockquote>
<p><strong>call()æ–¹æ³•å¯ä»¥æœ‰è¿”å›å€¼</strong></p>
</blockquote>
<blockquote>
<p><strong>call()æ–¹æ³•å¯ä»¥å£°æ˜æŠ›å‡ºå¼‚å¸¸</strong></p>
</blockquote>
<p>Java5ä¹‹åæä¾›äº†Futureæ¥å£æ¥ä»£è¡¨Callableæ¥å£é‡Œcall()æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¹¶ä¸”ä¸ºFutureæ¥å£æä¾›äº†ä¸€ä¸ªå®ç°ç±»FutureTaskï¼Œè¿™ä¸ªå®ç°ç±»æ—¢å®ç°äº†Futureæ¥å£ï¼Œè¿˜å®ç°äº†Runnableæ¥å£ï¼Œå› æ­¤å¯ä»¥ä½œä¸ºThreadç±»çš„targetã€‚åœ¨Futureæ¥å£é‡Œå®šä¹‰äº†å‡ ä¸ªå…¬å…±æ–¹æ³•æ¥æ§åˆ¶å®ƒå…³è”çš„Callableä»»åŠ¡ã€‚</p>
<blockquote>
<p>boolean cancel(boolean mayInterruptIfRunning)ï¼šè§†å›¾å–æ¶ˆè¯¥Futureé‡Œé¢å…³è”çš„Callableä»»åŠ¡</p>
</blockquote>
<blockquote>
<p>V get()ï¼šè¿”å›Callableé‡Œcallï¼ˆï¼‰æ–¹æ³•çš„è¿”å›å€¼ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šå¯¼è‡´ç¨‹åºé˜»å¡ï¼Œå¿…é¡»ç­‰åˆ°å­çº¿ç¨‹ç»“æŸåæ‰ä¼šå¾—åˆ°è¿”å›å€¼</p>
</blockquote>
<blockquote>
<p>V get(long timeout,TimeUnit unit)ï¼šè¿”å›Callableé‡Œcallï¼ˆï¼‰æ–¹æ³•çš„è¿”å›å€¼ï¼Œæœ€å¤šé˜»å¡timeoutæ—¶é—´ï¼Œç»è¿‡æŒ‡å®šæ—¶é—´æ²¡æœ‰è¿”å›æŠ›å‡ºTimeoutException</p>
</blockquote>
<blockquote>
<p>boolean isDone()ï¼šè‹¥Callableä»»åŠ¡å®Œæˆï¼Œè¿”å›True</p>
</blockquote>
<blockquote>
<p>boolean isCancelled()ï¼šå¦‚æœåœ¨Callableä»»åŠ¡æ­£å¸¸å®Œæˆå‰è¢«å–æ¶ˆï¼Œè¿”å›True</p>
</blockquote>
<p>ä»‹ç»äº†ç›¸å…³çš„æ¦‚å¿µä¹‹åï¼Œåˆ›å»ºå¹¶å¯åŠ¨æœ‰è¿”å›å€¼çš„çº¿ç¨‹çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p><font color="#006666"> 1ã€‘åˆ›å»ºCallableæ¥å£çš„å®ç°ç±»ï¼Œå¹¶å®ç°call()æ–¹æ³•ï¼Œç„¶ååˆ›å»ºè¯¥å®ç°ç±»çš„å®ä¾‹ï¼ˆä»java8å¼€å§‹å¯ä»¥ç›´æ¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼åˆ›å»ºCallableå¯¹è±¡ï¼‰ã€‚</font><br></p>
<p><font color="#006666">2ã€‘ä½¿ç”¨FutureTaskç±»æ¥åŒ…è£…Callableå¯¹è±¡ï¼Œè¯¥FutureTaskå¯¹è±¡å°è£…äº†Callableå¯¹è±¡çš„call()æ–¹æ³•çš„è¿”å›å€¼</font><br></p>
<p><font color="#006666">3ã€‘ä½¿ç”¨FutureTaskå¯¹è±¡ä½œä¸ºThreadå¯¹è±¡çš„targetåˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹ï¼ˆå› ä¸ºFutureTaskå®ç°äº†Runnableæ¥å£ï¼‰</font><br></p>
<p><font color="#006666">4ã€‘è°ƒç”¨FutureTaskå¯¹è±¡çš„get()æ–¹æ³•æ¥è·å¾—å­çº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼</font><br></p>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€MyThread3 th=<span class="keyword">new</span> MyThread3();</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€<span class="comment">//ä½¿ç”¨Lambdaè¡¨è¾¾å¼åˆ›å»ºCallableå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€   <span class="comment">//ä½¿ç”¨FutureTaskç±»æ¥åŒ…è£…Callableå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€FutureTask&lt;Integer&gt; future=<span class="keyword">new</span> FutureTask&lt;Integer&gt;(</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€(Callable&lt;Integer&gt;)()-&gt;&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line"></span><br><span class="line">ã€€ã€€  );</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€<span class="keyword">new</span> Thread(task,<span class="string">"æœ‰è¿”å›å€¼çš„çº¿ç¨‹"</span>).start();<span class="comment">//å®è´¨ä¸Šè¿˜æ˜¯ä»¥Callableå¯¹è±¡æ¥åˆ›å»ºå¹¶å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">ã€€ã€€  <span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="string">"å­çº¿ç¨‹çš„è¿”å›å€¼ï¼š"</span>+future.get());<span class="comment">//get()æ–¹æ³•ä¼šé˜»å¡ï¼Œç›´åˆ°å­çº¿ç¨‹æ‰§è¡Œç»“æŸæ‰è¿”å›</span></span><br><span class="line"></span><br><span class="line"> ã€€ã€€ &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€ex.printStackTrace();</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€&#125;</span><br><span class="line"></span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å‰ä¸‰ç§æ–¹å¼æ¯”è¾ƒï¼š</strong></p>
<p>å®ç°Runnableå’Œå®ç°Callableæ¥å£çš„æ–¹å¼åŸºæœ¬ç›¸åŒï¼Œä¸è¿‡æ˜¯åè€…æ‰§è¡Œcall()æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œåè€…çº¿ç¨‹æ‰§è¡Œä½“run()æ–¹æ³•æ— è¿”å›å€¼ï¼Œå› æ­¤å¯ä»¥æŠŠè¿™ä¸¤ç§æ–¹å¼å½’ä¸ºä¸€ç§è¿™ç§æ–¹å¼ä¸ç»§æ‰¿Threadç±»çš„æ–¹æ³•ä¹‹é—´çš„å·®åˆ«å¦‚ä¸‹ï¼š</p>
<p>1ã€çº¿ç¨‹åªæ˜¯å®ç°Runnableæˆ–å®ç°Callableæ¥å£ï¼Œè¿˜å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»ã€‚</p>
<p>2ã€è¿™ç§æ–¹å¼ä¸‹ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«ä¸€ä¸ªtargetå¯¹è±¡ï¼Œéå¸¸é€‚åˆå¤šçº¿ç¨‹å¤„ç†åŒä¸€ä»½èµ„æºçš„æƒ…å½¢ã€‚</p>
<p>3ã€ä½†æ˜¯ç¼–ç¨‹ç¨å¾®å¤æ‚ï¼Œå¦‚æœéœ€è¦è®¿é—®å½“å‰çº¿ç¨‹ï¼Œå¿…é¡»è°ƒç”¨Thread.currentThread()æ–¹æ³•ã€‚</p>
<p>4ã€ç»§æ‰¿Threadç±»çš„çº¿ç¨‹ç±»ä¸èƒ½å†ç»§æ‰¿å…¶ä»–çˆ¶ç±»ï¼ˆJavaå•ç»§æ‰¿å†³å®šï¼‰ã€‚</p>
<p>æ³¨ï¼šä¸€èˆ¬æ¨èé‡‡ç”¨å®ç°æ¥å£çš„æ–¹å¼æ¥åˆ›å»ºå¤šçº¿ç¨‹</p>
<p><strong>4)ä½¿ç”¨çº¿ç¨‹æ± ï¼Œä¾‹å¦‚ç”¨Executoræ¡†æ¶æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p>
<p>ä½¿ç”¨Executorså·¥å…·ç±»ä¸­çš„é™æ€å·¥å‚æ–¹æ³•ç”¨äºåˆ›å»ºçº¿ç¨‹æ± ã€‚</p>
<p>åˆ›å»ºçº¿ç¨‹æ± ä½¿ç”¨executeæ–¹æ³•å¯åŠ¨çº¿ç¨‹ã€‚</p>
<p>ä½¿ç”¨shutdownæ–¹æ³•ç­‰å¾…æäº¤çš„ä»»åŠ¡æ‰§è¡Œå®Œæˆå¹¶åå…³é—­çº¿ç¨‹ã€‚</p>
<p>Runnableå’ŒCallableæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<p>Runnableæ¥å£å®šä¹‰çš„runæ–¹æ³•ï¼ŒCallableå®šä¹‰çš„æ˜¯callæ–¹æ³•ã€‚</p>
<p>runæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œcallæ–¹æ³•å¿…é¡»æœ‰è¿”å›å€¼ã€‚</p>
<p>runæ–¹æ³•æ— æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œcallæ–¹æ³•å¯ä»¥æŠ›å‡ºchecked exceptionã€‚</p>
<p>Callableå’ŒRunnableéƒ½å¯ä»¥åº”ç”¨äºexecutorsã€‚è€ŒThreadç±»åªæ”¯æŒRunnable.</p>
<p>å‡ ç§æ–¹æ³•ä¼˜ç¼ºç‚¹å¯¹æ¯”ï¼š<a href="https://blog.csdn.net/sinat_27933301/article/details/69944286" target="_blank" rel="noopener">https://blog.csdn.net/sinat_27933301/article/details/69944286</a></p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>å †ä¸æ ˆçš„æ¦‚å¿µå’ŒåŒºåˆ«</title>
    <url>/2020/05/12/%E5%A0%86%E4%B8%8E%E6%A0%88%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E5%8C%BA%E5%88%AB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>â€‹        Javaç¨‹åºåœ¨è¿è¡Œæ—¶éƒ½è¦å¼€è¾Ÿç©ºé—´ï¼Œä»»ä½•è½¯ä»¶åœ¨è¿è¡Œæ—¶éƒ½è¦åœ¨å†…å­˜ä¸­å¼€è¾Ÿç©ºé—´ï¼ŒJavaè™šæ‹Ÿæœºè¿è¡Œæ—¶ä¹Ÿæ˜¯è¦å¼€è¾Ÿç©ºé—´çš„ã€‚JVMè¿è¡Œæ—¶åœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€ç‰‡å†…å­˜åŒºåŸŸï¼Œå¯åŠ¨æ—¶åœ¨è‡ªå·±çš„å†…å­˜åŒºåŸŸä¸­è¿›è¡Œæ›´ç»†è‡´çš„åˆ’åˆ†ï¼Œå› ä¸ºè™šæ‹Ÿæœºä¸­æ¯ä¸€ç‰‡å†…å­˜å¤„ç†çš„æ–¹å¼éƒ½ä¸åŒï¼Œæ‰€ä»¥è¦å•ç‹¬è¿›è¡Œç®¡ç†ã€‚</p>
<p>   JVMå†…å­˜çš„åˆ’åˆ†æœ‰äº”ç‰‡ï¼š</p>
<p>â€‹    1.  å¯„å­˜å™¨ï¼›</p>
<p>â€‹    2.  æœ¬åœ°æ–¹æ³•åŒºï¼›</p>
<p>â€‹    3.  æ–¹æ³•åŒºï¼›</p>
<p>â€‹    4.  æ ˆå†…å­˜ï¼›</p>
<p>â€‹    5.  å †å†…å­˜</p>
<img src="/2020/05/12/%E5%A0%86%E4%B8%8E%E6%A0%88%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E5%8C%BA%E5%88%AB/heapandstack.png" class title="å †ä¸æ ˆ">

<p> æˆ‘ä»¬é‡ç‚¹æ¥è¯´ä¸€ä¸‹å †å’Œæ ˆï¼š</p>
<p>â€‹        æ ˆå†…å­˜:æ ˆå†…å­˜é¦–å…ˆæ˜¯ä¸€ç‰‡å†…å­˜åŒºåŸŸï¼Œå­˜å‚¨çš„éƒ½æ˜¯å±€éƒ¨å˜é‡ï¼Œå‡¡æ˜¯å®šä¹‰åœ¨æ–¹æ³•ä¸­çš„éƒ½æ˜¯å±€éƒ¨å˜é‡ï¼ˆæ–¹æ³•å¤–çš„æ˜¯å…¨å±€å˜é‡ï¼‰ï¼Œforå¾ªç¯å†…éƒ¨å®šä¹‰çš„ä¹Ÿæ˜¯å±€éƒ¨å˜é‡ï¼Œæ˜¯å…ˆåŠ è½½å‡½æ•°æ‰èƒ½è¿›è¡Œå±€éƒ¨å˜é‡çš„å®šä¹‰ï¼Œæ‰€ä»¥æ–¹æ³•å…ˆè¿›æ ˆï¼Œç„¶åå†å®šä¹‰å˜é‡ï¼Œå˜é‡æœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œä¸€æ—¦ç¦»å¼€ä½œç”¨åŸŸï¼Œå˜é‡å°±ä¼šè¢«é‡Šæ”¾ã€‚æ ˆå†…å­˜çš„æ›´æ–°é€Ÿåº¦å¾ˆå¿«ï¼Œå› ä¸ºå±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸéƒ½å¾ˆçŸ­ã€‚</p>
<pre><code>å †å†…å­˜:å­˜å‚¨çš„æ˜¯æ•°ç»„å’Œå¯¹è±¡ï¼ˆå…¶å®æ•°ç»„å°±æ˜¯å¯¹è±¡ï¼‰ï¼Œå‡¡æ˜¯newå»ºç«‹çš„éƒ½æ˜¯åœ¨å †ä¸­ï¼Œå †ä¸­å­˜æ”¾çš„éƒ½æ˜¯å®ä½“ï¼ˆå¯¹è±¡ï¼‰ï¼Œå®ä½“ç”¨äºå°è£…æ•°æ®ï¼Œè€Œä¸”æ˜¯å°è£…å¤šä¸ªï¼ˆå®ä½“çš„å¤šä¸ªå±æ€§ï¼‰ï¼Œå¦‚æœä¸€ä¸ªæ•°æ®æ¶ˆå¤±ï¼Œè¿™ä¸ªå®ä½“ä¹Ÿæ²¡æœ‰æ¶ˆå¤±ï¼Œè¿˜å¯ä»¥ç”¨ï¼Œæ‰€ä»¥å †æ˜¯ä¸ä¼šéšæ—¶é‡Šæ”¾çš„ï¼Œä½†æ˜¯æ ˆä¸ä¸€æ ·ï¼Œæ ˆé‡Œå­˜æ”¾çš„éƒ½æ˜¯å•ä¸ªå˜é‡ï¼Œå˜é‡è¢«é‡Šæ”¾äº†ï¼Œé‚£å°±æ²¡æœ‰äº†ã€‚å †é‡Œçš„å®ä½“è™½ç„¶ä¸ä¼šè¢«é‡Šæ”¾ï¼Œä½†æ˜¯ä¼šè¢«å½“æˆåƒåœ¾ï¼ŒJavaæœ‰åƒåœ¾å›æ”¶æœºåˆ¶ä¸å®šæ—¶çš„æ”¶å–ã€‚</code></pre><p>JAVAçš„JVMçš„å†…å­˜å¯åˆ†ä¸º3ä¸ªåŒºï¼šå †(heap)ã€æ ˆ(stack)å’Œæ–¹æ³•åŒº(method)</p>
<p><strong>Â·    æ ˆåŒº:</strong></p>
<ol>
<li><p>æ¯ä¸ªçº¿ç¨‹åŒ…å«ä¸€ä¸ªæ ˆåŒºï¼Œæ ˆä¸­åªä¿å­˜æ–¹æ³•ä¸­ï¼ˆä¸åŒ…æ‹¬å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼‰çš„åŸºç¡€æ•°æ®ç±»å‹å’Œè‡ªå®šä¹‰å¯¹è±¡çš„å¼•ç”¨(ä¸æ˜¯å¯¹è±¡)ï¼Œå¯¹è±¡éƒ½å­˜æ”¾åœ¨å †åŒºä¸­</p>
</li>
<li><p>æ¯ä¸ªæ ˆä¸­çš„æ•°æ®(åŸå§‹ç±»å‹å’Œå¯¹è±¡å¼•ç”¨)éƒ½æ˜¯ç§æœ‰çš„ï¼Œå…¶ä»–æ ˆä¸èƒ½è®¿é—®ã€‚</p>
</li>
<li><p>æ ˆåˆ†ä¸º3ä¸ªéƒ¨åˆ†ï¼šåŸºæœ¬ç±»å‹å˜é‡åŒºã€æ‰§è¡Œç¯å¢ƒä¸Šä¸‹æ–‡ã€æ“ä½œæŒ‡ä»¤åŒº(å­˜æ”¾æ“ä½œæŒ‡ä»¤)ã€‚</p>
</li>
</ol>
<p><strong>Â·    å †åŒº:</strong></p>
<ol>
<li>å­˜å‚¨çš„å…¨éƒ¨æ˜¯å¯¹è±¡å®ä¾‹ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½åŒ…å«ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„classçš„ä¿¡æ¯(classä¿¡æ¯å­˜æ”¾åœ¨æ–¹æ³•åŒº)ã€‚</li>
<li>jvmåªæœ‰ä¸€ä¸ªå †åŒº(heap)è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå †ä¸­ä¸å­˜æ”¾åŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ï¼Œåªå­˜æ”¾å¯¹è±¡æœ¬èº«ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹å’Œæ•°ç»„éƒ½åœ¨å †ä¸­åˆ†é…</li>
</ol>
<p>Java çš„åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰ä¸»è¦é’ˆå¯¹å †åŒº</p>
<p><strong>Â·    æ–¹æ³•åŒº:</strong></p>
<ol>
<li><p>åˆå«é™æ€åŒºï¼Œè·Ÿå †ä¸€æ ·ï¼Œè¢«æ‰€æœ‰çš„çº¿ç¨‹å…±äº«ã€‚å®ƒç”¨äºå­˜å‚¨å·²ç»è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚</p>
<img src="/2020/05/12/%E5%A0%86%E4%B8%8E%E6%A0%88%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E5%8C%BA%E5%88%AB/p2.png" class title="javaå†…å­˜åŒºåŸŸ">

</li>
</ol>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>å¯¹ThreadLocalçš„ç†è§£</title>
    <url>/2020/05/16/%E5%AF%B9ThreadLocal%E7%9A%84%E7%90%86%E8%A7%A3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>ä½œç”¨ï¼š</p>
<p>ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªå‰¯æœ¬</p>
<p>ä¸»è¦å®ç°äº†åœ¨çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ä¼ é€’å¯¹è±¡</p>
<h4 id="ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šè¯æ˜ThreadLocalä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªå˜é‡å‰¯æœ¬"><a href="#ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šè¯æ˜ThreadLocalä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªå˜é‡å‰¯æœ¬" class="headerlink" title="ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šè¯æ˜ThreadLocalä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªå˜é‡å‰¯æœ¬"></a>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šè¯æ˜ThreadLocalä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªå˜é‡å‰¯æœ¬</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class ThreadLocalTest &#123;</span><br><span class="line"></span><br><span class="line">    private static ThreadLocal&lt;Long&gt; threadLocal &#x3D; new ThreadLocal&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        &#x2F;&#x2F;å¼€å¯å¤šä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡</span><br><span class="line">        Task task &#x3D; new Task();</span><br><span class="line">        new Thread(task).start();</span><br><span class="line">        Thread.sleep(10);</span><br><span class="line">        new Thread(task).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static class Task implements Runnable&#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void run() &#123;</span><br><span class="line">            Long result &#x3D; threadLocal.get();</span><br><span class="line">            if(result &#x3D;&#x3D; null)&#123;</span><br><span class="line">                threadLocal.set(System.currentTimeMillis());</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+&quot;-&gt;&quot;+threadLocal.get());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºçš„ç»“æœæ˜¯ä¸åŒçš„</p>
<h4 id="é—®é¢˜äºŒï¼šä¸ºä»€ä¹ˆå¯ä»¥ç»™æ¯ä¸ªçº¿ç¨‹ä¿å­˜ä¸€ä¸ªä¸åŒçš„å‰¯æœ¬"><a href="#é—®é¢˜äºŒï¼šä¸ºä»€ä¹ˆå¯ä»¥ç»™æ¯ä¸ªçº¿ç¨‹ä¿å­˜ä¸€ä¸ªä¸åŒçš„å‰¯æœ¬" class="headerlink" title="é—®é¢˜äºŒï¼šä¸ºä»€ä¹ˆå¯ä»¥ç»™æ¯ä¸ªçº¿ç¨‹ä¿å­˜ä¸€ä¸ªä¸åŒçš„å‰¯æœ¬"></a>é—®é¢˜äºŒï¼šä¸ºä»€ä¹ˆå¯ä»¥ç»™æ¯ä¸ªçº¿ç¨‹ä¿å­˜ä¸€ä¸ªä¸åŒçš„å‰¯æœ¬</h4><p>é‚£æˆ‘ä»¬æ¥åˆ†ææºç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Long result = threadLocal.get();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1.è·å–å½“å‰çº¿ç¨‹</span></span><br><span class="line">        Thread t = Thread.currentThread();</span><br><span class="line">        <span class="comment">//2ï¼Œè·å–åˆ°å½“å‰çº¿ç¨‹å¯¹åº”çš„map</span></span><br><span class="line">        ThreadLocalMap map = getMap(t);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (map != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">//3.ä»¥threadLocalä¸ºkeyï¼Œè·å–åˆ°entry</span></span><br><span class="line">            ThreadLocalMap.Entry e = map.getEntry(<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">                <span class="comment">//4.è·å–å¯¹åº”entryçš„valueï¼Œå°±æ˜¯æˆ‘ä»¬å­˜æ”¾åˆ°é‡Œé¢çš„å˜é‡çš„å‰¯æœ¬</span></span><br><span class="line">                T result = (T)e.value;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> setInitialValue();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬éœ€è¦ç»“åˆsetæ–¹æ³•çš„æºç åˆ†æï¼Œæ‰å¯ä»¥æ›´å¥½ç†è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">threadLocal.set(System.currentTimeMillis());</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1.è·å–åˆ°å½“å‰çº¿ç¨‹</span></span><br><span class="line">        Thread t = Thread.currentThread();</span><br><span class="line">        <span class="comment">//2.è·å–å½“å‰çº¿ç¨‹å¯¹åº”çš„map</span></span><br><span class="line">        ThreadLocalMap map = getMap(t);</span><br><span class="line">        <span class="keyword">if</span> (map != <span class="keyword">null</span>)</span><br><span class="line">            <span class="comment">//3.å¾€mapå­˜æ”¾ä¸€ä¸ªé”®å€¼å¯¹</span></span><br><span class="line">            <span class="comment">//this ThreadLocal</span></span><br><span class="line">            <span class="comment">//value ä¿å­˜çš„å‰¯æœ¬</span></span><br><span class="line">            map.set(<span class="keyword">this</span>, value);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            createMap(t, value);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¾—åˆ°ç»“è®ºï¼š</p>
<p>æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰å¯¹åº”çš„mapï¼Œmapæ¥ä¿å­˜é”®å€¼å¯¹ã€‚</p>
<h4 id="é—®é¢˜ä¸‰ï¼šThreadLocalè¿™ç§ç‰¹æ€§ï¼Œåœ¨å®é™…å¼€å‘ä¸­è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#é—®é¢˜ä¸‰ï¼šThreadLocalè¿™ç§ç‰¹æ€§ï¼Œåœ¨å®é™…å¼€å‘ä¸­è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="é—®é¢˜ä¸‰ï¼šThreadLocalè¿™ç§ç‰¹æ€§ï¼Œåœ¨å®é™…å¼€å‘ä¸­è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>é—®é¢˜ä¸‰ï¼šThreadLocalè¿™ç§ç‰¹æ€§ï¼Œåœ¨å®é™…å¼€å‘ä¸­è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h4><p>æ¯”å¦‚ï¼šhibernateç®¡ç†sessionï¼Œmybatisç®¡ç†sqlsessionï¼Œå…¶å†…éƒ¨éƒ½æ˜¯é‡‡ç”¨ThreadLocalæ¥å®ç°çš„ã€‚</p>
<p>å‰æçŸ¥è¯†ï¼šä¸ç®¡æ˜¯ä»€ä¹ˆæ¡†æ¶ï¼Œæœ€æœ¬è´¨çš„æ“ä½œéƒ½æ˜¯åŸºäºJDBCï¼Œå½“æˆ‘ä»¬éœ€è¦è·Ÿæ•°æ®åº“æ‰“äº¤é“çš„æ—¶å€™ï¼Œéƒ½éœ€è¦æœ‰ä¸€ä¸ªconnectionã€‚</p>
<p>é‚£ä¹ˆï¼Œå½“æˆ‘ä»¬éœ€è¦åœ¨ä¸šåŠ¡å±‚å®ç°äº‹åŠ¡æ§åˆ¶æ—¶ï¼Œè¯¥å¦‚ä½•è¾¾åˆ°è¿™ä¸ªæ•ˆæœï¼Ÿ</p>
<p>æˆ‘ä»¬æ„å»ºä¸‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class UserService &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;çœç•¥æ¥å£çš„å£°æ˜</span><br><span class="line">    private UserDao userDao &#x3D; new UserDao();</span><br><span class="line">    private LogDao logDao &#x3D; new LogDao();</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;äº‹åŠ¡çš„è¾¹ç•Œæ”¾åœ¨ä¸šåŠ¡å±‚</span><br><span class="line">    &#x2F;&#x2F;JDBCçš„å°è£…ï¼Œconnection</span><br><span class="line">    public void add()&#123;</span><br><span class="line">        userDao.add();</span><br><span class="line">        logDao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class UserDao &#123;</span><br><span class="line"></span><br><span class="line">    public void add()&#123;</span><br><span class="line">        System.out.println(&quot;UserDao addã€‚ã€‚ã€‚&quot;);</span><br><span class="line">        &#x2F;&#x2F;åˆ›å»ºconnectionå¯¹è±¡</span><br><span class="line">        &#x2F;&#x2F;connection.commit();</span><br><span class="line">        &#x2F;&#x2F;connection.rollback();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class LogDao &#123;</span><br><span class="line"></span><br><span class="line">    public void add()&#123;</span><br><span class="line">        System.out.println(&quot;LogDao addã€‚ã€‚ã€‚&quot;);</span><br><span class="line">        &#x2F;&#x2F;åˆ›å»ºconnectionå¯¹è±¡</span><br><span class="line">        &#x2F;&#x2F;connection.commit();</span><br><span class="line">        &#x2F;&#x2F;connection.rollback();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä»£ç æŒ‰ä¸Šé¢çš„æ–¹å¼æ¥ç®¡ç†connectionï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¿è¯serviceçš„äº‹åŠ¡æ§åˆ¶å—ï¼Ÿ</p>
<p>è¿™æ˜¯ä¸è¡Œçš„ï¼Œå‡è®¾ç¬¬ä¸€ä¸ªdaoæ“ä½œæˆåŠŸäº†ï¼Œé‚£ä¹ˆå®ƒå°±æäº¤äº‹åŠ¡äº†ï¼Œè€Œç¬¬äºŒä¸ªdaoæ“ä½œå¤±è´¥äº†ï¼Œå®ƒå›æ»šäº†äº‹åŠ¡ï¼Œä½†ä¸ä¼šå½±å“åˆ°ç¬¬ä¸€ä¸ªdaoçš„äº‹åŠ¡ï¼Œå› ä¸ºä¸Šé¢è¿™ä¹ˆå†™æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„äº‹åŠ¡</p>
<p>é‚£ä¹ˆæ€ä¹ˆè§£å†³ã€‚</p>
<p>ä¸Šé¢çš„æ ¹æºå°±æ˜¯ä¸¤ä¸ªdaoæ“ä½œçš„æ˜¯ä¸åŒçš„connection</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¿è¯æ˜¯åŒä¸ªconnectionå³å¯</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;äº‹åŠ¡çš„è¾¹ç•Œæ”¾åœ¨ä¸šåŠ¡å±‚</span><br><span class="line">&#x2F;&#x2F;JDBCçš„å°è£…ï¼Œconnection</span><br><span class="line">public void add()&#123;</span><br><span class="line">    Connection connection &#x3D; new Connection();</span><br><span class="line">    userDao.add(connection);</span><br><span class="line">    logDao.add(connection);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„æ–¹å¼ä»£ç ä¸å¤Ÿä¼˜é›…</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class ConnectionUtils &#123;</span><br><span class="line"></span><br><span class="line">    private static ThreadLocal&lt;Connection&gt; threadLocal &#x3D; new ThreadLocal&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    public static Connection getConnection()&#123;</span><br><span class="line">        Connection connection &#x3D; threadLocal.get();</span><br><span class="line">        if(connection &#x3D;&#x3D; null)&#123;</span><br><span class="line">            connection &#x3D; new Connection();</span><br><span class="line">            threadLocal.set(connection);</span><br><span class="line">        &#125;</span><br><span class="line">        return connection;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class UserDao &#123;</span><br><span class="line"></span><br><span class="line">    public void add()&#123;</span><br><span class="line">        System.out.println(&quot;UserDao addã€‚ã€‚ã€‚&quot;);</span><br><span class="line">        &#x2F;&#x2F;åˆ›å»ºconnectionå¯¹è±¡</span><br><span class="line">        &#x2F;&#x2F;connection.commit();</span><br><span class="line">        &#x2F;&#x2F;connection.rollback();</span><br><span class="line">        Connection connection &#x3D; ConnectionUtils.getConnection();</span><br><span class="line">        System.out.println(&quot;UserDao-&gt;&quot;+connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ°æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯ä¸¤ä¸ªdaoæ“ä½œçš„æ˜¯åŒä¸€ä¸ªconnection</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>â€‹        ThreadLocalç±»ç”¨æ¥æä¾›çº¿ç¨‹å†…éƒ¨çš„å±€éƒ¨å˜é‡ã€‚è¿™ç§å˜é‡åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è®¿é—®(é€šè¿‡getæˆ–setæ–¹æ³•è®¿é—®)æ—¶èƒ½ä¿è¯å„ä¸ªçº¿ç¨‹é‡Œçš„å˜é‡ç›¸å¯¹ç‹¬ç«‹äºå…¶ä»–çº¿ç¨‹å†…çš„å˜é‡ã€‚ThreadLocalå®ä¾‹é€šå¸¸æ¥è¯´éƒ½æ˜¯private staticç±»å‹çš„ï¼Œç”¨äºå…³è”çº¿ç¨‹å’Œçº¿ç¨‹çš„ä¸Šä¸‹æ–‡ã€‚ å¯ä»¥æ€»ç»“ä¸ºä¸€å¥è¯ï¼šThreadLocalçš„ä½œç”¨æ˜¯æä¾›çº¿ç¨‹å†…çš„å±€éƒ¨å˜é‡ï¼Œè¿™ç§å˜é‡åœ¨çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå†…èµ·ä½œç”¨ï¼Œå‡å°‘åŒä¸€ä¸ªçº¿ç¨‹å†…å¤šä¸ªå‡½æ•°æˆ–è€…ç»„ä»¶ä¹‹é—´ä¸€äº›å…¬å…±å˜é‡çš„ä¼ é€’çš„å¤æ‚åº¦ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘å‡ºé—¨éœ€è¦å…ˆåå…¬äº¤å†åšåœ°é“ï¼Œè¿™é‡Œçš„åå…¬äº¤å’Œååœ°é“å°±å¥½æ¯”æ˜¯åŒä¸€ä¸ªçº¿ç¨‹å†…çš„ä¸¤ä¸ªå‡½æ•°ï¼Œæˆ‘å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘è¦å®Œæˆè¿™ä¸¤ä¸ªå‡½æ•°éƒ½éœ€è¦åŒä¸€ä¸ªä¸œè¥¿ï¼šå…¬äº¤å¡ï¼ˆåŒ—äº¬å…¬äº¤å’Œåœ°é“éƒ½ä½¿ç”¨å…¬äº¤å¡ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä¸ºäº†ä¸å‘è¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¼ é€’å…¬äº¤å¡è¿™ä¸ªå˜é‡ï¼ˆç›¸å½“äºä¸æ˜¯ä¸€ç›´å¸¦ç€å…¬äº¤å¡ä¸Šè·¯ï¼‰ï¼Œæˆ‘å¯ä»¥è¿™ä¹ˆåšï¼šå°†å…¬äº¤å¡äº‹å…ˆäº¤ç»™ä¸€ä¸ªæœºæ„ï¼Œå½“æˆ‘éœ€è¦åˆ·å¡çš„æ—¶å€™å†å‘è¿™ä¸ªæœºæ„è¦å…¬äº¤å¡ï¼ˆå½“ç„¶æ¯æ¬¡æ‹¿çš„éƒ½æ˜¯åŒä¸€å¼ å…¬äº¤å¡ï¼‰ã€‚è¿™æ ·å°±èƒ½è¾¾åˆ°åªè¦æ˜¯æˆ‘(åŒä¸€ä¸ªçº¿ç¨‹)éœ€è¦å…¬äº¤å¡ï¼Œä½•æ—¶ä½•åœ°éƒ½èƒ½å‘è¿™ä¸ªæœºæ„è¦çš„ç›®çš„ã€‚ æœ‰äººè¦è¯´äº†ï¼šä½ å¯ä»¥å°†å…¬äº¤å¡è®¾ç½®ä¸ºå…¨å±€å˜é‡å•Šï¼Œè¿™æ ·ä¸æ˜¯ä¹Ÿèƒ½ä½•æ—¶ä½•åœ°éƒ½èƒ½å–å…¬äº¤å¡å—ï¼Ÿä½†æ˜¯å¦‚æœæœ‰å¾ˆå¤šä¸ªäººï¼ˆå¾ˆå¤šä¸ªçº¿ç¨‹ï¼‰å‘¢ï¼Ÿå¤§å®¶å¯ä¸èƒ½éƒ½ä½¿ç”¨åŒä¸€å¼ å…¬äº¤å¡å§(æˆ‘ä»¬å‡è®¾å…¬äº¤å¡æ˜¯å®åè®¤è¯çš„)ï¼Œè¿™æ ·ä¸å°±ä¹±å¥—äº†å˜›ã€‚ç°åœ¨æ˜ç™½äº†å§ï¼Ÿè¿™å°±æ˜¯ThreadLocalè®¾è®¡çš„åˆè¡·ï¼šæä¾›çº¿ç¨‹å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œåœ¨æœ¬çº¿ç¨‹å†…éšæ—¶éšåœ°å¯å–ï¼Œéš”ç¦»å…¶ä»–çº¿ç¨‹ã€‚</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°æ®åº“çš„ä¸‰å¤§èŒƒå¼</title>
    <url>/2020/05/16/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="1ï¼Œæ•°æ®åº“çš„ä¸‰å¤§èŒƒå¼"><a href="#1ï¼Œæ•°æ®åº“çš„ä¸‰å¤§èŒƒå¼" class="headerlink" title="1ï¼Œæ•°æ®åº“çš„ä¸‰å¤§èŒƒå¼"></a><strong>1ï¼Œæ•°æ®åº“çš„ä¸‰å¤§èŒƒå¼</strong></h2><blockquote>
<p>ç¬¬ä¸€èŒƒå¼ï¼šåˆ—ä¸å¯åˆ†<br>ç¬¬äºŒèŒƒå¼ï¼šè¦æœ‰ä¸»é”®<br>ç¬¬ä¸‰èŒƒå¼ï¼šä¸å¯å­˜åœ¨ä¼ é€’ä¾èµ–<br>æ¯”å¦‚å•†å“è¡¨é‡Œé¢å…³è”å•†å“ç±»åˆ«è¡¨ï¼Œé‚£ä¹ˆåªéœ€è¦ä¸€ä¸ªå…³è”å­—æ®µproduct_type_idå³å¯ï¼Œå…¶ä»–å­—æ®µä¿¡æ¯å¯ä»¥é€šè¿‡è¡¨å…³è”æŸ¥è¯¢å³å¯å¾—åˆ°<br><strong>å¦‚æœå•†å“è¡¨è¿˜å­˜åœ¨ä¸€ä¸ªå•†å“ç±»åˆ«åç§°å­—æ®µï¼Œå¦‚product_type_nameï¼Œé‚£å°±å±äºå­˜åœ¨ä¼ é€’ä¾èµ–çš„æƒ…å†µï¼Œç¬¬ä¸‰èŒƒå¼ä¸»è¦æ˜¯ä»ç©ºé—´çš„è§’åº¦æ¥è€ƒè™‘ï¼Œé¿å…äº§ç”Ÿå†—ä½™ä¿¡æ¯ï¼Œæµªè´¹ç£ç›˜ç©ºé—´</strong></p>
</blockquote>
<h2 id="2ï¼ŒåèŒƒå¼è®¾è®¡ï¼š-ç¬¬ä¸‰èŒƒå¼"><a href="#2ï¼ŒåèŒƒå¼è®¾è®¡ï¼š-ç¬¬ä¸‰èŒƒå¼" class="headerlink" title="2ï¼ŒåèŒƒå¼è®¾è®¡ï¼š(ç¬¬ä¸‰èŒƒå¼)"></a><strong>2ï¼ŒåèŒƒå¼è®¾è®¡ï¼š(ç¬¬ä¸‰èŒƒå¼)</strong></h2><blockquote>
<p>ä¸ºä»€ä¹ˆä¼šæœ‰åèŒƒå¼è®¾è®¡ï¼Ÿ<br>åŸå› ä¸€ï¼šæé«˜æŸ¥è¯¢æ•ˆç‡ï¼ˆè¯»å¤šå†™å°‘ï¼‰<br>æ¯”å¦‚ä¸Šè¿°çš„æè¿°ä¸­ï¼Œæ˜¾ç¤ºå•†å“ä¿¡æ¯æ—¶ï¼Œç»å¸¸éœ€è¦ä¼´éšå•†å“ç±»åˆ«ä¿¡æ¯çš„å±•ç¤ºï¼Œ<br>æ‰€ä»¥è¿™ä¸ªæ—¶å€™ï¼Œä¸ºäº†æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œå¯ä»¥é€šè¿‡å†—ä½™ä¸€ä¸ªå•†å“åç§°å­—æ®µï¼Œè¿™ä¸ªå¯ä»¥å°†åŸå…ˆçš„è¡¨å…³è”æŸ¥è¯¢è½¬æ¢ä¸ºå•è¡¨æŸ¥è¯¢</p>
</blockquote>
<blockquote>
<p>åŸå› äºŒï¼šä¿å­˜å†å²å¿«ç…§ä¿¡æ¯<br>æ¯”å¦‚è®¢å•è¡¨ï¼Œé‡Œé¢éœ€è¦åŒ…å«æ”¶è´§äººçš„å„é¡¹ä¿¡æ¯ï¼Œå¦‚å§“åï¼Œç”µè¯ï¼Œåœ°å€ç­‰ç­‰ï¼Œè¿™äº›éƒ½å±äºå†å²å¿«ç…§ï¼Œéœ€è¦å†—ä½™ä¿å­˜èµ·æ¥ï¼Œ<br>ä¸èƒ½é€šè¿‡ä¿å­˜ç”¨æˆ·åœ°å€IDå»å…³è”æŸ¥è¯¢ï¼Œå› ä¸ºç”¨æˆ·çš„æ”¶è´§äººä¿¡æ¯å¯èƒ½ä¼šåœ¨åæœŸå‘ç”Ÿå˜æ›´</p>
</blockquote>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°æ®åº“è¿æ¥æ± çš„ä½œç”¨</title>
    <url>/2020/05/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E4%BD%9C%E7%94%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h4 id="æ•°æ®åº“è¿æ¥æ± çš„ä½œç”¨"><a href="#æ•°æ®åº“è¿æ¥æ± çš„ä½œç”¨" class="headerlink" title="æ•°æ®åº“è¿æ¥æ± çš„ä½œç”¨"></a>æ•°æ®åº“è¿æ¥æ± çš„ä½œç”¨</h4><p>â€‹        å¯¹äºä¸€ä¸ªç®€å•çš„æ•°æ®åº“å¼•ç”¨ï¼Œç”¨äºå¯¹æ•°æ®åº“çš„è®¿é—®ä¸æ˜¯å¾ˆé¢‘ç¹ã€‚è¿™æ—¶å°±å¯ä»¥ç®€å•çš„åœ¨éœ€è¦è®¿é—®æ•°æ®åº“æ˜¯ï¼Œå°±åˆ›å»ºä¸€ä¸ªè¿æ¥ï¼Œç”¨å®Œåå°±å…³é—­å®ƒï¼Œè¿™æ ·åšä¹Ÿä¸ä¼šå¸¦æ¥ä»€ä¹ˆæ˜æ˜¾çš„æ€§èƒ½ä¸Šçš„å¼€é”€ã€‚ä½†æ˜¯å¯¹äºä¸€ä¸ªå¤æ‚çš„æ•°æ®åº“å¼•ç”¨ï¼Œæƒ…å†µå°±å®Œå…¨ä¸åŒäº†ã€‚é¢‘ç¹çš„å»ºç«‹ã€å…³é—­è¿æ¥ï¼Œä¼šæå¤§çš„å‡ä½ç³»ç»Ÿçš„æ€§èƒ½ï¼Œå› ä¸ºå¯¹äºè¿æ¥çš„ä½¿ç”¨æˆäº†ç³»ç»Ÿæ€§èƒ½çš„ç“¶é¢ˆã€‚</p>
<p>ã€€ã€€å¯¹äºå…±äº«èµ„æºï¼Œæœ‰ä¸€ä¸ªå¾ˆè‘—åçš„è®¾è®¡æ¨¡å¼ï¼šèµ„æºæ± ã€‚è¯¥æ¨¡å¼æ­£æ˜¯ä¸ºäº†è§£å†³èµ„æºé¢‘ç¹åˆ†é…ã€é‡Šæ”¾æ‰€é€ æˆçš„é—®é¢˜çš„ã€‚æŠŠè¯¥æ¨¡å¼åº”ç”¨åˆ°æ•°æ®åº“è¿æ¥ç®¡ç†é¢†åŸŸï¼Œå°±æ˜¯å»ºç«‹ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œæä¾›ä¸€å¥—é«˜æ•ˆçš„è¿æ¥åˆ†é…ã€ä½¿ç”¨ç­–ç•¥ï¼Œæœ€ç»ˆç›®æ ‡æ˜¯å®ç°è¿æ¥çš„é«˜æ•ˆã€å®‰å…¨çš„å¤ç”¨ã€‚ </p>
<p>ã€€ã€€æ•°æ®åº“è¿æ¥æ± çš„åŸºæœ¬åŸç†æ˜¯åœ¨å†…éƒ¨å¯¹è±¡æ± ä¸­ç»´æŠ¤ä¸€å®šæ•°é‡çš„æ•°æ®åº“è¿æ¥ï¼Œå¹¶å¯¹å¤–æš´éœ²æ•°æ®åº“è¿æ¥è·å–å’Œè¿”å›æ–¹æ³•ã€‚å¦‚ï¼šå¤–éƒ¨ä½¿ç”¨è€…å¯é€šè¿‡getConnection æ–¹æ³•è·å–è¿æ¥ï¼Œä½¿ç”¨å®Œæ¯•åå†é€šè¿‡releaseConnection æ–¹æ³•å°†è¿æ¥è¿”å›ï¼Œæ³¨æ„æ­¤æ—¶è¿æ¥å¹¶æ²¡æœ‰å…³é—­ï¼Œè€Œæ˜¯ç”±è¿æ¥æ± ç®¡ç†å™¨å›æ”¶ï¼Œå¹¶ä¸ºä¸‹ä¸€æ¬¡ä½¿ç”¨åšå¥½å‡†å¤‡ã€‚</p>
<p>æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯å¸¦æ¥çš„ä¼˜åŠ¿ï¼š</p>
<p><strong>1.é™å®šäº†æ•°æ®åº“è¿æ¥çš„ä¸ªæ•°ï¼Œä¸ä¼šç”±äºæ•°æ®åº“è¿æ¥è¿‡å¤šï¼Œå¯¼è‡´ç³»ç»Ÿè¿è¡Œç¼“æ…¢æˆ–è€…å´©æºƒ</strong></p>
<p><strong>2.ä¸éœ€è¦æ¯æ¬¡å»åˆ›å»ºæˆ–é”€æ¯ï¼ŒèŠ‚çº¦èµ„æº</strong></p>
<p><strong>3.ä¸éœ€è¦æ¯æ¬¡éƒ½å»åˆ›å»ºï¼Œç›¸åº”æ—¶é—´æ›´å¿«</strong></p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>æµè§ˆå™¨ä¸­è¾“å…¥urlä¼šå‘ç”Ÿçš„è¿‡ç¨‹</title>
    <url>/2020/05/11/%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E8%BE%93%E5%85%A5url%E4%BC%9A%E5%8F%91%E7%94%9F%E7%9A%84%E8%BF%87%E7%A8%8B/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>æ¸¸è§ˆå™¨è¾“å…¥åœ°å€ä¹‹åä¸æœåŠ¡å™¨äº¤äº’çš„å…·ä½“æ­¥éª¤</p>
<ol>
<li><p>DNSåŸŸåè§£æ</p>
</li>
<li><p>å»ºç«‹TCPè¿æ¥</p>
</li>
<li><p>å‘é€HTTPè¯·æ±‚</p>
</li>
<li><p>æœåŠ¡å™¨å¤„ç†è¯·æ±‚</p>
</li>
<li><p>è¿”å›ç»“æœå“åº”</p>
</li>
<li><p>å…³é—­TCPè¿æ¥</p>
</li>
<li><p>æ¸¸è§ˆå™¨è§£æHTML</p>
</li>
<li><p>å¸ƒå±€æ¸²æŸ“</p>
<p><a href="https://blog.csdn.net/ZWE7616175/article/details/80484905" target="_blank" rel="noopener">è¯¦ç»†ä»‹ç»åœ°å€</a></p>
</li>
</ol>
<h5 id="Tcpçš„ä¸‰æ¬¡æ¡æ‰‹åè®®"><a href="#Tcpçš„ä¸‰æ¬¡æ¡æ‰‹åè®®" class="headerlink" title="Tcpçš„ä¸‰æ¬¡æ¡æ‰‹åè®®"></a>Tcpçš„ä¸‰æ¬¡æ¡æ‰‹åè®®</h5>

<p><img src="/2020/05/11/%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E8%BE%93%E5%85%A5url%E4%BC%9A%E5%8F%91%E7%94%9F%E7%9A%84%E8%BF%87%E7%A8%8B/tcp3.png" alt="æ²¡æœ‰æ‰¾åˆ°è¿™å¼ å›¾ç‰‡"></p>
<p><strong>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š</strong>å»ºç«‹è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€synåŒ…ï¼ˆsyn=xï¼‰åˆ°æœåŠ¡å™¨ï¼Œå¹¶è¿›å…¥SYN_SENTçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨ç¡®è®¤ï¼›SYNï¼šåŒæ­¥åºåˆ—ç¼–å·ï¼ˆSynchronize Sequence Numbersï¼‰ã€‚</p>
<p><strong>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š</strong>æœåŠ¡å™¨æ”¶åˆ°synåŒ…ï¼Œå¿…é¡»ç¡®è®¤å®¢æˆ·çš„SYNï¼ˆack=x+1ï¼‰ï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿå‘é€ä¸€ä¸ªSYNåŒ…ï¼ˆsyn=yï¼‰ï¼Œå³SYN+ACKåŒ…ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥SYN_RECVçŠ¶æ€ï¼›</p>
<p><strong>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š</strong>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„SYN+ACKåŒ…ï¼Œå‘æœåŠ¡å™¨å‘é€ç¡®è®¤åŒ…ACK(ack=y+1ï¼‰ï¼Œæ­¤åŒ…å‘é€å®Œæ¯•ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿›å…¥ESTABLISHEDï¼ˆTCPè¿æ¥æˆåŠŸï¼‰çŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€‚</p>
<h5 id="å¸¸è§é¢è¯•é¢˜"><a href="#å¸¸è§é¢è¯•é¢˜" class="headerlink" title="å¸¸è§é¢è¯•é¢˜"></a><strong>å¸¸è§é¢è¯•é¢˜</strong></h5><p><strong>ã€é—®é¢˜1ã€‘</strong>ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹ï¼Ÿ</p>
<p>ç­”ï¼šå› ä¸ºå½“Serverç«¯æ”¶åˆ°Clientç«¯çš„SYNè¿æ¥è¯·æ±‚æŠ¥æ–‡åï¼Œå¯ä»¥ç›´æ¥å‘é€SYN+ACKæŠ¥æ–‡ã€‚å…¶ä¸­ACKæŠ¥æ–‡æ˜¯ç”¨æ¥åº”ç­”çš„ï¼ŒSYNæŠ¥æ–‡æ˜¯ç”¨æ¥åŒæ­¥çš„ã€‚ä½†æ˜¯å…³é—­è¿æ¥æ—¶ï¼Œå½“Serverç«¯æ”¶åˆ°FINæŠ¥æ–‡æ—¶ï¼Œå¾ˆå¯èƒ½å¹¶ä¸ä¼šç«‹å³å…³é—­SOCKETï¼Œæ‰€ä»¥åªèƒ½å…ˆå›å¤ä¸€ä¸ªACKæŠ¥æ–‡ï¼Œå‘Šè¯‰Clientç«¯ï¼Œâ€ä½ å‘çš„FINæŠ¥æ–‡æˆ‘æ”¶åˆ°äº†â€ã€‚åªæœ‰ç­‰åˆ°æˆ‘Serverç«¯æ‰€æœ‰çš„æŠ¥æ–‡éƒ½å‘é€å®Œäº†ï¼Œæˆ‘æ‰èƒ½å‘é€FINæŠ¥æ–‡ï¼Œå› æ­¤ä¸èƒ½ä¸€èµ·å‘é€ã€‚æ•…éœ€è¦å››æ­¥æ¡æ‰‹ã€‚</p>
<p><strong>ã€é—®é¢˜2ã€‘</strong>ä¸ºä»€ä¹ˆTIME_WAITçŠ¶æ€éœ€è¦ç»è¿‡2MSL(æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´)æ‰èƒ½è¿”å›åˆ°CLOSEçŠ¶æ€ï¼Ÿ</p>
<p>ç­”ï¼šè™½ç„¶æŒ‰é“ç†ï¼Œå››ä¸ªæŠ¥æ–‡éƒ½å‘é€å®Œæ¯•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›å…¥CLOSEçŠ¶æ€äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¿…é¡»å‡è±¡ç½‘ç»œæ˜¯ä¸å¯é çš„ï¼Œæœ‰å¯ä»¥æœ€åä¸€ä¸ªACKä¸¢å¤±ã€‚æ‰€ä»¥TIME_WAITçŠ¶æ€å°±æ˜¯ç”¨æ¥é‡å‘å¯èƒ½ä¸¢å¤±çš„ACKæŠ¥æ–‡ã€‚åœ¨Clientå‘é€å‡ºæœ€åçš„ACKå›å¤ï¼Œä½†è¯¥ACKå¯èƒ½ä¸¢å¤±ã€‚Serverå¦‚æœæ²¡æœ‰æ”¶åˆ°ACKï¼Œå°†ä¸æ–­é‡å¤å‘é€FINç‰‡æ®µã€‚æ‰€ä»¥Clientä¸èƒ½ç«‹å³å…³é—­ï¼Œå®ƒå¿…é¡»ç¡®è®¤Serveræ¥æ”¶åˆ°äº†è¯¥ACKã€‚Clientä¼šåœ¨å‘é€å‡ºACKä¹‹åè¿›å…¥åˆ°TIME_WAITçŠ¶æ€ã€‚Clientä¼šè®¾ç½®ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œç­‰å¾…2MSLçš„æ—¶é—´ã€‚å¦‚æœåœ¨è¯¥æ—¶é—´å†…å†æ¬¡æ”¶åˆ°FINï¼Œé‚£ä¹ˆClientä¼šé‡å‘ACKå¹¶å†æ¬¡ç­‰å¾…2MSLã€‚æ‰€è°“çš„2MSLæ˜¯ä¸¤å€çš„MSL(Maximum Segment Lifetime)ã€‚MSLæŒ‡ä¸€ä¸ªç‰‡æ®µåœ¨ç½‘ç»œä¸­æœ€å¤§çš„å­˜æ´»æ—¶é—´ï¼Œ2MSLå°±æ˜¯ä¸€ä¸ªå‘é€å’Œä¸€ä¸ªå›å¤æ‰€éœ€çš„æœ€å¤§æ—¶é—´ã€‚å¦‚æœç›´åˆ°2MSLï¼ŒClientéƒ½æ²¡æœ‰å†æ¬¡æ”¶åˆ°FINï¼Œé‚£ä¹ˆClientæ¨æ–­ACKå·²ç»è¢«æˆåŠŸæ¥æ”¶ï¼Œåˆ™ç»“æŸTCPè¿æ¥ã€‚</p>
<p><strong>ã€é—®é¢˜3ã€‘</strong>ä¸ºä»€ä¹ˆä¸èƒ½ç”¨ä¸¤æ¬¡æ¡æ‰‹è¿›è¡Œè¿æ¥ï¼Ÿ</p>
<p>ç­”ï¼š3æ¬¡æ¡æ‰‹å®Œæˆä¸¤ä¸ªé‡è¦çš„åŠŸèƒ½ï¼Œæ—¢è¦åŒæ–¹åšå¥½å‘é€æ•°æ®çš„å‡†å¤‡å·¥ä½œ(åŒæ–¹éƒ½çŸ¥é“å½¼æ­¤å·²å‡†å¤‡å¥½)ï¼Œä¹Ÿè¦å…è®¸åŒæ–¹å°±åˆå§‹åºåˆ—å·è¿›è¡Œåå•†ï¼Œè¿™ä¸ªåºåˆ—å·åœ¨æ¡æ‰‹è¿‡ç¨‹ä¸­è¢«å‘é€å’Œç¡®è®¤ã€‚</p>
<p>â€‹    ç°åœ¨æŠŠä¸‰æ¬¡æ¡æ‰‹æ”¹æˆä»…éœ€è¦ä¸¤æ¬¡æ¡æ‰‹ï¼Œæ­»é”æ˜¯å¯èƒ½å‘ç”Ÿçš„ã€‚ä½œä¸ºä¾‹å­ï¼Œè€ƒè™‘è®¡ç®—æœºSå’ŒCä¹‹é—´çš„é€šä¿¡ï¼Œå‡å®šCç»™Så‘é€ä¸€ä¸ªè¿æ¥è¯·æ±‚åˆ†ç»„ï¼ŒSæ”¶åˆ°äº†è¿™ä¸ªåˆ†ç»„ï¼Œå¹¶å‘ é€äº†ç¡®è®¤åº”ç­”åˆ†ç»„ã€‚æŒ‰ç…§ä¸¤æ¬¡æ¡æ‰‹çš„åå®šï¼ŒSè®¤ä¸ºè¿æ¥å·²ç»æˆåŠŸåœ°å»ºç«‹äº†ï¼Œå¯ä»¥å¼€å§‹å‘é€æ•°æ®åˆ†ç»„ã€‚å¯æ˜¯ï¼ŒCåœ¨Sçš„åº”ç­”åˆ†ç»„åœ¨ä¼ è¾“ä¸­è¢«ä¸¢å¤±çš„æƒ…å†µä¸‹ï¼Œå°†ä¸çŸ¥é“S æ˜¯å¦å·²å‡†å¤‡å¥½ï¼Œä¸çŸ¥é“Så»ºç«‹ä»€ä¹ˆæ ·çš„åºåˆ—å·ï¼ŒCç”šè‡³æ€€ç–‘Sæ˜¯å¦æ”¶åˆ°è‡ªå·±çš„è¿æ¥è¯·æ±‚åˆ†ç»„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒCè®¤ä¸ºè¿æ¥è¿˜æœªå»ºç«‹æˆåŠŸï¼Œå°†å¿½ç•¥Så‘æ¥çš„ä»»ä½•æ•°æ®åˆ† ç»„ï¼Œåªç­‰å¾…è¿æ¥ç¡®è®¤åº”ç­”åˆ†ç»„ã€‚è€ŒSåœ¨å‘å‡ºçš„åˆ†ç»„è¶…æ—¶åï¼Œé‡å¤å‘é€åŒæ ·çš„åˆ†ç»„ã€‚è¿™æ ·å°±å½¢æˆäº†æ­»é”ã€‚</p>
<p><strong>ã€é—®é¢˜4ã€‘</strong>å¦‚æœå·²ç»å»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯å®¢æˆ·ç«¯çªç„¶å‡ºç°æ•…éšœäº†æ€ä¹ˆåŠï¼Ÿ</p>
<p>TCPè¿˜è®¾æœ‰ä¸€ä¸ªä¿æ´»è®¡æ—¶å™¨ï¼Œæ˜¾ç„¶ï¼Œå®¢æˆ·ç«¯å¦‚æœå‡ºç°æ•…éšœï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸€ç›´ç­‰ä¸‹å»ï¼Œç™½ç™½æµªè´¹èµ„æºã€‚æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„è¯·æ±‚åéƒ½ä¼šé‡æ–°å¤ä½è¿™ä¸ªè®¡æ—¶å™¨ï¼Œæ—¶é—´é€šå¸¸æ˜¯è®¾ç½®ä¸º2å°æ—¶ï¼Œè‹¥ä¸¤å°æ—¶è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„ä»»ä½•æ•°æ®ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µï¼Œä»¥åæ¯éš”75ç§’é’Ÿå‘é€ä¸€æ¬¡ã€‚è‹¥ä¸€è¿å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡ä»ç„¶æ²¡ååº”ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±å…³é—­è¿æ¥ã€‚</p>
<p><a href="https://blog.csdn.net/qq_38950316/article/details/81087809" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a></p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>çº¿ç¨‹çš„äº”å¤§çŠ¶æ€åŠå…¶è½¬æ¢</title>
    <url>/2020/05/13/%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%BA%94%E5%A4%A7%E7%8A%B6%E6%80%81%E5%8F%8A%E5%85%B6%E8%BD%AC%E6%8D%A2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p> resumeä¸suspendedä¸€èµ·ä½¿ç”¨ </p>
<p>waitä¸notify(notifyAll)ä¸€èµ·ä½¿ç”¨</p>
<p>sleepä¼šè®©çº¿ç¨‹æš‚æ—¶ä¸æ‰§è¡Œ </p>
<p>suspend() å’Œ resume() æ–¹æ³•ï¼šä¸¤ä¸ªæ–¹æ³•é…å¥—ä½¿ç”¨ï¼Œsuspend()ä½¿å¾—çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå¹¶ä¸”ä¸ä¼šè‡ªåŠ¨æ¢å¤ï¼Œå¿…é¡»å…¶å¯¹åº”çš„ resume() è¢«è°ƒç”¨ï¼Œæ‰èƒ½ä½¿å¾—çº¿ç¨‹é‡æ–°è¿›å…¥å¯æ‰§è¡ŒçŠ¶æ€ã€‚    </p>
<p>çº¿ç¨‹ä»åˆ›å»ºã€è¿è¡Œåˆ°ç»“æŸæ€»æ˜¯å¤„äºä¸‹é¢äº”ä¸ªçŠ¶æ€ä¹‹ä¸€ï¼šæ–°å»ºçŠ¶æ€ã€å°±ç»ªçŠ¶æ€ã€è¿è¡ŒçŠ¶æ€ã€é˜»å¡çŠ¶æ€åŠæ­»äº¡çŠ¶æ€ã€‚    </p>
<p>å„çº¿ç¨‹ä¹‹é—´çš„è½¬æ¢å¦‚ä¸‹å›¾ï¼š</p>
<img src="/2020/05/13/%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%BA%94%E5%A4%A7%E7%8A%B6%E6%80%81%E5%8F%8A%E5%85%B6%E8%BD%AC%E6%8D%A2/p1.png" class title="çº¿ç¨‹ä¹‹é—´çš„è½¬æ¢">

<p> <strong>1.æ–°å»ºçŠ¶æ€(New)ï¼š</strong> å½“ç”¨newæ“ä½œç¬¦åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œ ä¾‹å¦‚new Thread(r)ï¼Œçº¿ç¨‹è¿˜æ²¡æœ‰å¼€å§‹è¿è¡Œï¼Œæ­¤æ—¶çº¿ç¨‹å¤„åœ¨æ–°å»ºçŠ¶æ€ã€‚ å½“ä¸€ä¸ªçº¿ç¨‹å¤„äºæ–°ç”ŸçŠ¶æ€æ—¶ï¼Œç¨‹åºè¿˜æ²¡æœ‰å¼€å§‹è¿è¡Œçº¿ç¨‹ä¸­çš„ä»£ç </p>
<p>   <strong>2.å°±ç»ªçŠ¶æ€(Runnable)ï¼š</strong>ä¸€ä¸ªæ–°åˆ›å»ºçš„çº¿ç¨‹å¹¶ä¸è‡ªåŠ¨å¼€å§‹è¿è¡Œï¼Œè¦æ‰§è¡Œçº¿ç¨‹ï¼Œå¿…é¡»è°ƒç”¨çº¿ç¨‹çš„start()æ–¹æ³•ã€‚</p>
<p> å½“çº¿ç¨‹å¯¹è±¡è°ƒç”¨start()æ–¹æ³•å³å¯åŠ¨äº†çº¿ç¨‹ï¼Œstart()æ–¹æ³•åˆ›å»ºçº¿ç¨‹è¿è¡Œçš„ç³»ç»Ÿèµ„æºï¼Œ</p>
<p> å¹¶è°ƒåº¦çº¿ç¨‹è¿è¡Œrun()æ–¹æ³•ã€‚å½“start()æ–¹æ³•è¿”å›åï¼Œçº¿ç¨‹å°±å¤„äºå°±ç»ªçŠ¶æ€ã€‚</p>
<p> å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹å¹¶ä¸ä¸€å®šç«‹å³è¿è¡Œrun()æ–¹æ³•ï¼Œçº¿ç¨‹è¿˜å¿…é¡»åŒå…¶ä»–çº¿ç¨‹ç«äº‰CPU</p>
<p> æ—¶é—´ï¼Œåªæœ‰è·å¾—CPUæ—¶é—´æ‰å¯ä»¥è¿è¡Œçº¿ç¨‹ã€‚å› ä¸ºåœ¨å•CPUçš„è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œä¸å¯èƒ½</p>
<p> åŒæ—¶è¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªæ—¶åˆ»ä»…æœ‰ä¸€ä¸ªçº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ã€‚å› æ­¤æ­¤æ—¶å¯èƒ½æœ‰å¤šä¸ª</p>
<p> çº¿ç¨‹å¤„äºå°±ç»ªçŠ¶æ€ã€‚å¯¹å¤šä¸ªå¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹æ˜¯ç”±Javaè¿è¡Œæ—¶ç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦</p>
<p> ç¨‹åº(thread scheduler)æ¥è°ƒåº¦çš„ã€‚    </p>
<p><strong>3.è¿è¡ŒçŠ¶æ€(Running)ï¼š</strong>å½“çº¿ç¨‹è·å¾—CPUæ—¶é—´åï¼Œå®ƒæ‰è¿›å…¥è¿è¡ŒçŠ¶æ€ï¼ŒçœŸæ­£å¼€å§‹æ‰§è¡Œrun()æ–¹æ³•.    </p>
<p><strong>4.é˜»å¡çŠ¶æ€(Blocked)ï¼š</strong></p>
<p> çº¿ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ç”±äºå„ç§åŸå› è¿›å…¥é˜»å¡çŠ¶æ€: 1&gt;çº¿ç¨‹é€šè¿‡è°ƒç”¨sleepæ–¹æ³•è¿›å…¥ç¡çœ çŠ¶æ€ï¼› 2&gt;çº¿ç¨‹è°ƒç”¨ä¸€ä¸ªåœ¨I/Oä¸Šè¢«é˜»å¡çš„æ“ä½œï¼Œå³è¯¥æ“ä½œåœ¨è¾“å…¥è¾“å‡ºæ“ä½œå®Œæˆä¹‹å‰ä¸ä¼šè¿”å›åˆ°å®ƒçš„è°ƒç”¨è€…ï¼› 3&gt;çº¿ç¨‹è¯•å›¾å¾—åˆ°ä¸€ä¸ªé”ï¼Œè€Œè¯¥é”æ­£è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼› 4&gt;çº¿ç¨‹åœ¨ç­‰å¾…æŸä¸ªè§¦å‘æ¡ä»¶ï¼› â€¦â€¦</p>
<p> æ‰€è°“é˜»å¡çŠ¶æ€æ˜¯æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ²¡æœ‰è¿è¡Œç»“æŸï¼Œæš‚æ—¶è®©å‡ºCPUï¼Œè¿™æ—¶å…¶ä»–å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹å°±å¯ä»¥è·å¾—CPUæ—¶é—´ï¼Œ è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚    </p>
<p><strong>5.æ­»äº¡çŠ¶æ€(Dead)</strong></p>
<p> æœ‰ä¸¤ä¸ªåŸå› ä¼šå¯¼è‡´çº¿ç¨‹æ­»äº¡ï¼š      </p>
<p>ï¼ˆ1ï¼‰runæ–¹æ³•æ­£å¸¸é€€å‡ºè€Œè‡ªç„¶æ­»äº¡ï¼Œ</p>
<p>ï¼ˆ2ï¼‰ä¸€ä¸ªæœªæ•è·çš„å¼‚å¸¸ç»ˆæ­¢äº†runæ–¹æ³•è€Œä½¿çº¿ç¨‹çŒæ­»ã€‚</p>
<p>ä¸ºäº†ç¡®å®šçº¿ç¨‹åœ¨å½“å‰æ˜¯å¦å­˜æ´»ç€ï¼ˆå°±æ˜¯è¦ä¹ˆæ˜¯å¯è¿è¡Œçš„ï¼Œè¦ä¹ˆæ˜¯è¢«é˜»å¡äº†ï¼‰ï¼Œéœ€è¦ä½¿ç”¨isAliveæ–¹æ³•ã€‚å¦‚æœæ˜¯ å¯è¿è¡Œæˆ–è¢«é˜»å¡ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›trueï¼› å¦‚æœçº¿ç¨‹ä»æ—§æ˜¯newçŠ¶æ€ä¸”ä¸æ˜¯å¯è¿è¡Œçš„ï¼Œ æˆ–è€…çº¿ç¨‹æ­»äº¡äº†ï¼Œ åˆ™è¿”å›false.     </p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>æœ‰å…³javaåŸºæœ¬ç±»å‹çš„é»˜è®¤å€¼å’Œå–å€¼èŒƒå›´</title>
    <url>/2020/05/12/%E6%9C%89%E5%85%B3java%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E7%9A%84%E9%BB%98%E8%AE%A4%E5%80%BC%E5%92%8C%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>â€‹        </p>
<table>
<thead>
<tr>
<th align="center">ç±»å‹</th>
<th align="center">é»˜è®¤å€¼</th>
<th align="center">å–å€¼èŒƒå›´</th>
<th align="center">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å­—èŠ‚å‹</td>
<td align="center">0</td>
<td align="center">-2^7â€”-2^7-1</td>
<td align="center">byte b=10;</td>
</tr>
<tr>
<td align="center">å­—ç¬¦å‹</td>
<td align="center">\u0000</td>
<td align="center">0â€”-2^16-1</td>
<td align="center">char c=â€™câ€™;</td>
</tr>
<tr>
<td align="center">short</td>
<td align="center">0</td>
<td align="center">-2^15â€”-2^15-1</td>
<td align="center">short s=10;</td>
</tr>
<tr>
<td align="center">int</td>
<td align="center">0</td>
<td align="center">-2^31â€”-2^31-1</td>
<td align="center">int i=10;</td>
</tr>
<tr>
<td align="center">long</td>
<td align="center">0</td>
<td align="center">-2^63â€”-2^63-1</td>
<td align="center">long o=10L;</td>
</tr>
<tr>
<td align="center">float</td>
<td align="center">0.0f</td>
<td align="center">-2^31â€”-2^31-1</td>
<td align="center">float f=10.0F</td>
</tr>
<tr>
<td align="center">double</td>
<td align="center">0.0d</td>
<td align="center">-2^63â€”-2^63-1</td>
<td align="center">double d=10.0;</td>
</tr>
<tr>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">true\false</td>
<td align="center">boolean flag=true;</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ‹è¯•</title>
    <url>/2020/05/08/%E6%B5%8B%E8%AF%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p>æ²¡æœ‰ä»€ä¹ˆï¼Œæµ‹è¯•è€Œå·²</p>
]]></content>
      <categories>
        <category>æµ‹è¯•</category>
      </categories>
  </entry>
  <entry>
    <title>è§£å†³hashå†²çªçš„æ–¹æ³•</title>
    <url>/2020/05/15/%E8%A7%A3%E5%86%B3hash%E5%86%B2%E7%AA%81%E7%9A%84%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h4 id="1-ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ" class="headerlink" title="1.ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ"></a>1.ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼Ÿ</h4><p>ç†è§£å“ˆå¸Œå‡½æ•°</p>
<p>å…³é”®å­—å’Œå®ƒåœ¨è¡¨ä¸­å­˜å‚¨ä½ç½®ä¹‹é—´å­˜åœ¨ä¸€ç§å‡½æ•°å…³ç³»ã€‚è¿™ä¸ªå‡½æ•°æˆ‘ä»¬ç§°ä¸ºä¸ºå“ˆå¸Œå‡½æ•°ã€‚</p>
<p>hash:æ•£åˆ—ã€æ‚å‡‘ </p>
<p>â€‹        å°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥ï¼Œé€šè¿‡æ•£åˆ—ç®—æ³•ï¼Œå˜æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºï¼Œè¿™ç§æ˜¯ä¸€ç§å‹ç¼©æ˜ å°„.</p>
<pre><code>é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸åŒçš„è¾“å…¥å¯èƒ½ä¼šäº§ç”Ÿç›¸åŒçš„æ•£åˆ—å€¼ï¼Œå³è¿™ç§çŠ¶å†µä¸‹ä»–ä»¬å¯¹åº”çš„å“ˆå¸Œæ•°çš„å€¼æ˜¯ç›¸åŒçš„ï¼Œå› ä¸ºå€¼ç›¸åŒæ‰€ä»¥ä¸å¯èƒ½ç”±æ•£åˆ—å€¼ç¡®å®šå”¯ä¸€çš„è¾“å…¥å€¼ï¼Œè¿™ç§æƒ…å†µå°±æ˜¯å“ˆå¸Œå†²çª</code></pre><p>â€‹        é”®(key)ç»è¿‡hashå‡½æ•°å¾—åˆ°çš„ç»“æœä½œä¸ºåœ°å€å»å­˜æ”¾å½“å‰çš„é”®å€¼å¯¹(key-value)(hashmapçš„å­˜å€¼æ–¹å¼)ï¼Œä½†æ˜¯å´å‘ç°è¯¥åœ°å€å·²ç»æœ‰å€¼äº†ï¼Œå°±ä¼šäº§ç”Ÿå†²çªã€‚è¿™ä¸ªå†²çªå°±æ˜¯hashå†²çªäº†ã€‚</p>
<p>â€‹        æ¢å¥è¯è¯´å°±æ˜¯ï¼šå¦‚æœä¸¤ä¸ªä¸åŒå¯¹è±¡çš„hashCodeç›¸åŒï¼Œè¿™ç§ç°è±¡ç§°ä¸ºhashå†²çªã€‚</p>
<h4 id="2-è§£å†³å“ˆå¸Œå†²çª"><a href="#2-è§£å†³å“ˆå¸Œå†²çª" class="headerlink" title="2. è§£å†³å“ˆå¸Œå†²çª"></a>2. è§£å†³å“ˆå¸Œå†²çª</h4><p>è§£å†³å“ˆå¸Œå†²çªä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š</p>
<p><strong>å¼€æ”¾å®šå€æ³•</strong></p>
<p><strong>å†å“ˆå¸Œæ³•</strong></p>
<p><strong>é“¾åœ°å€æ³•</strong></p>
<p><strong>å»ºç«‹å…¬å…±æº¢å‡ºåŒº</strong></p>
<h5 id="1-å¼€æ”¾å®šå€æ³•"><a href="#1-å¼€æ”¾å®šå€æ³•" class="headerlink" title="(1)å¼€æ”¾å®šå€æ³•"></a>(1)å¼€æ”¾å®šå€æ³•</h5><p>è¿™ç§æ–¹æ³•çš„æ„æ€æ˜¯ï¼šå½“å…³é”®å­—keyçš„å“ˆå¸Œåœ°å€p=Hï¼ˆkeyï¼‰å‡ºç°å†²çªæ—¶ï¼Œä»¥pä¸ºåŸºç¡€ï¼Œäº§ç”Ÿå¦ä¸€ä¸ªå“ˆå¸Œåœ°å€p1ï¼Œå¦‚æœp1ä»ç„¶å†²çªï¼Œå†ä»¥pä¸ºåŸºç¡€ï¼Œäº§ç”Ÿå¦ä¸€ä¸ªå“ˆå¸Œåœ°å€p2ï¼Œâ€¦ï¼Œç›´åˆ°æ‰¾å‡ºä¸€ä¸ªä¸å†²çªçš„å“ˆå¸Œåœ°å€pi ï¼Œå°†ç›¸åº”å…ƒç´ å­˜å…¥å…¶ä¸­ã€‚ï¼ˆThreadLocalMapä¸­ä½¿ç”¨å¼€æ”¾åœ°å€æ³•æ¥å¤„ç†æ•£åˆ—å†²çªï¼Œè€ŒHashMapä¸­ä½¿ç”¨çš„æ˜¯åˆ†ç¦»é“¾è¡¨æ³•ã€‚ä¹‹æ‰€ä»¥é‡‡ç”¨ä¸åŒçš„æ–¹å¼ä¸»è¦æ˜¯å› ä¸ºï¼šåœ¨ThreadLocalMapä¸­çš„æ•£åˆ—å€¼åˆ†æ•£å¾—ååˆ†å‡åŒ€ï¼Œå¾ˆå°‘ä¼šå‡ºç°å†²çªã€‚å¹¶ä¸”ThreadLocalMapç»å¸¸éœ€è¦æ¸…é™¤æ— ç”¨çš„å¯¹è±¡ï¼Œä½¿ç”¨çº¯æ•°ç»„æ›´åŠ æ–¹ä¾¿ã€‚ï¼‰</p>
<p>çº¿æ€§æ¢æµ‹å†æ•£åˆ—</p>
<p>å½“å‘ç”Ÿå†²çªçš„æ—¶å€™ï¼Œé¡ºåºçš„æŸ¥çœ‹ä¸‹ä¸€ä¸ªå•å…ƒ</p>
<p>äºŒæ¬¡(å¹³æ–¹)æ¢æµ‹å†æ•£åˆ—</p>
<p>å½“å‘ç”Ÿå†²çªçš„æ—¶å€™ï¼Œåœ¨è¡¨çš„å·¦å³è¿›è¡Œè·³è·ƒå¼æ¢æµ‹</p>
<h5 id="2-å†hashæ³•"><a href="#2-å†hashæ³•" class="headerlink" title="(2)å†hashæ³•"></a>(2)å†hashæ³•</h5><p>â€‹        è¿™ç§æ–¹å¼æ˜¯åŒæ—¶æ„é€ å¤šä¸ªå“ˆå¸Œå‡½æ•°ï¼Œå½“äº§ç”Ÿå†²çªæ—¶ï¼Œè®¡ç®—å¦ä¸€ä¸ªå“ˆå¸Œå‡½æ•°çš„å€¼ã€‚</p>
<p>â€‹        è¿™ç§æ–¹æ³•ä¸æ˜“äº§ç”Ÿèšé›†ï¼Œä½†å¢åŠ äº†è®¡ç®—æ—¶é—´ã€‚</p>
<h5 id="3-é“¾åœ°å€æ³•"><a href="#3-é“¾åœ°å€æ³•" class="headerlink" title="(3)é“¾åœ°å€æ³•"></a>(3)é“¾åœ°å€æ³•</h5><p>â€‹        å°†æ‰€æœ‰å“ˆå¸Œåœ°å€ç›¸åŒçš„éƒ½é“¾æ¥åœ¨åŒä¸€ä¸ªé“¾è¡¨ä¸­ ï¼Œå› è€ŒæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤ä¸»è¦åœ¨åŒä¹‰è¯é“¾ä¸­è¿›è¡Œã€‚é“¾åœ°å€æ³•é€‚ç”¨äºç»å¸¸è¿›è¡Œæ’å…¥å’Œåˆ é™¤çš„æƒ…å†µã€‚</p>
<p>â€‹        hashmapå°±æ˜¯ç”¨æ­¤æ–¹æ³•è§£å†³å†²çªçš„ã€‚è¿™æ˜¯Java1.7ä¹‹å‰è§£å†³hashå†²çªçš„ä¸»è¦åŠæ³•ï¼Œä½†æ˜¯åœ¨Java1.8ä¹‹åï¼Œå°±å¯¹è¯¥æ–¹æ³•è¿›è¡Œäº†å‡çº§ï¼Œè¿ç”¨çº¢é»‘æ ‘çš„ç®—æ³•è§£å†³æ’å…¥å€¼ç›¸åŒè¿‡å¤šçš„é—®é¢˜ã€‚</p>
<h5 id="4-å»ºç«‹ä¸€ä¸ªå…¬å…±æº¢å‡ºåŒº"><a href="#4-å»ºç«‹ä¸€ä¸ªå…¬å…±æº¢å‡ºåŒº" class="headerlink" title="(4)å»ºç«‹ä¸€ä¸ªå…¬å…±æº¢å‡ºåŒº"></a>(4)å»ºç«‹ä¸€ä¸ªå…¬å…±æº¢å‡ºåŒº</h5><p>â€‹        å°†å“ˆå¸Œè¡¨åˆ†ä¸ºåŸºæœ¬è¡¨å’Œæº¢å‡ºè¡¨ä¸¤éƒ¨åˆ†ï¼Œå‡¡æ˜¯å’ŒåŸºæœ¬è¡¨å‘ç”Ÿå†²çªçš„å…ƒç´ ï¼Œä¸€å¾‹å¡«å…¥æº¢å‡ºè¡¨ã€‚</p>
<h4 id="3-HashMap-HaspTable-ConcurrentHaspMapçš„åŒºåˆ«"><a href="#3-HashMap-HaspTable-ConcurrentHaspMapçš„åŒºåˆ«" class="headerlink" title="3.HashMap,HaspTable,ConcurrentHaspMapçš„åŒºåˆ«"></a>3.HashMap,HaspTable,ConcurrentHaspMapçš„åŒºåˆ«</h4><h5 id="1-haspmapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯æ•ˆç‡å¿«ï¼Œå¦‚æœä¸æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¸€èˆ¬ä½¿ç”¨çš„å°±æ˜¯hashmap"><a href="#1-haspmapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯æ•ˆç‡å¿«ï¼Œå¦‚æœä¸æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¸€èˆ¬ä½¿ç”¨çš„å°±æ˜¯hashmap" class="headerlink" title="(1)haspmapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯æ•ˆç‡å¿«ï¼Œå¦‚æœä¸æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¸€èˆ¬ä½¿ç”¨çš„å°±æ˜¯hashmap."></a>(1)haspmapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯æ•ˆç‡å¿«ï¼Œå¦‚æœä¸æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¸€èˆ¬ä½¿ç”¨çš„å°±æ˜¯hashmap.</h5><h5 id="2-hashtableè™½ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯æ•ˆç‡å¾ˆä½ï¼Œå°±ç®—æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬ä¹Ÿä¸ä¼šç”¨å®ƒã€‚"><a href="#2-hashtableè™½ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯æ•ˆç‡å¾ˆä½ï¼Œå°±ç®—æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬ä¹Ÿä¸ä¼šç”¨å®ƒã€‚" class="headerlink" title="(2)hashtableè™½ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯æ•ˆç‡å¾ˆä½ï¼Œå°±ç®—æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬ä¹Ÿä¸ä¼šç”¨å®ƒã€‚"></a>(2)hashtableè™½ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯æ•ˆç‡å¾ˆä½ï¼Œå°±ç®—æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬ä¹Ÿä¸ä¼šç”¨å®ƒã€‚</h5><h5 id="3-concurrenthashmapé‡‡ç”¨çš„æ˜¯åˆ†æ®µä¸Šé”æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å°†å…¶ä¸­å­˜å‚¨çš„hashè¡¨è¿›è¡Œåˆ†æ®µä¸Šé”ï¼Œè¿™æ ·å°±åœ¨æ•ˆç‡å’Œå®‰å…¨ä¸Šåšåˆ°äº†ä¸¤è€…å…¼é¡¾ã€‚"><a href="#3-concurrenthashmapé‡‡ç”¨çš„æ˜¯åˆ†æ®µä¸Šé”æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å°†å…¶ä¸­å­˜å‚¨çš„hashè¡¨è¿›è¡Œåˆ†æ®µä¸Šé”ï¼Œè¿™æ ·å°±åœ¨æ•ˆç‡å’Œå®‰å…¨ä¸Šåšåˆ°äº†ä¸¤è€…å…¼é¡¾ã€‚" class="headerlink" title="(3)concurrenthashmapé‡‡ç”¨çš„æ˜¯åˆ†æ®µä¸Šé”æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å°†å…¶ä¸­å­˜å‚¨çš„hashè¡¨è¿›è¡Œåˆ†æ®µä¸Šé”ï¼Œè¿™æ ·å°±åœ¨æ•ˆç‡å’Œå®‰å…¨ä¸Šåšåˆ°äº†ä¸¤è€…å…¼é¡¾ã€‚"></a>(3)concurrenthashmapé‡‡ç”¨çš„æ˜¯åˆ†æ®µä¸Šé”æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å°†å…¶ä¸­å­˜å‚¨çš„hashè¡¨è¿›è¡Œåˆ†æ®µä¸Šé”ï¼Œè¿™æ ·å°±åœ¨æ•ˆç‡å’Œå®‰å…¨ä¸Šåšåˆ°äº†ä¸¤è€…å…¼é¡¾ã€‚</h5>]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>é¢å‘å¯¹è±¡çš„äº”å¤§åŸºæœ¬åŸåˆ™</title>
    <url>/2020/05/12/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%BA%94%E5%A4%A7%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h4 id="é¢å‘å¯¹è±¡çš„äº”å¤§åŸºæœ¬åŸåˆ™"><a href="#é¢å‘å¯¹è±¡çš„äº”å¤§åŸºæœ¬åŸåˆ™" class="headerlink" title="é¢å‘å¯¹è±¡çš„äº”å¤§åŸºæœ¬åŸåˆ™"></a>é¢å‘å¯¹è±¡çš„äº”å¤§åŸºæœ¬åŸåˆ™</h4><p><strong>å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle-Resposibility Principleï¼‰ï¼š</strong></p>
<p>ä¸€ä¸ªç±»ï¼Œæœ€å¥½åªåšä¸€ä»¶äº‹ï¼Œåªæœ‰ä¸€ä¸ªå¼•èµ·å®ƒçš„å˜åŒ–ã€‚å•ä¸€èŒè´£åŸåˆ™å¯ä»¥çœ‹åšæ˜¯ä½è€¦åˆã€é«˜å†…èšåœ¨é¢å‘å¯¹è±¡åŸåˆ™ä¸Šçš„å¼•ç”³ï¼Œå°†èŒè´£å®šä¹‰ä¸ºå¼•èµ·å˜åŒ–çš„åŸå› ï¼Œä»¥æé«˜å†…èšæ€§æ¥å‡å°‘å¼•èµ·å˜åŒ–çš„åŸå› ã€‚</p>
<p><strong>å¼€æ”¾å°é—­åŸåˆ™ï¼ˆOpen-Closed principleï¼‰ï¼š</strong></p>
<p>è½¯ä»¶å®ä½“åº”è¯¥æ˜¯å¯æ‰©å±•çš„ï¼Œè€Œä¸å¯ä¿®æ”¹çš„ã€‚ä¹Ÿå°±æ˜¯ï¼Œå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­çš„ã€‚ </p>
<p><strong>Liskovæ›¿æ¢åŸåˆ™ï¼ˆLiskov-Substituion Principleï¼‰ï¼š</strong></p>
<p>å­ç±»å¿…é¡»èƒ½å¤Ÿæ›¿æ¢å…¶åŸºç±»ã€‚è¿™ä¸€æ€æƒ³ä½“ç°ä¸ºå¯¹ç»§æ‰¿æœºåˆ¶çš„çº¦æŸè§„èŒƒï¼Œåªæœ‰å­ç±»èƒ½å¤Ÿæ›¿æ¢åŸºç±»æ—¶ï¼Œæ‰èƒ½ä¿è¯ç³»ç»Ÿåœ¨è¿è¡ŒæœŸå†…è¯†åˆ«å­ç±»ï¼Œè¿™æ˜¯ä¿è¯ç»§æ‰¿å¤ç”¨çš„åŸºç¡€ã€‚ </p>
<p><strong>ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependecy-Inversion Principleï¼‰ï¼š</strong></p>
<p>ä¾èµ–äºæŠ½è±¡ã€‚å…·ä½“è€Œè¨€å°±æ˜¯é«˜å±‚æ¨¡å—ä¸ä¾èµ–äºåº•å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åŒä¾èµ–äºæŠ½è±¡ï¼›æŠ½è±¡ä¸ä¾èµ–äºå…·ä½“ï¼Œå…·ä½“ä¾èµ–äºæŠ½è±¡ã€‚ </p>
<p><strong>æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface-Segregation Principleï¼‰ï¼š</strong></p>
<p>ä½¿ç”¨å¤šä¸ªå°çš„ä¸“é—¨çš„æ¥å£ï¼Œè€Œä¸è¦ä½¿ç”¨ä¸€ä¸ªå¤§çš„æ€»æ¥å£</p>
]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œ</title>
    <url>/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h1 id="åˆ†å±‚çš„æ¦‚å¿µ"><a href="#åˆ†å±‚çš„æ¦‚å¿µ" class="headerlink" title="åˆ†å±‚çš„æ¦‚å¿µ"></a><center>åˆ†å±‚çš„æ¦‚å¿µ</center></h1><h3 id="é—®é¢˜-1ï¼šOSI-æœ‰å“ªå‡ å±‚ï¼Œä¼šç”»å‡ºæ¥ï¼ŒçŸ¥é“ä¸»è¦å‡ å±‚çš„å„è‡ªä½œç”¨"><a href="#é—®é¢˜-1ï¼šOSI-æœ‰å“ªå‡ å±‚ï¼Œä¼šç”»å‡ºæ¥ï¼ŒçŸ¥é“ä¸»è¦å‡ å±‚çš„å„è‡ªä½œç”¨" class="headerlink" title="é—®é¢˜ 1ï¼šOSI æœ‰å“ªå‡ å±‚ï¼Œä¼šç”»å‡ºæ¥ï¼ŒçŸ¥é“ä¸»è¦å‡ å±‚çš„å„è‡ªä½œç”¨"></a>é—®é¢˜ 1ï¼šOSI æœ‰å“ªå‡ å±‚ï¼Œä¼šç”»å‡ºæ¥ï¼ŒçŸ¥é“ä¸»è¦å‡ å±‚çš„å„è‡ªä½œç”¨</h3><ol>
<li><p>åº”ç”¨å±‚ï¼ˆæ•°æ®ï¼‰ï¼šç¡®å®šè¿›ç¨‹ä¹‹é—´é€šä¿¡çš„æ€§è´¨ä»¥æ»¡è¶³ç”¨æˆ·éœ€è¦ä»¥åŠæä¾›ç½‘ç»œä¸ç”¨æˆ·åº”ç”¨</p>
</li>
<li><p>è¡¨ç¤ºå±‚ï¼ˆæ•°æ®ï¼‰ï¼šä¸»è¦è§£å†³æ‹¥æŠ¤ä¿¡æ¯çš„è¯­æ³•è¡¨ç¤ºé—®é¢˜ï¼Œå¦‚åŠ å¯†è§£å¯†</p>
</li>
<li><p>ä¼šè¯å±‚ï¼ˆæ•°æ®ï¼‰ï¼šæä¾›åŒ…æ‹¬è®¿é—®éªŒè¯å’Œä¼šè¯ç®¡ç†åœ¨å†…çš„å»ºç«‹å’Œç»´æŠ¤åº”ç”¨ä¹‹é—´é€šä¿¡çš„æœºåˆ¶ï¼Œå¦‚æœåŠ¡å™¨éªŒè¯ç”¨æˆ·ç™»å½•ä¾¿æ˜¯ç”±ä¼šè¯å±‚å®Œæˆçš„</p>
</li>
<li><p>ä¼ è¾“å±‚ï¼ˆæ®µï¼‰ï¼šå®ç°ç½‘ç»œä¸åŒä¸»æœºä¸Šç”¨æˆ·è¿›ç¨‹ä¹‹é—´çš„æ•°æ®é€šä¿¡ï¼Œå¯é ä¸ä¸å¯é çš„ä¼ è¾“ï¼Œä¼ è¾“å±‚çš„é”™è¯¯æ£€æµ‹ï¼Œæµé‡æ§åˆ¶ç­‰</p>
</li>
<li><p>ç½‘ç»œå±‚ï¼ˆåŒ…ï¼‰ï¼šæä¾›é€»è¾‘åœ°å€ï¼ˆIPï¼‰ã€é€‰è·¯ï¼Œæ•°æ®ä»æºç«¯åˆ°ç›®çš„ç«¯çš„ä¼ è¾“</p>
</li>
<li><p>æ•°æ®é“¾è·¯å±‚ï¼ˆå¸§ï¼‰ï¼šå°†ä¸Šå±‚æ•°æ®å°è£…æˆå¸§ï¼Œç”¨ MAC åœ°å€è®¿é—®åª’ä»‹ï¼Œé”™è¯¯æ£€æµ‹ä¸ä¿®æ­£</p>
</li>
<li><p>ç‰©ç†å±‚ï¼ˆæ¯”ç‰¹æµï¼‰ï¼šè®¾å¤‡ä¹‹é—´æ¯”ç‰¹æµçš„ä¼ è¾“ï¼Œç‰©ç†æ¥å£ï¼Œç”µæ°”ç‰¹æ€§ç­‰</p>
</li>
</ol>
<h3 id="é—®é¢˜-2ï¼šçŸ¥é“å„ä¸ªå±‚ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ•°æ®äº¤æ¢è®¾å¤‡ã€‚ï¼ˆäº¤æ¢æœºã€è·¯ç”±å™¨ã€ç½‘å…³ï¼‰"><a href="#é—®é¢˜-2ï¼šçŸ¥é“å„ä¸ªå±‚ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ•°æ®äº¤æ¢è®¾å¤‡ã€‚ï¼ˆäº¤æ¢æœºã€è·¯ç”±å™¨ã€ç½‘å…³ï¼‰" class="headerlink" title="é—®é¢˜ 2ï¼šçŸ¥é“å„ä¸ªå±‚ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ•°æ®äº¤æ¢è®¾å¤‡ã€‚ï¼ˆäº¤æ¢æœºã€è·¯ç”±å™¨ã€ç½‘å…³ï¼‰"></a>é—®é¢˜ 2ï¼šçŸ¥é“å„ä¸ªå±‚ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ•°æ®äº¤æ¢è®¾å¤‡ã€‚ï¼ˆäº¤æ¢æœºã€è·¯ç”±å™¨ã€ç½‘å…³ï¼‰</h3><ol>
<li><p>ç½‘å…³ï¼šåº”ç”¨å±‚ã€ä¼ è¾“å±‚ï¼ˆç½‘å…³åœ¨ä¼ è¾“å±‚ä¸Šä»¥å®ç°ç½‘ç»œäº’è¿ï¼Œæ˜¯æœ€å¤æ‚çš„ç½‘ç»œäº’è¿è®¾å¤‡ï¼Œä»…ç”¨äºä¸¤ä¸ªé«˜å±‚åè®®ä¸åŒçš„ç½‘ç»œäº’è¿ã€‚ç½‘å…³çš„ç»“æ„ä¹Ÿå’Œè·¯ç”±å™¨ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯äº’è¿å±‚ã€‚ç½‘å…³æ—¢å¯ä»¥ç”¨äºå¹¿åŸŸç½‘äº’è¿ï¼Œä¹Ÿå¯ä»¥ç”¨äºå±€åŸŸç½‘äº’è¿ï¼‰</p>
</li>
<li><p>è·¯ç”±å™¨ï¼šç½‘ç»œå±‚ï¼ˆè·¯ç”±é€‰æ‹©ã€å­˜å‚¨è½¬å‘ï¼‰</p>
</li>
<li><p>äº¤æ¢æœºï¼šæ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ï¼ˆè¯†åˆ«æ•°æ®åŒ…ä¸­çš„ MAC åœ°å€ä¿¡æ¯ï¼Œæ ¹æ® MAC åœ°å€è¿›è¡Œè½¬å‘ï¼Œå¹¶å°†è¿™äº› MAC åœ°å€ä¸å¯¹åº”çš„ç«¯å£è®°å½•åœ¨è‡ªå·±å†…éƒ¨çš„ä¸€ä¸ªåœ°å€è¡¨ä¸­ï¼‰</p>
</li>
<li><p>ç½‘æ¡¥ï¼šæ•°æ®é“¾è·¯å±‚ï¼ˆå°†ä¸¤ä¸ª LAN è¿èµ·æ¥ï¼Œæ ¹æ® MAC åœ°å€æ¥è½¬å‘å¸§ï¼‰</p>
</li>
<li><p>é›†çº¿å™¨ï¼ˆHubï¼‰ï¼šç‰©ç†å±‚ï¼ˆçº¯ç¡¬ä»¶è®¾å¤‡ï¼Œä¸»è¦ç”¨æ¥è¿æ¥è®¡ç®—æœºç­‰ç½‘ç»œç»ˆç«¯ï¼‰</p>
</li>
<li><p>ä¸­ç»§å™¨ï¼šç‰©ç†å±‚ï¼ˆåœ¨æ¯”ç‰¹çº§åˆ«å¯¹ç½‘ç»œä¿¡å·è¿›è¡Œå†ç”Ÿå’Œé‡å®šæ—¶ï¼Œä»è€Œä½¿å¾—å®ƒä»¬èƒ½å¤Ÿåœ¨ç½‘ç»œä¸Šä¼ è¾“æ›´é•¿çš„è·ç¦»ï¼‰</p>
</li>
</ol>
<h1 id="æ•°æ®é“¾è·¯å±‚"><a href="#æ•°æ®é“¾è·¯å±‚" class="headerlink" title="æ•°æ®é“¾è·¯å±‚"></a><center>æ•°æ®é“¾è·¯å±‚</center></h1><h2 id="ARP-åè®®"><a href="#ARP-åè®®" class="headerlink" title="ARP åè®®"></a>ARP åè®®</h2><h3 id="é—®é¢˜-1ï¼šARP-çš„ä½œç”¨ï¼Ÿ"><a href="#é—®é¢˜-1ï¼šARP-çš„ä½œç”¨ï¼Ÿ" class="headerlink" title="é—®é¢˜ 1ï¼šARP çš„ä½œç”¨ï¼Ÿ"></a>é—®é¢˜ 1ï¼šARP çš„ä½œç”¨ï¼Ÿ</h3><p>ARP ä¸º IP åœ°å€åˆ°å¯¹åº”çš„ç¡¬ä»¶åœ°å€æä¾›åŠ¨æ€æ˜ å°„ã€‚</p>
<h3 id="é—®é¢˜-2ï¼šç‚¹å¯¹ç‚¹é“¾è·¯ä½¿ç”¨-ARP-å—ï¼Ÿ"><a href="#é—®é¢˜-2ï¼šç‚¹å¯¹ç‚¹é“¾è·¯ä½¿ç”¨-ARP-å—ï¼Ÿ" class="headerlink" title="é—®é¢˜ 2ï¼šç‚¹å¯¹ç‚¹é“¾è·¯ä½¿ç”¨ ARP å—ï¼Ÿ"></a>é—®é¢˜ 2ï¼šç‚¹å¯¹ç‚¹é“¾è·¯ä½¿ç”¨ ARP å—ï¼Ÿ</h3><p>ä¸ä½¿ç”¨ </p>
<h3 id="é—®é¢˜-3ï¼šARP-é«˜æ•ˆè¿è¡Œçš„å…³é”®æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#é—®é¢˜-3ï¼šARP-é«˜æ•ˆè¿è¡Œçš„å…³é”®æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="é—®é¢˜ 3ï¼šARP é«˜æ•ˆè¿è¡Œçš„å…³é”®æ˜¯ä»€ä¹ˆï¼Ÿ"></a>é—®é¢˜ 3ï¼šARP é«˜æ•ˆè¿è¡Œçš„å…³é”®æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å…³é”®æ˜¯æ¯ä¸ªä¸»æœºä¸Šéƒ½æœ‰ä¸€ä¸ª ARP çš„é«˜é€Ÿç¼“å­˜ã€‚</p>
<h3 id="é—®é¢˜-4ï¼šARP-æŠ¥æ–‡çš„å„ä¸ªå­—æ®µä»¥åŠå«ä¹‰ï¼Ÿ"><a href="#é—®é¢˜-4ï¼šARP-æŠ¥æ–‡çš„å„ä¸ªå­—æ®µä»¥åŠå«ä¹‰ï¼Ÿ" class="headerlink" title="é—®é¢˜ 4ï¼šARP æŠ¥æ–‡çš„å„ä¸ªå­—æ®µä»¥åŠå«ä¹‰ï¼Ÿ"></a>é—®é¢˜ 4ï¼šARP æŠ¥æ–‡çš„å„ä¸ªå­—æ®µä»¥åŠå«ä¹‰ï¼Ÿ</h3> <img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/arp.png" class title="ARP æŠ¥æ–‡çš„å„ä¸ªå­—æ®µä»¥åŠå«ä¹‰">

<p>å¸§ç±»å‹ï¼šARPï¼š0x0806 ï¼ˆ2ï¼‰ </p>
<p>ARP é¦–éƒ¨ï¼š</p>
<p>ç¡¬ä»¶ç±»å‹ï¼šç¡¬ä»¶åœ°å€çš„ç±»å‹ï¼Œ1 è¡¨ç¤ºä»¥å¤ªç½‘åœ°å€ã€‚ï¼ˆ2ï¼‰ </p>
<p>åè®®ç±»å‹ï¼šåè®®åœ°å€çš„ç±»å‹ï¼Œ0x0800 è¡¨ç¤º IP åœ°å€ã€‚(2) </p>
<p>ç¡¬ä»¶åœ°å€é•¿åº¦ï¼šå­—èŠ‚ä¸ºå•ä½ 6  ï¼ˆ1ï¼‰</p>
<p>åè®®åœ°å€é•¿åº¦ï¼šå­—èŠ‚ä¸ºå•ä½ 4  (1)</p>
<p>æ“ä½œç±»å‹ï¼š2 ä¸ªå­—èŠ‚ã€‚ ARP è¯·æ±‚ 1ï¼ŒARP å›å¤ 2ï¼ŒRARP è¯·æ±‚ 3ï¼ŒRARP åº”ç­” 4ã€‚ï¼ˆ2ï¼‰ </p>
<p>å‘é€è€…ç¡¬ä»¶åœ°å€ï¼š6 ä¸ªå­—èŠ‚ï¼ˆ6ï¼‰</p>
<p>å‘é€è€… IP åœ°å€ï¼š4 ä¸ªå­—èŠ‚ï¼ˆ4ï¼‰ </p>
<p>ç›®æ ‡ç¡¬ä»¶åœ°å€ï¼š6 ä¸ªå­—èŠ‚ï¼ˆ6ï¼‰ </p>
<p>ç›®æ ‡ IP åœ°å€ï¼š4 ä¸ªå­—èŠ‚ï¼ˆ4ï¼‰ </p>
<p>CRC æ ¡éªŒï¼š4 ä¸ªå­—èŠ‚ ï¼ˆ4ï¼‰</p>
<p>æ€»ç»“ï¼š</p>
<p>arp æ€»å…± 28 ä¸ªå­—èŠ‚ã€‚</p>
<p>è®°å¿†æ–¹æ³•ï¼š ä»¥å¤ªç½‘å…ˆç›®åœ°åæºï¼ŒARP å…ˆå‘é€ç«¯åç›®åœ°ç«¯ã€‚å…ˆç¡¬ä»¶ååè®®ã€‚</p>
<h3 id="é—®é¢˜-5ï¼šARP-åè®®æœ‰ä»€ä¹ˆå¼±ç‚¹ï¼Ÿ"><a href="#é—®é¢˜-5ï¼šARP-åè®®æœ‰ä»€ä¹ˆå¼±ç‚¹ï¼Ÿ" class="headerlink" title="é—®é¢˜ 5ï¼šARP åè®®æœ‰ä»€ä¹ˆå¼±ç‚¹ï¼Ÿ"></a>é—®é¢˜ 5ï¼šARP åè®®æœ‰ä»€ä¹ˆå¼±ç‚¹ï¼Ÿ</h3><p>1ï¼‰ ç¼“å­˜ï¼šä¸»æœºçš„åœ°å€æ˜ å°„æ˜¯åŸºäºé«˜é€Ÿç¼“å­˜çš„ï¼ŒåŠ¨æ€æ›´æ–°çš„ã€‚åœ°å€åˆ·æ–°æ˜¯æœ‰æ—¶é—´é™åˆ¶çš„ã€‚ å¯ä»¥é€šè¿‡ä¸‹æ¬¡æ›´æ–°ä¹‹å‰ä¿®æ”¹è®¡ç®—æœºä¸Šçš„åœ°å€ç¼“å­˜ï¼Œé€ æˆæ‹’ç»æœåŠ¡æ”»å‡»æˆ–è€… ARP æ¬ºéª—ã€‚</p>
<p>2ï¼‰ å¹¿æ’­: æ”»å‡»è€…å¯ä»¥ä¼ªè£… ARP åº”ç­”ã€‚</p>
<p>3ï¼‰ ARP åº”ç­”æ²¡æœ‰è®¤è¯ï¼Œéƒ½æ˜¯åˆæ³•çš„ã€‚å¯ä»¥åœ¨ä¸æ¥å—åˆ°è¯·æ±‚çš„æ—¶å€™å°±å‘å‡ºåº”ç­”åŒ…ã€‚</p>
<h3 id="é—®é¢˜-6ï¼šARP-ä»£ç†çš„æ¦‚å¿µå’Œåº”ç”¨åœºæ™¯"><a href="#é—®é¢˜-6ï¼šARP-ä»£ç†çš„æ¦‚å¿µå’Œåº”ç”¨åœºæ™¯" class="headerlink" title="é—®é¢˜ 6ï¼šARP ä»£ç†çš„æ¦‚å¿µå’Œåº”ç”¨åœºæ™¯"></a>é—®é¢˜ 6ï¼šARP ä»£ç†çš„æ¦‚å¿µå’Œåº”ç”¨åœºæ™¯</h3><p>è‹¥ ARP è¯·æ±‚æ˜¯ä»ä¸€ä¸ªç½‘ç»œçš„ä¸»æœºå‘é€ç»™å¦ä¸€ä¸ªç½‘ç»œä¸Šçš„ä¸»æœºï¼Œé‚£ä¹ˆè¿æ¥è¿™ä¸¤ä¸ªç½‘ç»œçš„è·¯ç”±å™¨å°±å¯ä»¥å›ç­”è¯¥è¯·æ±‚ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åš ARP ä»£ç†ã€‚ARP ä»£ç†è·¯ç”±å™¨å“åº” ARP è¯·æ±‚çš„ MAC åœ°å€ä¸ºè·¯ç”±å™¨çš„ MAC åœ°å€è€Œé ARP è¯·æ±‚çš„ä¸»æœºçš„ MAC åœ°å€ã€‚</p>
<p>ARP ä»£ç†çš„åº”ç”¨ç¯å¢ƒï¼š</p>
<p>ä¸¤ä¸ªç‰©ç†ç½‘ç»œä¹‹é—´çš„è·¯ç”±æ˜¯ä½¿ç”¨ç›¸åŒçš„ç½‘ç»œå·ï¼Œä¸¤ä¸ªè·¯ç”±å™¨è®¾ç½®æˆ ARP ä»£ç†ï¼Œå®ç°ç›¸äº’éšç’ç‰©ç†ç½‘ç»œ</p>
<h3 id="é—®é¢˜-7ï¼šå…è´¹-ARP"><a href="#é—®é¢˜-7ï¼šå…è´¹-ARP" class="headerlink" title="é—®é¢˜ 7ï¼šå…è´¹ ARP"></a>é—®é¢˜ 7ï¼šå…è´¹ ARP</h3><p>æŒ‡ä¸»æœºå‘é€ ARP æŸ¥æ‰¾è‡ªå·±çš„ IP åœ°å€ï¼Œå³æ•°æ®é“¾è·¯å±‚ SIP=DIPä½œç”¨æœ‰ä¸¤ä¸ªï¼š</p>
<p>1ï¼‰ ä¸€ä¸ªä¸»æœºä½¿ç”¨å…è´¹ ARP ç¡®å®šæ˜¯æœ‰å­˜åœ¨æœ‰å…¶ä»–ä¸»æœºè®¾ç½®äº†ç›¸åŒçš„IP åœ°å€</p>
<p>2ï¼‰ å¦‚æœå‘é€å…è´¹ ARP çš„ä¸»æœºæ”¹å˜äº† MAC åœ°å€ï¼Œå¯ä»¥é€šè¿‡å‘é€å…è´¹ ARP çš„æ–¹å¼å‘ŠçŸ¥å…¶ä»–ä¸»æœºç«¯æ›´æ–° ARP è¡¨</p>
<h3 id="é—®é¢˜-8ï¼šæ•°æ®é“¾è·¯å±‚-MTU-çš„æœ€å¤§å€¼å’Œæœ€å°å€¼æ˜¯å¤šå°‘ï¼Ÿ"><a href="#é—®é¢˜-8ï¼šæ•°æ®é“¾è·¯å±‚-MTU-çš„æœ€å¤§å€¼å’Œæœ€å°å€¼æ˜¯å¤šå°‘ï¼Ÿ" class="headerlink" title="é—®é¢˜ 8ï¼šæ•°æ®é“¾è·¯å±‚ MTU çš„æœ€å¤§å€¼å’Œæœ€å°å€¼æ˜¯å¤šå°‘ï¼Ÿ"></a>é—®é¢˜ 8ï¼šæ•°æ®é“¾è·¯å±‚ MTU çš„æœ€å¤§å€¼å’Œæœ€å°å€¼æ˜¯å¤šå°‘ï¼Ÿ</h3><p>1) æ•°æ®é“¾è·¯å±‚çš„<strong>æœ€å°MTU ä¸º64å­—èŠ‚</strong>ã€‚å¯¹äºIEEE802.3ï¼Œä¸¤ä¸ªç«™ç‚¹çš„æœ€è¿œè·ç¦»ä¸è¶…è¿‡2500m,ç”± 4 ä¸ªä¸­ç»§å™¨è¿æ¥è€Œæˆï¼Œå…¶å†²çªçª—å£ä¸º 51.2us(2 å€ç”µç¼†ä¼ æ’­å»¶è¿ŸåŠ ä¸Š 4 ä¸ªä¸­ç»§å™¨çš„åŒå‘å»¶è¿Ÿ).å¯¹äº 10Mbps çš„ IEEE802.3 æ¥è¯´ï¼Œè¿™ä¸ªæ—¶é—´ç­‰äºå‘é€ 64 å­—èŠ‚ï¼Œå³ 512 ä½çš„æ—¶é—´ï¼Œ64 å­—èŠ‚å°±æ˜¯ç”±æ­¤è€Œæ¥çš„ã€‚å¦‚æœä¸€ä¸ªç«™ç‚¹å·²ç»ä¼ è¾“äº† 512bitï¼Œå°±è®¤ä¸ºå®ƒå·²ç»å ç”¨äº†è¿™ä¸ªä¿¡é“ã€‚</p>
<p>2) æ•°æ®é“¾è·¯å±‚çš„<strong>æœ€å¤§</strong> <strong>MTU ä¸º 1500 å­—èŠ‚</strong>ï¼Œå³æ•°æ®å­—æ®µçš„æœ€å¤§é•¿åº¦</p>
<h1 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a><center>ç½‘ç»œå±‚</center></h1><h2 id="IP-åè®®"><a href="#IP-åè®®" class="headerlink" title="IP åè®®"></a>IP åè®®</h2><h3 id="é—®é¢˜-1ï¼šå¦‚ä½•ç†è§£IP-çš„ä¸å¯é å’Œæ— è¿æ¥ã€‚"><a href="#é—®é¢˜-1ï¼šå¦‚ä½•ç†è§£IP-çš„ä¸å¯é å’Œæ— è¿æ¥ã€‚" class="headerlink" title="é—®é¢˜ 1ï¼šå¦‚ä½•ç†è§£IP çš„ä¸å¯é å’Œæ— è¿æ¥ã€‚"></a>é—®é¢˜ 1ï¼šå¦‚ä½•ç†è§£IP çš„ä¸å¯é å’Œæ— è¿æ¥ã€‚</h3><p><strong>ä¸å¯é </strong>ï¼šæŒ‡çš„æ˜¯ä¸èƒ½ä¿è¯æ•°æ®æŠ¥èƒ½æˆåŠŸåœ°åˆ°è¾¾ç›®çš„åœ°ã€‚</p>
<p>å‘ç”Ÿé”™è¯¯æ—¶å€™ï¼Œä¸¢å¼ƒè¯¥æ•°æ®åŒ…ï¼Œå‘é€ ICMP æ¶ˆæ¯ç»™ä¿¡æºç«¯ã€‚ å¯é æ€§ç”±ä¸Šå±‚æä¾›ã€‚</p>
<p><strong>æ— è¿æ¥</strong>ï¼šIP ä¸ç»´æŠ¤å…³äºåç»­æ•°æ®æŠ¥çš„çŠ¶æ€ä¿¡æ¯ã€‚</p>
<p>ä½“ç°åœ¨ï¼ŒIP æ•°æ®å¯ä»¥ä¸æŒ‰é¡ºåºå‘é€å’Œæ¥æ”¶ã€‚A å‘é€è¿ç»­çš„æ•°æ®æŠ¥ï¼Œåˆ°è¾¾B ä¸ä¸€å®šæ˜¯è¿ç»­çš„ï¼Œ æ¥å›è·¯ç”±é€‰æ‹©å¯èƒ½ä¸ä¸€æ ·ï¼Œè·¯çº¿ä¹Ÿä¸ä¸€æ ·ï¼Œåˆ°è¾¾å…ˆåé¡ºåºä¹Ÿä¸ä¸€æ ·ã€‚</p>
<h3 id="é—®é¢˜-2ï¼šIP-æŠ¥æ–‡çš„æ ¼å¼å’Œå„ä¸ªå­—æ®µçš„å«ä¹‰ã€‚"><a href="#é—®é¢˜-2ï¼šIP-æŠ¥æ–‡çš„æ ¼å¼å’Œå„ä¸ªå­—æ®µçš„å«ä¹‰ã€‚" class="headerlink" title="é—®é¢˜ 2ï¼šIP æŠ¥æ–‡çš„æ ¼å¼å’Œå„ä¸ªå­—æ®µçš„å«ä¹‰ã€‚"></a>é—®é¢˜ 2ï¼šIP æŠ¥æ–‡çš„æ ¼å¼å’Œå„ä¸ªå­—æ®µçš„å«ä¹‰ã€‚</h3> <img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/ip.png" class title="IP æŠ¥æ–‡çš„æ ¼å¼å’Œå„ä¸ªå­—æ®µçš„å«ä¹‰"> 

<p><strong>ç‰ˆæœ¬å·</strong>ï¼š IPV4 å°±æ˜¯ 4ï¼ŒIPV6 å°±æ˜¯ 6 ï¼ˆ4ï¼‰</p>
<p><strong>é¦–éƒ¨é•¿åº¦</strong>ï¼š4 ä¸ªå­—èŠ‚ä¸ºå•ä½ã€‚æœ€å°ä¸º 5ï¼Œæœ€å¤§ä¸º 15ã€‚æ‰€ä»¥æœ€å°é•¿åº¦ 20 ä¸ªå­—èŠ‚ï¼Œæœ€å¤§ä¸º 60ä¸ªå­—èŠ‚ã€‚ï¼ˆ4ï¼‰</p>
<p><strong>æœåŠ¡ç±»å‹</strong>ï¼š Qos ç”¨ï¼Œç›®å‰ä¸æ€ä¹ˆä½¿ç”¨ã€‚ï¼ˆ8ï¼‰</p>
<p><strong>æ€»é•¿åº¦</strong>ï¼šå­—èŠ‚ä¸ºå•ä½ã€‚ æœ€å¤šå¯ä»¥ä¼ é€ 65535 å­—èŠ‚çš„IP æ•°æ®åŒ…ã€‚ï¼ˆ16ï¼‰ <strong>æ ‡è¯†å­—æ®µ</strong>ï¼ˆ8ï¼‰</p>
<p><strong>æ ‡ å¿—</strong> ï¼ˆ3ï¼‰</p>
<p><strong>æ®µåç§»</strong>ï¼ˆ5ï¼‰ä¸åˆ†ç‰‡æœ‰å…³ã€‚</p>
<p><strong>ç”Ÿå­˜æ—¶é—´ TTL</strong>ï¼šç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨å‡ä¸€ã€‚ å­—æ®µä¸º 0 æ—¶ï¼Œæ•°æ®æŠ¥è¢«ä¸¢å¼ƒï¼Œå¹¶ä¸”å‘é€ ICMP æŠ¥æ–‡é€šçŸ¥æºä¸»æœºã€‚ç›®çš„æ˜¯é˜²æ­¢æ•°æ®æŠ¥åœ¨é€‰è·¯æ—¶æ— ä¼‘æ­¢åœ°åœ¨ç½‘ç»œä¸­æµåŠ¨ã€‚ï¼ˆ8ï¼‰ </p>
<p><strong>åè®®</strong>ï¼šåŒºåˆ†ä¸Šå±‚åè®® ï¼ˆ8ï¼‰</p>
<p><strong>é¦–éƒ¨æ ¡éªŒå’Œ</strong>ï¼šä»…å¯¹é¦–éƒ¨è¿›è¡Œæ ¡éªŒã€‚ï¼ˆ16ï¼‰ã€å¯¹æ¯”ï¼š ICMPï¼ŒIGMPï¼ŒTCPï¼ŒUDPï¼šå¯¹é¦–éƒ¨å’Œæ•°æ®è¿›è¡Œæ ¡éªŒã€‘</p>
<p><strong>æºåœ°å€</strong>ï¼šï¼ˆ32ï¼‰</p>
<p><strong>ç›®çš„åœ°å€</strong>ï¼š(32)</p>
<h3 id="é—®é¢˜-3ï¼šä¸ºä»€ä¹ˆ-IP-é¦–éƒ¨ä¸­è¦æœ‰æ€»é•¿åº¦å­—æ®µï¼Ÿ"><a href="#é—®é¢˜-3ï¼šä¸ºä»€ä¹ˆ-IP-é¦–éƒ¨ä¸­è¦æœ‰æ€»é•¿åº¦å­—æ®µï¼Ÿ" class="headerlink" title="é—®é¢˜ 3ï¼šä¸ºä»€ä¹ˆ IP é¦–éƒ¨ä¸­è¦æœ‰æ€»é•¿åº¦å­—æ®µï¼Ÿ"></a>é—®é¢˜ 3ï¼šä¸ºä»€ä¹ˆ IP é¦–éƒ¨ä¸­è¦æœ‰æ€»é•¿åº¦å­—æ®µï¼Ÿ</h3><p>å› ä¸ºä¸€äº›æ•°æ®é“¾è·¯ï¼ˆä»¥å¤ªç½‘ï¼‰éœ€è¦å¡«å……ä¸€äº›æ•°æ®ä»¥è¾¾åˆ°æœ€å°é•¿åº¦ã€‚å› ä¸ºä»¥å¤ªç½‘å¸§çš„æœ€å°é•¿åº¦æ˜¯ 46 ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯IP é•¿åº¦å¯èƒ½æ›´çŸ­ï¼Œæ‰€ä»¥éœ€è¦æ€»é•¿åº¦æ¥ç¡®å®šIP æ•°æ®éƒ¨åˆ†çš„å†…å®¹ã€‚</p>
<h3 id="é—®é¢˜-4ï¼šIP-é¦–éƒ¨æ ¡éªŒå’Œæ€ä¹ˆè®¡ç®—çš„ï¼Œä¸-ICMPï¼ŒIGMPï¼ŒTCPï¼ŒUDP-çš„é¦–éƒ¨æ ¡éªŒå’Œæœ‰ä»€ä¹ˆåŒºåˆ«ä¸å…±åŒç‚¹ï¼Ÿ"><a href="#é—®é¢˜-4ï¼šIP-é¦–éƒ¨æ ¡éªŒå’Œæ€ä¹ˆè®¡ç®—çš„ï¼Œä¸-ICMPï¼ŒIGMPï¼ŒTCPï¼ŒUDP-çš„é¦–éƒ¨æ ¡éªŒå’Œæœ‰ä»€ä¹ˆåŒºåˆ«ä¸å…±åŒç‚¹ï¼Ÿ" class="headerlink" title="é—®é¢˜ 4ï¼šIP é¦–éƒ¨æ ¡éªŒå’Œæ€ä¹ˆè®¡ç®—çš„ï¼Œä¸ ICMPï¼ŒIGMPï¼ŒTCPï¼ŒUDP çš„é¦–éƒ¨æ ¡éªŒå’Œæœ‰ä»€ä¹ˆåŒºåˆ«ä¸å…±åŒç‚¹ï¼Ÿ"></a>é—®é¢˜ 4ï¼šIP é¦–éƒ¨æ ¡éªŒå’Œæ€ä¹ˆè®¡ç®—çš„ï¼Œä¸ ICMPï¼ŒIGMPï¼ŒTCPï¼ŒUDP çš„é¦–éƒ¨æ ¡éªŒå’Œæœ‰ä»€ä¹ˆåŒºåˆ«ä¸å…±åŒç‚¹ï¼Ÿ</h3><p>ï¼ˆ1ï¼‰ å…ˆæŠŠæ ¡éªŒå’Œå­—æ®µç½® 0ã€‚</p>
<p>ï¼ˆ2ï¼‰ å¯¹é¦–éƒ¨ä¸­æ¯ä¸ª 16 ä½æ¯”ç‰¹è¿›è¡ŒäºŒè¿›åˆ¶åç æ±‚å’Œã€‚</p>
<p>ï¼ˆ3ï¼‰ ç»“æœå­˜åœ¨æ£€éªŒå’Œå­—æ®µä¸­ã€‚</p>
<p>ï¼ˆ4ï¼‰ æ”¶åˆ°ä¸€ä»½ IP æ•°æ®åŒ…åï¼ŒåŒæ ·å¯¹é¦–éƒ¨ä¸­æ¯ä¸ª 16bit äºŒè¿›åˆ¶åç æ±‚å’Œã€‚</p>
<p>ï¼ˆ5ï¼‰ æœ€åç»“æœå…¨ä¸º 1ï¼Œè¡¨ç¤ºæ­£ç¡®ï¼Œå¦åˆ™è¡¨ç¤ºé”™è¯¯ã€‚</p>
<p>ï¼ˆ6ï¼‰ å¦‚æœæ˜¯é”™è¯¯çš„ï¼ŒIP å°±ä¸¢å¼ƒè¯¥æ•°æ®æŠ¥ï¼Œä½†æ˜¯ä¸ç”Ÿæˆå·®é”™æŠ¥æ–‡ï¼Œç”±ä¸Šå±‚å»å¤„ç†ã€‚</p>
<p>å…±åŒç‚¹ï¼šç”¨åˆ°çš„ç®—æ³•éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>åŒºåˆ«ï¼šIP è®¡ç®—çš„æ—¶å€™æ²¡æœ‰å°†æ•°æ®åŒ…æ‹¬åœ¨å†…ã€‚ICMPï¼ŒIGMPï¼ŒTCPï¼ŒUDP åŒæ—¶è¦†ç›–é¦–éƒ¨å’Œæ•°æ®æ£€éªŒç ã€‚</p>
<h3 id="é—®é¢˜-5ï¼šä¸»æœºå’Œè·¯ç”±å™¨æœ¬è´¨åŒºåˆ«æ˜¯ï¼Ÿ"><a href="#é—®é¢˜-5ï¼šä¸»æœºå’Œè·¯ç”±å™¨æœ¬è´¨åŒºåˆ«æ˜¯ï¼Ÿ" class="headerlink" title="é—®é¢˜ 5ï¼šä¸»æœºå’Œè·¯ç”±å™¨æœ¬è´¨åŒºåˆ«æ˜¯ï¼Ÿ"></a>é—®é¢˜ 5ï¼šä¸»æœºå’Œè·¯ç”±å™¨æœ¬è´¨åŒºåˆ«æ˜¯ï¼Ÿ</h3><p>ä¸»æœºä»ä¸æŠŠæ•°æ®æŠ¥ä»ä¸€ä¸ªæ¥å£è½¬å‘åˆ°å¦ä¸€ä¸ªæ¥å£ï¼Œè€Œè·¯ç”±å™¨åˆ™è¦è½¬å‘æ•°æ®æŠ¥ã€‚</p>
<h3 id="é—®é¢˜-6ï¼šIP-è·¯ç”±é€‰æ‹©çš„è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#é—®é¢˜-6ï¼šIP-è·¯ç”±é€‰æ‹©çš„è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="é—®é¢˜ 6ï¼šIP è·¯ç”±é€‰æ‹©çš„è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ"></a>é—®é¢˜ 6ï¼šIP è·¯ç”±é€‰æ‹©çš„è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</h3><p>æ ¹æ®æœ€é•¿åŒ¹é…åŸåˆ™ï¼Œæ‰¾åˆ°æ¡ç›®ï¼Œå‘é€åˆ°æŒ‡å®šçš„è·¯ç”±å™¨ã€‚å¦‚æœä¸èƒ½æ‰¾åˆ°ï¼Œè¿”å›ä¸€ä¸ªâ€œä¸»æœºä¸å¯è¾¾â€æˆ–â€œç½‘ç»œä¸å¯è¾¾â€çš„é”™è¯¯ã€‚</p>
<h3 id="é—®é¢˜-7ï¼šIP-è·¯ç”±é€‰æ‹©çš„ç‰¹æ€§æœ‰ä»€ä¹ˆï¼Ÿ"><a href="#é—®é¢˜-7ï¼šIP-è·¯ç”±é€‰æ‹©çš„ç‰¹æ€§æœ‰ä»€ä¹ˆï¼Ÿ" class="headerlink" title="é—®é¢˜ 7ï¼šIP è·¯ç”±é€‰æ‹©çš„ç‰¹æ€§æœ‰ä»€ä¹ˆï¼Ÿ"></a>é—®é¢˜ 7ï¼šIP è·¯ç”±é€‰æ‹©çš„ç‰¹æ€§æœ‰ä»€ä¹ˆï¼Ÿ</h3><p>ï¼ˆï¼‘ï¼‰ IP è·¯ç”±é€‰æ‹©æ˜¯é€è·³è¿›è¡Œçš„ã€‚</p>
<p>IP å¹¶ä¸çŸ¥é“åˆ°è¾¾ä»»ä½•ç›®çš„çš„å®Œæ•´è·¯å¾„ï¼Œåªæä¾›ä¸‹ä¸€è·³åœ°å€ã€‚</p>
<p>ï¼ˆï¼’ï¼‰ ä¸ºä¸€ä¸ªç½‘ç»œæŒ‡å®šä¸€ä¸ªè·¯ç”±å™¨ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªä¸»æœºæŒ‡å®šä¸€ä¸ªè·¯ç”±å™¨ã€‚è¿™æ ·å¯ä»¥ç¼©å°è·¯ç”±è¡¨è§„æ¨¡ã€‚</p>
<h3 id="é—®é¢˜-8ï¼šIP-æœç´¢è·¯ç”±è¡¨çš„æ­¥éª¤"><a href="#é—®é¢˜-8ï¼šIP-æœç´¢è·¯ç”±è¡¨çš„æ­¥éª¤" class="headerlink" title="é—®é¢˜ 8ï¼šIP æœç´¢è·¯ç”±è¡¨çš„æ­¥éª¤"></a>é—®é¢˜ 8ï¼šIP æœç´¢è·¯ç”±è¡¨çš„æ­¥éª¤</h3><p>æœç´¢åŒ¹é…çš„ä¸»æœºåœ°å€ â€”-ã€‹æœç´¢åŒ¹é…çš„ç½‘ç»œåœ°å€â€“ ã€‹æœç´¢é»˜è®¤é€‰é¡¹</p>
<p>IP å±‚è¿›è¡Œçš„é€‰è·¯å®é™…ä¸Šæ˜¯ä¸€ç§é€‰è·¯æœºåˆ¶ï¼Œå®ƒæœç´¢è·¯ç”±è¡¨å¹¶å†³å®šå‘å“ªä¸ªç½‘ç»œæ¥å£å‘é€åˆ†ç»„ã€‚</p>
<h3 id="é—®é¢˜-9ï¼šå¦‚æœè·¯ç”±è¡¨ä¸­æ²¡æœ‰é»˜è®¤é¡¹ï¼Œè€Œåˆæ²¡æœ‰æ‰¾åˆ°åŒ¹é…é¡¹ï¼Œè¿™æ—¶å¦‚ä½•å¤„ç†ï¼Ÿ"><a href="#é—®é¢˜-9ï¼šå¦‚æœè·¯ç”±è¡¨ä¸­æ²¡æœ‰é»˜è®¤é¡¹ï¼Œè€Œåˆæ²¡æœ‰æ‰¾åˆ°åŒ¹é…é¡¹ï¼Œè¿™æ—¶å¦‚ä½•å¤„ç†ï¼Ÿ" class="headerlink" title="é—®é¢˜ 9ï¼šå¦‚æœè·¯ç”±è¡¨ä¸­æ²¡æœ‰é»˜è®¤é¡¹ï¼Œè€Œåˆæ²¡æœ‰æ‰¾åˆ°åŒ¹é…é¡¹ï¼Œè¿™æ—¶å¦‚ä½•å¤„ç†ï¼Ÿ"></a>é—®é¢˜ 9ï¼šå¦‚æœè·¯ç”±è¡¨ä¸­æ²¡æœ‰é»˜è®¤é¡¹ï¼Œè€Œåˆæ²¡æœ‰æ‰¾åˆ°åŒ¹é…é¡¹ï¼Œè¿™æ—¶å¦‚ä½•å¤„ç†ï¼Ÿ</h3><p>ç»“æœå–å†³äºè¯¥ IP æ•°æ®æŠ¥æ˜¯ç”±ä¸»æœºäº§ç”Ÿçš„è¿˜æ˜¯è¢«è½¬å‘çš„ã€‚</p>
<p>å¦‚æœæ•°æ®æŠ¥æ˜¯ç”±æœ¬æœºäº§ç”Ÿçš„ï¼Œé‚£ä¹ˆå°±ç»™å‘é€è¯¥æ•°æ®æŠ¥çš„åº”ç”¨ç¨‹åºè¿”å›ä¸€ä¸ªå·®é”™ï¼Œæˆ–è€…æ˜¯â€œä¸»æœºä¸å¯è¾¾å·®é”™â€æˆ–è€…æ˜¯â€œç½‘ç»œä¸å¯è¾¾å·®é”™â€ã€‚</p>
<p>å¦‚æœæ˜¯è¢«è½¬å‘çš„æ•°æ®æŠ¥ï¼Œå°±ç»™åŸå§‹å‘é€ä¸€ä»½ ICMP ä¸»æœºä¸å¯è¾¾çš„å·®é”™æŠ¥æ–‡ã€‚</p>
<h3 id="é—®é¢˜-10ï¼šIP-åœ°å€çš„åˆ†ç±»ï¼Œå¦‚ä½•åˆ’åˆ†çš„ï¼ŒåŠä¼šè®¡ç®—å„ç±»åœ°å€æ”¯æŒçš„ä¸»æœºæ•°"><a href="#é—®é¢˜-10ï¼šIP-åœ°å€çš„åˆ†ç±»ï¼Œå¦‚ä½•åˆ’åˆ†çš„ï¼ŒåŠä¼šè®¡ç®—å„ç±»åœ°å€æ”¯æŒçš„ä¸»æœºæ•°" class="headerlink" title="é—®é¢˜ 10ï¼šIP åœ°å€çš„åˆ†ç±»ï¼Œå¦‚ä½•åˆ’åˆ†çš„ï¼ŒåŠä¼šè®¡ç®—å„ç±»åœ°å€æ”¯æŒçš„ä¸»æœºæ•°"></a>é—®é¢˜ 10ï¼šIP åœ°å€çš„åˆ†ç±»ï¼Œå¦‚ä½•åˆ’åˆ†çš„ï¼ŒåŠä¼šè®¡ç®—å„ç±»åœ°å€æ”¯æŒçš„ä¸»æœºæ•°</h3><ol>
<li><p>A ç±»åœ°å€ï¼šé¦–ä½ä¸º 0ï¼Œ1.0.0.1~~126.255.255.254ï¼›ä¸»æœºå· 24 ä½</p>
</li>
<li><p>B ç±»åœ°å€ï¼šé¦–ä½ä¸º 10ï¼Œ128.0.0.1~~191.255.255.254ï¼›ä¸»æœºå· 16 ä½</p>
</li>
<li><p>C ç±»åœ°å€ï¼šé¦–ä½ä¸º 110ï¼Œ192.0.0.1~~223.255.255.254ï¼›ä¸»æœºå· 8 ä½</p>
</li>
<li><p>D ç±»åœ°å€ï¼ˆå¤šæ’­åœ°å€ï¼Œä¹Ÿå«åšç»„æ’­åœ°å€ï¼‰ï¼šé¦–ä½ä¸º 1110ï¼Œ224.0.0.1~~239.255.255.254</p>
</li>
<li><p>E ç±»åœ°å€ï¼šæ­¤ç±»åœ°å€æ˜¯ä¿ç•™åœ°å€ï¼Œé¦–ä½ä¸º 11110ï¼Œ240.0.0.1~~254.255.255.254 </p>
</li>
</ol>
<h2 id="ICMP-åè®®"><a href="#ICMP-åè®®" class="headerlink" title="ICMP åè®®"></a>ICMP åè®®</h2><h3 id="é—®é¢˜-1ï¼šICMP-çš„å±‚æ¬¡å’Œä½œç”¨ã€‚"><a href="#é—®é¢˜-1ï¼šICMP-çš„å±‚æ¬¡å’Œä½œç”¨ã€‚" class="headerlink" title="é—®é¢˜ 1ï¼šICMP çš„å±‚æ¬¡å’Œä½œç”¨ã€‚"></a>é—®é¢˜ 1ï¼šICMP çš„å±‚æ¬¡å’Œä½œç”¨ã€‚</h3><img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/icmpd.png" class title="ICMPçš„å±‚æ¬¡å’Œä½œç”¨"> 

<p>ICMP ä¸€èˆ¬è®¤ä¸ºæ˜¯åœ¨ä¸‰å±‚çš„ã€‚ä¸»è¦ä¼ é€’ä¸€äº›å·®é”™æŠ¥æ–‡å’Œå…¶ä»–éœ€è¦æ³¨æ„çš„ä¿¡æ¯ã€‚</p>
<h3 id="é—®é¢˜-2ï¼šICMP-æŠ¥æ–‡çš„åˆ†ç±»ï¼Ÿ"><a href="#é—®é¢˜-2ï¼šICMP-æŠ¥æ–‡çš„åˆ†ç±»ï¼Ÿ" class="headerlink" title="é—®é¢˜ 2ï¼šICMP æŠ¥æ–‡çš„åˆ†ç±»ï¼Ÿ"></a>é—®é¢˜ 2ï¼šICMP æŠ¥æ–‡çš„åˆ†ç±»ï¼Ÿ</h3><p>ICMP åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ ICMP æŸ¥è¯¢æŠ¥æ–‡ï¼Œå¦ä¸€ç±»æ˜¯ ICMP å·®é”™æŠ¥æ–‡ã€‚</p>
<img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/icmp.png" class title="ICMP æŠ¥æ–‡çš„åˆ†ç±»">

<h3 id="é—®é¢˜-3ï¼šICMP-çš„ä¸»æœºä¸å¯è¾¾æŠ¥æ–‡æ˜¯åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å‘å‡ºçš„ï¼Ÿ"><a href="#é—®é¢˜-3ï¼šICMP-çš„ä¸»æœºä¸å¯è¾¾æŠ¥æ–‡æ˜¯åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å‘å‡ºçš„ï¼Ÿ" class="headerlink" title="é—®é¢˜ 3ï¼šICMP çš„ä¸»æœºä¸å¯è¾¾æŠ¥æ–‡æ˜¯åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å‘å‡ºçš„ï¼Ÿ"></a>é—®é¢˜ 3ï¼šICMP çš„ä¸»æœºä¸å¯è¾¾æŠ¥æ–‡æ˜¯åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å‘å‡ºçš„ï¼Ÿ</h3><p>ä¸‰å±‚è®¾å¤‡ï¼ˆè·¯ç”±å™¨ï¼‰ç»™è¯¥ä¸»æœºå¯»è·¯æ—¶ï¼Œæ²¡æœ‰æ‰¾åˆ°ç›¸åº”è·¯å¾„ï¼Œå‘æº IP å‘å› ICMP ä¸»æœºä¸å¯è¾¾</p>
<h3 id="é—®é¢˜-4ï¼šä»€ä¹ˆæƒ…å†µä¸ä¼šå¯¼è‡´äº§ç”Ÿ-ICMP-å·®é”™æŠ¥æ–‡ï¼Ÿ-1ï¼‰-ICMP-å·®é”™æŠ¥æ–‡ã€‚"><a href="#é—®é¢˜-4ï¼šä»€ä¹ˆæƒ…å†µä¸ä¼šå¯¼è‡´äº§ç”Ÿ-ICMP-å·®é”™æŠ¥æ–‡ï¼Ÿ-1ï¼‰-ICMP-å·®é”™æŠ¥æ–‡ã€‚" class="headerlink" title="é—®é¢˜ 4ï¼šä»€ä¹ˆæƒ…å†µä¸ä¼šå¯¼è‡´äº§ç”Ÿ ICMP å·®é”™æŠ¥æ–‡ï¼Ÿ 1ï¼‰ ICMP å·®é”™æŠ¥æ–‡ã€‚"></a>é—®é¢˜ 4ï¼šä»€ä¹ˆæƒ…å†µä¸ä¼šå¯¼è‡´äº§ç”Ÿ ICMP å·®é”™æŠ¥æ–‡ï¼Ÿ 1ï¼‰ ICMP å·®é”™æŠ¥æ–‡ã€‚</h3><p>2ï¼‰   ç›®çš„åœ°å€æ˜¯å¹¿æ’­åœ°å€æˆ–è€…å¤šæ’­åœ°å€çš„ IP æ•°æ®æŠ¥ã€‚</p>
<p>3ï¼‰   é“¾è·¯å±‚å¹¿æ’­çš„æ•°æ®æŠ¥</p>
<p>4ï¼‰   ä¸æ˜¯ IP åˆ†ç‰‡çš„ç¬¬ä¸€ç‰‡</p>
<p>5ï¼‰   æºåœ°å€ä¸æ˜¯å•ä¸ªä¸»æœºçš„æ•°æ®åŒ…ã€‚</p>
<h3 id="é—®é¢˜-5ï¼šICMP-é‡å®šå‘å·®é”™æŠ¥æ–‡æ˜¯æ€ä¹ˆæ¥çš„ï¼Œåœ¨ä½•ç§åœºåˆå‡ºç°ï¼Ÿ"><a href="#é—®é¢˜-5ï¼šICMP-é‡å®šå‘å·®é”™æŠ¥æ–‡æ˜¯æ€ä¹ˆæ¥çš„ï¼Œåœ¨ä½•ç§åœºåˆå‡ºç°ï¼Ÿ" class="headerlink" title="é—®é¢˜ 5ï¼šICMP é‡å®šå‘å·®é”™æŠ¥æ–‡æ˜¯æ€ä¹ˆæ¥çš„ï¼Œåœ¨ä½•ç§åœºåˆå‡ºç°ï¼Ÿ"></a>é—®é¢˜ 5ï¼šICMP é‡å®šå‘å·®é”™æŠ¥æ–‡æ˜¯æ€ä¹ˆæ¥çš„ï¼Œåœ¨ä½•ç§åœºåˆå‡ºç°ï¼Ÿ</h3> <img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/r1.jpg" class title="ICMP é‡å®šå‘å·®é”™æŠ¥æ–‡">

<p>1ï¼‰   ä¸»æœºå‘é€ IP æ•°æ®æŠ¥ç»™ R1ï¼Œå› ä¸ºä¸»æœºçš„é»˜è®¤è·¯ç”±æŒ‡å‘çš„ä¸‹ä¸€è·³æ˜¯ R1ã€‚</p>
<p>2ï¼‰   R1 æ”¶åˆ°æ•°æ®æŠ¥å¹¶ä¸”æ£€æŸ¥å®ƒçš„è·¯ç”±è¡¨ï¼Œå‘ç° R2 æ˜¯å‘é€è¯¥æ•°æ®æŠ¥çš„ä¸‹ä¸€è·³ã€‚å½“ä»–å°†æ•°æ®æŠ¥å‘é€ç»™ R2 çš„æ—¶å€™ï¼Œå‘ç°å‘é€çš„æ¥å£ä¸æ¥å—çš„ç«¯å£æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤åŒæ—¶å‘é€ä¸€ä¸ª ICMP é‡å®šå‘æŠ¥æ–‡ç»™ä¸»æœºã€‚</p>
<p>3ï¼‰   R1 æ¥å—åˆ° ICMP é‡å®šå‘æŠ¥æ–‡åï¼Œæ¥ä¸‹æ¥çš„æ•°æ®æŠ¥å°±å‘é€ç»™ R2ï¼Œè€Œä¸å†å‘é€ç»™ R1ã€‚</p>
<h3 id="é—®é¢˜-6ï¼šé‡å®šå‘æŠ¥æ–‡æœ‰ä»€ä¹ˆè§„åˆ™ï¼Ÿ"><a href="#é—®é¢˜-6ï¼šé‡å®šå‘æŠ¥æ–‡æœ‰ä»€ä¹ˆè§„åˆ™ï¼Ÿ" class="headerlink" title="é—®é¢˜ 6ï¼šé‡å®šå‘æŠ¥æ–‡æœ‰ä»€ä¹ˆè§„åˆ™ï¼Ÿ"></a>é—®é¢˜ 6ï¼šé‡å®šå‘æŠ¥æ–‡æœ‰ä»€ä¹ˆè§„åˆ™ï¼Ÿ</h3><p>é‡å®šå‘æŠ¥æ–‡åªèƒ½æœ‰è·¯ç”±å™¨ç”Ÿæˆã€‚</p>
<p>é‡å®šå‘æŠ¥æ–‡æ˜¯ä¸ºä¸»æœºè€Œä¸æ˜¯ä¸ºè·¯ç”±å™¨ä½¿ç”¨çš„ã€‚</p>
<h3 id="é—®é¢˜-7ï¼šPing-å‘½ä»¤çš„å…·ä½“è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#é—®é¢˜-7ï¼šPing-å‘½ä»¤çš„å…·ä½“è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="é—®é¢˜ 7ï¼šPing å‘½ä»¤çš„å…·ä½“è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ"></a>é—®é¢˜ 7ï¼šPing å‘½ä»¤çš„å…·ä½“è¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</h3><p>å‚è€ƒæ–‡ç« ï¼šã€Šå¯¹äº Ping çš„è¿‡ç¨‹ï¼Œä½ çœŸçš„äº†è§£å—ï¼Ÿã€‹ <a href="https://mp.weixin.qq.com/s/DfQT3Vw2xaq60YIil-7Yxw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/DfQT3Vw2xaq60YIil-7Yxw</a></p>
<h1 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a><center>ä¼ è¾“å±‚</center></h1><h2 id="UDP-åè®®"><a href="#UDP-åè®®" class="headerlink" title="UDP åè®®"></a>UDP åè®®</h2><h3 id="é—®é¢˜-1ï¼šUDP-å’Œ-TCP-çš„ç®€å•ä»‹ç»ã€‚"><a href="#é—®é¢˜-1ï¼šUDP-å’Œ-TCP-çš„ç®€å•ä»‹ç»ã€‚" class="headerlink" title="é—®é¢˜ 1ï¼šUDP å’Œ TCP çš„ç®€å•ä»‹ç»ã€‚"></a>é—®é¢˜ 1ï¼šUDP å’Œ TCP çš„ç®€å•ä»‹ç»ã€‚</h3><p>UDP æ˜¯ä¸€ä¸ªç®€å•çš„é¢å‘æ•°æ®æŠ¥çš„è¿è¾“å±‚åè®®ï¼šè¿›ç¨‹çš„æ¯ä¸ªè¾“å‡ºæ“ä½œéƒ½æ­£å¥½äº§ç”Ÿä¸€ä¸ª UDP æ•°æ®æŠ¥ï¼Œå¹¶ç»„è£…æˆä¸€ä»½å¾…å‘é€çš„ IP æ•°æ®æŠ¥ã€‚</p>
<p>TCP æ˜¯é¢å‘æµå­—ç¬¦ï¼Œåº”ç”¨ç¨‹åºäº§ç”Ÿçš„å…¨ä½“æ•°æ®ä¸çœŸæ­£å‘é€çš„å•ä¸ª IP æ•°æ®æŠ¥å¯èƒ½æ²¡ä»€ä¹ˆè”ç³»ã€‚</p>
<h3 id="é—®é¢˜-2ï¼šUDP-æŠ¥å¤´å­—æ®µå’Œå«ä¹‰ï¼Ÿ"><a href="#é—®é¢˜-2ï¼šUDP-æŠ¥å¤´å­—æ®µå’Œå«ä¹‰ï¼Ÿ" class="headerlink" title="é—®é¢˜ 2ï¼šUDP æŠ¥å¤´å­—æ®µå’Œå«ä¹‰ï¼Ÿ"></a>é—®é¢˜ 2ï¼šUDP æŠ¥å¤´å­—æ®µå’Œå«ä¹‰ï¼Ÿ</h3> <img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/udpb.png" class title="UDP é¦–éƒ¨">

<p>æºç«¯å£å·ï¼ˆ2ï¼‰ </p>
<p>ç›®åœ°ç«¯å£å·ï¼ˆ2ï¼‰</p>
<p>UDP é•¿åº¦ï¼šæ˜¯UDP çš„æŠ¥æ–‡æ€»é•¿åº¦ï¼Œæ˜¯å¤šäºçš„ã€‚ IP æ€»é•¿åº¦å‡å»é¦–éƒ¨é•¿åº¦å°±æ˜¯æ­¤å€¼ã€‚ï¼ˆ2ï¼‰ </p>
<p>UDP æ ¡éªŒå’Œï¼šæ³¨æ„ç‚¹ï¼šæ ¡éªŒå’Œæ˜¯å¯é€‰çš„ã€‚ ï¼ˆTCP æ˜¯å¿…é€‰çš„ï¼‰æ ¡éªŒå’Œè¦†ç›– UDP é¦–éƒ¨å’Œæ•°æ®</p>
<p>ï¼ˆTCP ä¹Ÿä¸€æ ·è¦†ç›–é¦–éƒ¨å’Œæ•°æ®ï¼Œä½†æ˜¯ IP æŒ‡è¦†ç›–é¦–éƒ¨ï¼‰ï¼ˆ2ï¼‰</p>
<h3 id="é—®é¢˜-3ï¼š-UDP-çš„æ ¡éªŒå’Œæ˜¯æ€ä¹ˆè®¡ç®—çš„ï¼Ÿ"><a href="#é—®é¢˜-3ï¼š-UDP-çš„æ ¡éªŒå’Œæ˜¯æ€ä¹ˆè®¡ç®—çš„ï¼Ÿ" class="headerlink" title="é—®é¢˜ 3ï¼š UDP çš„æ ¡éªŒå’Œæ˜¯æ€ä¹ˆè®¡ç®—çš„ï¼Ÿ"></a>é—®é¢˜ 3ï¼š UDP çš„æ ¡éªŒå’Œæ˜¯æ€ä¹ˆè®¡ç®—çš„ï¼Ÿ</h3><p>UDP çš„æ ¡éªŒå’Œè¦è®¡ç®—é¦–éƒ¨å’Œæ•°æ®éƒ¨åˆ†ã€‚é¦–éƒ¨è¿˜åŒ…æ‹¬ä¼ªé¦–éƒ¨ã€‚</p>
   <img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/udp.png" class title="UDP çš„æ ¡éªŒå’Œè®¡ç®—">

<p>å¤šäº† 12 ä¸ªå­—èŠ‚çš„ä¼ªé¦–éƒ¨ã€‚</p>
<p>æ³¨æ„ç‚¹ï¼šUDP é•¿åº¦è®¡ç®—ä¸¤æ¬¡ã€‚</p>
<p>å¦‚æœæ£€éªŒå’Œæœ‰é”™ï¼Œåˆ™ UDP æ•°æ®æŠ¥è¢«æ‚„æ‚„ä¸¢å¼ƒï¼Œä¸äº§ç”Ÿä»»ä½•å·®é”™æŠ¥æ–‡ã€‚</p>
<h3 id="é—®é¢˜-4ï¼šä¸ºä»€ä¹ˆè¦åŠ æœ‰ä¼ªé¦–éƒ¨ï¼Ÿ"><a href="#é—®é¢˜-4ï¼šä¸ºä»€ä¹ˆè¦åŠ æœ‰ä¼ªé¦–éƒ¨ï¼Ÿ" class="headerlink" title="é—®é¢˜ 4ï¼šä¸ºä»€ä¹ˆè¦åŠ æœ‰ä¼ªé¦–éƒ¨ï¼Ÿ"></a>é—®é¢˜ 4ï¼šä¸ºä»€ä¹ˆè¦åŠ æœ‰ä¼ªé¦–éƒ¨ï¼Ÿ</h3><p>ç›®çš„æ˜¯è®©UDP ä¸¤æ¬¡æ£€æŸ¥æ•°æ®æ˜¯å¦å·²ç»æ­£ç¡®åˆ°è¾¾ç›®çš„åœ°ã€‚IP æ¥å—æ­£ç¡®çš„ç›®çš„åœ°å€ï¼Œä¼ é€åˆ°æ­£ç¡®çš„ä¸Šå±‚ç¨‹åºã€‚</p>
<p>æ‰€æœ‰ä¼ªé¦–éƒ¨åŒ…æ‹¬ï¼šæº IP åœ°å€ï¼Œç›®çš„ IP åœ°å€ï¼Œ0ï¼Œåè®®å·ï¼ŒUDP é•¿åº¦ã€‚</p>
<h2 id="TCP-åè®®"><a href="#TCP-åè®®" class="headerlink" title="TCP åè®®"></a>TCP åè®®</h2><h3 id="é—®é¢˜-1ï¼šTCP-é€šè¿‡å“ªäº›æ–¹å¼æ¥ä¿è¯å¯é æ€§ï¼Ÿ"><a href="#é—®é¢˜-1ï¼šTCP-é€šè¿‡å“ªäº›æ–¹å¼æ¥ä¿è¯å¯é æ€§ï¼Ÿ" class="headerlink" title="é—®é¢˜ 1ï¼šTCP é€šè¿‡å“ªäº›æ–¹å¼æ¥ä¿è¯å¯é æ€§ï¼Ÿ"></a>é—®é¢˜ 1ï¼šTCP é€šè¿‡å“ªäº›æ–¹å¼æ¥ä¿è¯å¯é æ€§ï¼Ÿ</h3><p>1ï¼‰   åº”ç”¨æ•°æ®è¢«åˆ†å‰²æˆ TCP è®¤ä¸ºæœ€é€‚åˆå‘é€çš„æ•°æ®å—ã€‚</p>
<p>2ï¼‰   ç¡®è®¤æœºåˆ¶ï¼Œå‘é€æŠ¥æ–‡åï¼Œç­‰å¾…ç¡®è®¤ã€‚</p>
<p>3ï¼‰   é‡å‘æœºåˆ¶ï¼Œæ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°†é‡å‘æ•°æ®æ®µã€‚</p>
<p>4ï¼‰   ä¿æŒå®ƒé¦–éƒ¨å’Œæ•°æ®çš„æ ¡éªŒå’Œã€‚ç¡®è®¤æ•°æ®çš„å‡†ç¡®æ€§ã€‚</p>
<p>5ï¼‰   æ’åºï¼Œä¸¢å¼ƒé‡å¤çš„ï¼Œæµé‡æ§åˆ¶ã€‚</p>
<h3 id="é—®é¢˜-2ï¼šTCP-ä¸-UDP-çš„æ¦‚å¿µç›¸äº’çš„åŒºåˆ«åŠä¼˜åŠ£"><a href="#é—®é¢˜-2ï¼šTCP-ä¸-UDP-çš„æ¦‚å¿µç›¸äº’çš„åŒºåˆ«åŠä¼˜åŠ£" class="headerlink" title="é—®é¢˜ 2ï¼šTCP ä¸ UDP çš„æ¦‚å¿µç›¸äº’çš„åŒºåˆ«åŠä¼˜åŠ£"></a>é—®é¢˜ 2ï¼šTCP ä¸ UDP çš„æ¦‚å¿µç›¸äº’çš„åŒºåˆ«åŠä¼˜åŠ£</h3><ol>
<li>TCP é¢å‘è¿æ¥ï¼ŒUDP é¢å‘æ— é“¾æ¥</li>
</ol>
<ol start="2">
<li>TCP é¢å‘æŠ¥æ–‡ï¼ŒUDP é¢å‘å­—èŠ‚æµ</li>
</ol>
<ol start="3">
<li>TCP æä¾›å¯é ä¼ è¾“æœåŠ¡ï¼ˆæ•°æ®é¡ºåºã€æ­£ç¡®æ€§ï¼‰ï¼ŒUDP ä¼ è¾“ä¸å¯é </li>
</ol>
<ol start="4">
<li>TCP åè®®ä¼ è¾“é€Ÿåº¦æ…¢ï¼ŒUDP åè®®ä¼ è¾“é€Ÿåº¦å¿«</li>
</ol>
<ol start="5">
<li>TCP åè®®å¯¹ç³»ç»Ÿèµ„æºè¦æ±‚å¤šï¼ˆå¤´éƒ¨å¼€é”€å¤§ï¼‰ï¼ŒUDP åè®®è¦æ±‚å°‘</li>
</ol>
<h3 id="é—®é¢˜-3ï¼šTCPã€UDP-ä¸ºä»€ä¹ˆå­˜åœ¨ä¼ªåŒ…å¤´ï¼Ÿ"><a href="#é—®é¢˜-3ï¼šTCPã€UDP-ä¸ºä»€ä¹ˆå­˜åœ¨ä¼ªåŒ…å¤´ï¼Ÿ" class="headerlink" title="é—®é¢˜ 3ï¼šTCPã€UDP ä¸ºä»€ä¹ˆå­˜åœ¨ä¼ªåŒ…å¤´ï¼Ÿ"></a>é—®é¢˜ 3ï¼šTCPã€UDP ä¸ºä»€ä¹ˆå­˜åœ¨ä¼ªåŒ…å¤´ï¼Ÿ</h3><p>UDP(TCP)æ£€éªŒå’Œï¼šæ˜¯æ ¹æ® UDP(TCP)æ•°æ®æŠ¥å’Œä¼ªæŠ¥å¤´è®¡ç®—å¾—åˆ°çš„å·®é”™æ£€æµ‹å€¼ã€‚</p>
<p>ä¼ªæŠ¥å¤´åŒ…å«æºå’Œç›®çš„ IP åœ°å€ï¼Œä»¥åŠæ¥è‡ª IP æ•°æ®æŠ¥æŠ¥å¤´çš„åè®®å€¼ã€‚IP æ•°æ®æŠ¥åœ¨ç½‘ç»œä¸­ä¼ é€æ—¶åŒ…å«UDP æ•°æ®æŠ¥ã€‚</p>
<p>ä¼ªæŠ¥å¤´å¹¶ä¸ä¼šåœ¨ç½‘ç»œä¸­ä¼ é€ï¼Œæ ¡éªŒå’Œä¸­æ‰€åŒ…å«çš„ä¼ªæŠ¥å¤´å†…å®¹å¯ä»¥é¿å…ç›®çš„ç«¯é”™è¯¯åœ°æ¥æ”¶é”™è¯¯è·¯ç”±çš„æ•°æ®æŠ¥ã€‚æ ¡éªŒå’Œå€¼çš„è®¡ç®—æ–¹æ³•å’Œ IP æŠ¥å¤´æ£€éªŒå’Œçš„è®¡ç®—æ–¹æ³•ç±»ä¼¼</p>
<h3 id="é—®é¢˜-4ï¼šä¸ºä»€ä¹ˆè¦-3-æ¬¡æ¡æ‰‹ï¼Œ4-æ¬¡æŒ¥æ‰‹"><a href="#é—®é¢˜-4ï¼šä¸ºä»€ä¹ˆè¦-3-æ¬¡æ¡æ‰‹ï¼Œ4-æ¬¡æŒ¥æ‰‹" class="headerlink" title="é—®é¢˜ 4ï¼šä¸ºä»€ä¹ˆè¦ 3 æ¬¡æ¡æ‰‹ï¼Œ4 æ¬¡æŒ¥æ‰‹"></a>é—®é¢˜ 4ï¼šä¸ºä»€ä¹ˆè¦ 3 æ¬¡æ¡æ‰‹ï¼Œ4 æ¬¡æŒ¥æ‰‹</h3><ol>
<li><p>3 æ¬¡æ¡æ‰‹ï¼šé˜²æ­¢å·²è¿‡æœŸçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°æœåŠ¡å™¨ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯</p>
</li>
<li><p>4 æ¬¡æŒ¥æ‰‹ï¼šç¡®ä¿æ•°æ®èƒ½å¤Ÿå®Œæˆä¼ è¾“ï¼Œä½†å…³é—­è¿æ¥æ—¶ï¼Œå½“æ”¶åˆ°å¯¹æ–¹çš„FIN æŠ¥æ–‡é€šçŸ¥æ—¶ï¼Œå®ƒä»…ä»…è¡¨ç¤ºå¯¹æ–¹æ²¡æœ‰æ•°æ®å‘é€ç»™ä½ äº†ï¼›ä½†æœªå¿…ä½ æ‰€æœ‰çš„æ•°æ®éƒ½å…¨éƒ¨å‘é€ç»™å¯¹æ–¹äº†ï¼Œæ‰€ä»¥ä½ å¯ä»¥æœªå¿…ä¼šé©¬ä¸Šä¼šå…³é—­ SOCKET,ä¹Ÿå³ä½ å¯èƒ½è¿˜éœ€è¦å‘é€ä¸€äº›æ•°æ®ç»™å¯¹æ–¹ä¹‹åï¼Œå†å‘é€ FIN æŠ¥æ–‡ç»™å¯¹æ–¹æ¥è¡¨ç¤ºä½ åŒæ„ç°åœ¨å¯ä»¥å…³é—­è¿æ¥äº†ï¼Œæ‰€ä»¥å®ƒè¿™é‡Œçš„ ACK æŠ¥æ–‡å’Œ FIN æŠ¥æ–‡å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯åˆ†å¼€å‘é€çš„ </p>
</li>
</ol>
<h3 id="é—®é¢˜-5ï¼šTCP-çš„æµé‡æ§åˆ¶æœºåˆ¶"><a href="#é—®é¢˜-5ï¼šTCP-çš„æµé‡æ§åˆ¶æœºåˆ¶" class="headerlink" title="é—®é¢˜ 5ï¼šTCP çš„æµé‡æ§åˆ¶æœºåˆ¶"></a>é—®é¢˜ 5ï¼šTCP çš„æµé‡æ§åˆ¶æœºåˆ¶</h3><p>ä¸»è¦æ˜¯ä¸‹é¢çš„å››ç§æœºåˆ¶ï¼š</p>
<p> <strong>æ…¢å¯åŠ¨ï¼ˆæ…¢å¼€å§‹ï¼‰ï¼š</strong></p>
<ol>
<li><p>æ…¢å¼€å§‹ä¸æ˜¯æŒ‡ cwnd çš„å¢é•¿é€Ÿåº¦æ…¢ï¼ˆæŒ‡æ•°å¢é•¿ï¼‰ï¼Œè€Œæ˜¯æŒ‡ TCP å¼€å§‹å‘é€è®¾ç½® cwnd=1ã€‚</p>
</li>
<li><p>æ€è·¯ï¼šä¸è¦ä¸€å¼€å§‹å°±å‘é€å¤§é‡çš„æ•°æ®ï¼Œå…ˆæ¢æµ‹ä¸€ä¸‹ç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ç”±å°åˆ°å¤§é€æ¸å¢åŠ æ‹¥å¡çª—å£çš„å¤§å°ã€‚è¿™é‡Œç”¨æŠ¥æ–‡æ®µçš„ä¸ªæ•°çš„æ‹¥å¡çª—å£å¤§å°ä¸¾ä¾‹è¯´æ˜æ…¢å¼€å§‹ç®—æ³•ï¼Œå®æ—¶æ‹¥å¡çª—å£å¤§å°æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½çš„ã€‚</p>
</li>
<li><p>ä¸ºäº†é˜²æ­¢ cwnd å¢é•¿è¿‡å¤§å¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œè®¾ç½®ä¸€ä¸ªæ…¢å¼€å§‹é—¨é™ï¼ˆssthresh çŠ¶æ€å˜é‡ï¼‰</p>
<p>å½“ cnwdï¼œssthreshï¼Œä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•</p>
<p>å½“ cnwd=ssthreshï¼Œæ—¢å¯ä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ‹¥å¡é¿å…ç®—æ³•</p>
<p>å½“ cnwdï¼ssthreshï¼Œä½¿ç”¨æ‹¥å¡é¿å…ç®—æ³•</p>
</li>
</ol>
<h2 id><a href="#" class="headerlink" title></a></h2><h3 id="æ‹¥å¡é¿å…ï¼š"><a href="#æ‹¥å¡é¿å…ï¼š" class="headerlink" title="æ‹¥å¡é¿å…ï¼š"></a>æ‹¥å¡é¿å…ï¼š</h3><ol>
<li><p>æ‹¥å¡é¿å…å¹¶éå®Œå…¨èƒ½å¤Ÿé¿å…æ‹¥å¡ï¼Œæ˜¯è¯´åœ¨æ‹¥å¡é¿å…é˜¶æ®µå°†æ‹¥å¡çª—å£æ§åˆ¶ä¸ºæŒ‰çº¿æ€§è§„å¾‹å¢é•¿ï¼Œä½¿ç½‘ç»œæ¯”è¾ƒä¸å®¹æ˜“å‡ºç°æ‹¥å¡ã€‚</p>
</li>
<li><p>æ€è·¯ï¼šè®©æ‹¥å¡çª—å£ cwnd ç¼“æ…¢åœ°å¢å¤§ï¼Œå³æ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´ RTT å°±æŠŠå‘é€æ–¹çš„æ‹¥å¡æ§åˆ¶çª—å£åŠ ä¸€ã€‚</p>
</li>
</ol>
<p>æ— è®ºæ˜¯åœ¨æ…¢å¼€å§‹é˜¶æ®µè¿˜æ˜¯åœ¨æ‹¥å¡é¿å…é˜¶æ®µï¼Œåªè¦å‘é€æ–¹åˆ¤æ–­ç½‘ç»œå‡ºç°æ‹¥å¡ï¼ˆå…¶æ ¹æ®å°±æ˜¯æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œè™½ç„¶æ²¡æœ‰æ”¶åˆ°ç¡®è®¤å¯èƒ½æ˜¯å…¶ä»–åŸå› çš„åˆ†ç»„ä¸¢å¤±ï¼Œä½†æ˜¯å› ä¸ºæ— æ³•åˆ¤å®šï¼Œæ‰€ä»¥éƒ½å½“åšæ‹¥å¡æ¥å¤„ç†ï¼‰ï¼Œå°±æŠŠæ…¢å¼€å§‹é—¨é™è®¾ç½®ä¸ºå‡ºç°æ‹¥å¡æ—¶çš„å‘é€çª—å£å¤§å°çš„ä¸€åŠã€‚ç„¶åæŠŠæ‹¥å¡çª—å£è®¾ç½®ä¸º 1ï¼Œæ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚ å¦‚å›¾æ‰€ç¤ºï¼š</p>
  <img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/yong.png" class title="æ‹¥å¡é¿å…">

<h3 id="å¿«é€Ÿé‡ä¼ ï¼š"><a href="#å¿«é€Ÿé‡ä¼ ï¼š" class="headerlink" title="å¿«é€Ÿé‡ä¼ ï¼š"></a>å¿«é€Ÿé‡ä¼ ï¼š</h3><ol>
<li><p>å¿«é‡ä¼ è¦æ±‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±ç«‹å³å‘å‡ºé‡å¤ç¡®è®¤ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰è€Œä¸è¦ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æå¸¦ç¡®è®¤ã€‚å¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œå‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸã€‚</p>
</li>
<li><p>ç”±äºä¸éœ€è¦ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨åˆ°æœŸï¼Œèƒ½å°½æ—©é‡ä¼ æœªè¢«ç¡®è®¤çš„æŠ¥æ–‡æ®µï¼Œèƒ½æé«˜æ•´ä¸ªç½‘ç»œçš„ååé‡ã€‚</p>
</li>
</ol>
<h3 id="å¿«é€Ÿæ¢å¤ï¼š"><a href="#å¿«é€Ÿæ¢å¤ï¼š" class="headerlink" title="å¿«é€Ÿæ¢å¤ï¼š"></a>å¿«é€Ÿæ¢å¤ï¼š</h3><ol>
<li><p>å½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œâ€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠ ssthresh é—¨é™å‡åŠã€‚ä½†æ˜¯æ¥ä¸‹å»å¹¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚</p>
</li>
<li><p>è€ƒè™‘åˆ°å¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡çš„è¯å°±ä¸ä¼šæ”¶åˆ°å¥½å‡ ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œæ‰€ä»¥å‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¯èƒ½æ²¡æœ‰å‡ºç°æ‹¥å¡ã€‚æ‰€ä»¥æ­¤æ—¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œè€Œæ˜¯å°† cwnd è®¾ç½®ä¸º ssthresh çš„å¤§å°ï¼Œç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ã€‚</p>
<img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/quick.png" class title="å¿«é€Ÿæ¢å¤">

</li>
</ol>
<h1 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a><center>åº”ç”¨å±‚</center></h1><h3 id="é—®é¢˜-1ï¼šDNS-çš„æ¦‚å¿µï¼Œç”¨é€”ï¼ŒDNS-æŸ¥è¯¢çš„å®ç°ç®—æ³•"><a href="#é—®é¢˜-1ï¼šDNS-çš„æ¦‚å¿µï¼Œç”¨é€”ï¼ŒDNS-æŸ¥è¯¢çš„å®ç°ç®—æ³•" class="headerlink" title="é—®é¢˜ 1ï¼šDNS çš„æ¦‚å¿µï¼Œç”¨é€”ï¼ŒDNS æŸ¥è¯¢çš„å®ç°ç®—æ³•"></a>é—®é¢˜ 1ï¼šDNS çš„æ¦‚å¿µï¼Œç”¨é€”ï¼ŒDNS æŸ¥è¯¢çš„å®ç°ç®—æ³•</h3><ul>
<li><p>æ¦‚å¿µ</p>
<ul>
<li>åŸŸåè§£æï¼Œ<a href="http://www.xxx.comè½¬æ¢æˆ" target="_blank" rel="noopener">www.xxx.comè½¬æ¢æˆ</a> ipï¼Œèƒ½å¤Ÿä½¿ç”¨æˆ·æ›´æ–¹ä¾¿çš„è®¿é—®äº’è”ç½‘ï¼Œè€Œä¸ç”¨å»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æ¥è¯»å–çš„ ip åœ°å€</li>
<li>DNS åè®®è¿è¡Œåœ¨ UDP åè®®ä¹‹ä¸Šï¼Œä½¿ç”¨ç«¯å£å· 53</li>
</ul>
</li>
<li><p>ä¸»æœºè§£æåŸŸåçš„é¡ºåº</p>
<ul>
<li>æµè§ˆå™¨ç¼“å­˜</li>
<li>æ‰¾æœ¬æœºçš„ hosts æ–‡ä»¶</li>
<li>è·¯ç”±ç¼“å­˜</li>
<li>æ‰¾ DNS æœåŠ¡å™¨(æœ¬åœ°åŸŸåã€é¡¶çº§åŸŸåã€æ ¹åŸŸå)<ul>
<li>è¿­ä»£æŸ¥è¯¢ã€é€’å½’æŸ¥è¯¢</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="é—®é¢˜-2ï¼šhttp-åŸºæœ¬æ ¼å¼"><a href="#é—®é¢˜-2ï¼šhttp-åŸºæœ¬æ ¼å¼" class="headerlink" title="é—®é¢˜ 2ï¼šhttp åŸºæœ¬æ ¼å¼"></a>é—®é¢˜ 2ï¼šhttp åŸºæœ¬æ ¼å¼</h3><p>http è¯·æ±‚ï¼š</p>
 <img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/httprequest.png" class title="http è¯·æ±‚"> 

<p> http å“åº”ï¼š</p>
 <img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/httpresponse.png" class title="http å“åº”"> 

<h3 id="é—®é¢˜-3ï¼šGETã€POST-åŒºåˆ«"><a href="#é—®é¢˜-3ï¼šGETã€POST-åŒºåˆ«" class="headerlink" title="é—®é¢˜ 3ï¼šGETã€POST åŒºåˆ«"></a>é—®é¢˜ 3ï¼šGETã€POST åŒºåˆ«</h3> <img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/get.png" class title="GETå’ŒPOST åŒºåˆ«"> 

<h3 id="é—®é¢˜-4ï¼šCookies-å’Œ-Session-çš„åŒºåˆ«"><a href="#é—®é¢˜-4ï¼šCookies-å’Œ-Session-çš„åŒºåˆ«" class="headerlink" title="é—®é¢˜ 4ï¼šCookies å’Œ Session çš„åŒºåˆ«"></a>é—®é¢˜ 4ï¼šCookies å’Œ Session çš„åŒºåˆ«</h3><ol>
<li><p><strong>cookie</strong> æ˜¯ä¸€ç§å‘é€åˆ°å®¢æˆ·æµè§ˆå™¨çš„æ–‡æœ¬ä¸²å¥æŸ„ï¼Œå¹¶ä¿å­˜åœ¨å®¢æˆ·æœºç¡¬ç›˜ä¸Šï¼Œå¯ä»¥ç”¨æ¥åœ¨æŸä¸ª WEB ç«™ç‚¹ä¼šè¯é—´æŒä¹…çš„ä¿æŒæ•°æ®</p>
</li>
<li><p><strong>session</strong> å…¶å®æŒ‡çš„å°±æ˜¯è®¿é—®è€…ä»åˆ°è¾¾æŸä¸ªç‰¹å®šä¸»é¡µåˆ°ç¦»å¼€ä¸ºæ­¢çš„é‚£æ®µæ—¶é—´ã€‚ Session å…¶å®æ˜¯åˆ©ç”¨Cookie è¿›è¡Œä¿¡æ¯å¤„ç†çš„ï¼Œå½“ç”¨æˆ·é¦–å…ˆè¿›è¡Œäº†è¯·æ±‚åï¼ŒæœåŠ¡ç«¯å°±åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸Šåˆ›å»ºäº†ä¸€ä¸ªCookieï¼Œå½“è¿™ä¸ª Session ç»“æŸæ—¶ï¼Œå…¶å®å°±æ˜¯æ„å‘³ç€è¿™ä¸ª Cookie å°±è¿‡æœŸäº†</p>
</li>
<li><p>cookie æ•°æ®ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œsession æ•°æ®ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯</p>
</li>
</ol>
<h3 id="é—®é¢˜-5ï¼šä¸€æ¬¡å®Œæ•´çš„-HTTP-è¯·æ±‚æ‰€ç»å†çš„æ­¥éª¤"><a href="#é—®é¢˜-5ï¼šä¸€æ¬¡å®Œæ•´çš„-HTTP-è¯·æ±‚æ‰€ç»å†çš„æ­¥éª¤" class="headerlink" title="é—®é¢˜ 5ï¼šä¸€æ¬¡å®Œæ•´çš„ HTTP è¯·æ±‚æ‰€ç»å†çš„æ­¥éª¤"></a>é—®é¢˜ 5ï¼šä¸€æ¬¡å®Œæ•´çš„ HTTP è¯·æ±‚æ‰€ç»å†çš„æ­¥éª¤</h3><p> æ¯”å¦‚ï¼šåœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <a href="http://www.baidu.com/" target="_blank" rel="noopener">www.baidu.com </a>åæ‰§è¡Œçš„å…¨éƒ¨è¿‡ç¨‹ </p>
<img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/http.png" class title="httpè¯·æ±‚">

<p>ä¹Ÿå¯ä»¥å‚è€ƒæ–‡ç« ï¼šã€ŠæŠ“åŒ…å®æˆ˜ | æµè§ˆå™¨é‡Œçš„HTTP è¯·æ±‚åˆ°åº•æ˜¯å¦‚ä½•å®Œæˆçš„ï¼Ÿã€‹</p>
<p><a href="https://mp.weixin.qq.com/s/_fB7r53BGZRvpG9YAPRQ8A" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/_fB7r53BGZRvpG9YAPRQ8A</a></p>
<h3 id="é—®é¢˜-6ï¼šhttp2-0-å’Œhttp1-1-çš„åŒºåˆ«"><a href="#é—®é¢˜-6ï¼šhttp2-0-å’Œhttp1-1-çš„åŒºåˆ«" class="headerlink" title="é—®é¢˜ 6ï¼šhttp2.0 å’Œhttp1.1 çš„åŒºåˆ«"></a>é—®é¢˜ 6ï¼šhttp2.0 å’Œhttp1.1 çš„åŒºåˆ«</h3><img src="/2020/05/26/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/http2.png" class title="http2.0 å’Œhttp1.1 çš„åŒºåˆ«"> 









































]]></content>
      <categories>
        <category>ç‰›å®¢å°çŸ¥è¯†</category>
      </categories>
      <tags>
        <tag>é¢è¯•é¢˜</tag>
      </tags>
  </entry>
</search>
